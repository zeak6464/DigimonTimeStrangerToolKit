require("include")

function m420_103()
  Fade_Out(1, 0)
  EVENT_BEGIN()
  Talk.Load("m420")
  SetEventCutNo(4)
  if Debug.IsEventView() then
    SetTimeZone("Noon")
    SetTimeAxis("P2028_daft_420")
    SetMapStatus("Disable")
    LoadMap("h0701")
  end
  LoadModel("HERO_01", "Player")
  LoadModel("AEGIOMON_01", "char_AEGIOMON")
  LoadModel("chr805_02", "char_BLACKSHADOW")
  LoadModel("chr805_03", "char_BLACKSHADOW")
  LoadModel("chr805_04", "char_BLACKSHADOW")
  LoadModel("chr805_05", "char_BLACKSHADOW")
  LoadModel("chr805_06", "char_BLACKSHADOW")
  LoadModel("chr805_07", "char_BLACKSHADOW")
  LoadModel("chr805_08", "char_BLACKSHADOW")
  LoadModel("chr805_09", "char_BLACKSHADOW")
  LoadModel("chr805_10", "char_BLACKSHADOW")
  LoadModel("chr805_11", "char_BLACKSHADOW")
  LoadModel("chr805_12", "char_BLACKSHADOW")
  LoadModel("chr805_13", "char_BLACKSHADOW")
  LoadSceneViewerResource("c1.0", "h0701f_za")
  LoadSceneViewerResource("c2.0", "h0701f_za")
  LoadSceneViewerResource("c3.0", "h0701f_za")
  LoadSceneViewerResource("c4.0", "h0701f_za")
  LoadSceneViewerResource("c5.0", "h0701f_za")
  LoadSceneViewerResource("c6.0", "h0701f_za")
  LoadSceneViewerResource("c7.0", "h0701f_za")
  LoadSceneViewerResource("c8.0", "h0701f_za")
  LoadEnvironmentFile("c1.0", "es_m420_100_c1.0")
  LoadEnvironmentFile("c2.0", "es_m420_100_c2.0")
  LoadEnvironmentFile("c3.0", "es_m420_100_c3.0")
  LoadEnvironmentFile("c4.0", "es_m420_100_c4.0")
  LoadEnvironmentFile("c5.0", "es_m420_100_c5.0")
  LoadEnvironmentFile("c6.0", "es_m420_100_c6.0")
  LoadEnvironmentFile("c7.0", "es_m420_100_c7.0")
  LoadEnvironmentFile("c8.0", "es_m420_100_c8.0")
  WaitVistaLoad()
  SetPosition("HERO_01", 0, 0.506, -99.845, "LINEAR", 0, 0)
  SetRotation("HERO_01", 0, 180, 0, "LINEAR", 0, 0)
  SetPosition("AEGIOMON_01", 0, 0.506, -106.043, "LINEAR", 0, 0)
  SetRotation("AEGIOMON_01", 0, 180, 0, "LINEAR", 0, 0)
  BlendEye("HERO_01", 0, 0, "SCURVE", 0, 0)
  BlendFace("HERO_01", 0, 0, 0, true, "SCURVE", 0, 0)
  BlendEye("AEGIOMON_01", 0, 0, "SCURVE", 0, 0)
  BlendFace("AEGIOMON_01", -18, 0, 0, true, "SCURVE", 0, 0)
  SetPosition("chr805_02", -5.034, 0.506, -95.901, "LINEAR", 0, 0)
  SetRotation("chr805_02", 0, 123.5, 0, "LINEAR", 0, 0)
  SetPosition("chr805_03", -11.231, 0.506, -97.869, "LINEAR", 0, 0)
  SetRotation("chr805_03", 0, 82.5, 0, "LINEAR", 0, 0)
  SetPosition("chr805_04", -8.874, 0.506, -103.937, "LINEAR", 0, 0)
  SetRotation("chr805_04", 0, 59.5, 0, "LINEAR", 0, 0)
  SetPosition("chr805_05", -9.685, 0.506, -110.754, "LINEAR", 0, 0)
  SetRotation("chr805_05", 0, 39.5, 0, "LINEAR", 0, 0)
  SetPosition("chr805_06", -9.272, 0.506, -116.939, "LINEAR", 0, 0)
  SetRotation("chr805_06", 0, 9, 0, "LINEAR", 0, 0)
  SetPosition("chr805_07", -2.842, 0.506, -114.077, "LINEAR", 0, 0)
  SetRotation("chr805_07", 0, 10.5, 0, "LINEAR", 0, 0)
  SetPosition("chr805_08", 4.422, 0.506, -116.712, "LINEAR", 0, 0)
  SetRotation("chr805_08", 0, -17.5, 0, "LINEAR", 0, 0)
  SetPosition("chr805_09", 11.261, 0.506, -115.189, "LINEAR", 0, 0)
  SetRotation("chr805_09", 0, -61, 0, "LINEAR", 0, 0)
  SetPosition("chr805_10", 9.428, 0.506, -109.57, "LINEAR", 0, 0)
  SetRotation("chr805_10", 0, -67.5, 0, "LINEAR", 0, 0)
  SetPosition("chr805_11", 11.045, 0.506, -103.311, "LINEAR", 0, 0)
  SetRotation("chr805_11", 0, -81, 0, "LINEAR", 0, 0)
  SetPosition("chr805_12", 10.557, 0.506, -95.026, "LINEAR", 0, 0)
  SetRotation("chr805_12", 0, -144, 0, "LINEAR", 0, 0)
  SetPosition("chr805_13", 5.692, 0.506, -97.994, "LINEAR", 0, 0)
  SetRotation("chr805_13", 0, -115, 0, "LINEAR", 0, 0)
  PlayMotion("HERO_01", "fn01_01", 0, true, 0)
  SetFace("HERO_01", "F01", 0, 1, 0, 0)
  PlayMotion("AEGIOMON_01", "fn01_01", 0, true, 0)
  SetFace("AEGIOMON_01", "E04_M15", 0, 1, 0, 0)
  PlayMotion("chr805_02", "bn01", 0, true, 0)
  PlayMotion("chr805_03", "bn01", 0, true, 0)
  PlayMotion("chr805_04", "bn01", 0, true, 0)
  PlayMotion("chr805_05", "bn01", 0, true, 0)
  PlayMotion("chr805_06", "bn01", 0, true, 0)
  PlayMotion("chr805_07", "bn01", 0, true, 0)
  PlayMotion("chr805_08", "bn01", 0, true, 0)
  PlayMotion("chr805_09", "bn01", 0, true, 0)
  PlayMotion("chr805_10", "bn01", 0, true, 0)
  PlayMotion("chr805_11", "bn01", 0, true, 0)
  PlayMotion("chr805_12", "bn01", 0, true, 0)
  PlayMotion("chr805_13", "bn01", 0, true, 0)
  SetCamera(0.882, 1.326, -104.638, 0, 20, "LINEAR", 0, false, 0, false)
  SetCameraTarget(-0.05, 1.539, -106.088, "LINEAR", 0, false, 0, false)
  SetCamera(0.688, 1.318, -104.532, 0, 20, "LINEAR", 430, false, 0, true)
  SetCameraTarget(-0.05, 1.539, -106.088, "LINEAR", 430, false, 0, true)
  FIELD_SET()
  EVENT_START()
  CUT("1.0")
  SetEnv_All("c5.0", 0)
  Fade_In(1, 20)
  WaitFrame(30)
  BlendFace("AEGIOMON_01", 34, 0, 0, true, "SCURVE", 30, 20)
  MessageTalk("m420_100_110")
  MessageClose()
  SetRotation("AEGIOMON_01", 0, 0, 0, "LINEAR", 60, 10)
  PlayMotion("AEGIOMON_01", "ft02_01", 5, false, 10)
  PlayMotion("AEGIOMON_01", "fn01_01", 10, true, 70)
  BlendFace("AEGIOMON_01", -18, 0, 0, true, "SCURVE", 30, 40)
  MessageTalk("m420_100_120")
  MessageClose()
  WaitFrame(10)
  CUT("2.0")
  SetEnv_All("c6.0", 0)
  local gender = GetGender()
  if gender == HERO then
    SetFace("HERO_01", "E01_M02", 1, 1, FACE_BLENDTIME, 0)
  elseif gender == HEROINE then
    SetFace("HERO_01", "F01", 1, 1, FACE_BLENDTIME, 0)
  end
  SetPosition("HERO_01", 0, 0.506, -99.845, "LINEAR", 0, 0)
  SetRotation("HERO_01", 0, 180, 0, "LINEAR", 0, 0)
  BlendEye("HERO_01", 12, 0, "SCURVE", 0, 0)
  BlendFace("HERO_01", 25, 0, 0, true, "SCURVE", 0, 0)
  SetCamera(0.103, 1.694, -101.163, 0, 20, "LINEAR", 0, false, 0)
  SetCameraTarget(0.009, 2.101, -99.516, "LINEAR", 0, false, 0)
  BlendEye("HERO_01", 12, 0, "SCURVE", 0, 0)
  BlendFace("HERO_01", 25, 0, 0, true, "SCURVE", 18, 0)
  BlendEye("HERO_01", 12, 0, "SCURVE", 0, 0)
  BlendFace("HERO_01", 69, 0, 0, true, "SCURVE", 25, 15)
  BlendEye("HERO_01", 12, 0, "SCURVE", 0, 0)
  BlendFace("HERO_01", 34, 0, 0, true, "SCURVE", 30, 40)
  local gender = GetGender()
  if gender == HERO then
    SetFace("HERO_01", "E01_M02", 2, 1, FACE_BLENDTIME, 20)
    SetFace("HERO_01", "E01_M02", 1, 1, 5, 50)
  elseif gender == HEROINE then
    SetFace("HERO_01", "F01", 2, 1, FACE_BLENDTIME, 20)
    SetFace("HERO_01", "F01", 1, 1, 5, 50)
  end
  WaitFrame(60)
  MessageTalkSel(3, "m420_100_130")
  result = Talk.GetResultSelectedNum()
  local gender = GetGender()
  if gender == HERO then
    SetFace("HERO_01", "E03_M02", 1, 1, FACE_BLENDTIME, 0)
  elseif gender == HEROINE then
    SetFace("HERO_01", "E15_M01", 1, 1, FACE_BLENDTIME, 0)
  end
  if result == RESULT_TALK00 then
    PlayMotion("HERO_01", "e002", 10, true, 0)
    SetFace("HERO_01", "E12_M01", 0, 1, FACE_BLENDTIME, 0)
    SetMouth("HERO_01", 0, FACE_BLENDTIME, 20)
    SetMouth("HERO_01", 1, MOUTH_BLENDTIME, 80)
    WaitFrame(130)
  elseif result == RESULT_TALK01 then
    PlayMotion("HERO_01", "e012", 10, true, 0)
    SetFace("HERO_01", "E12_M01", 0, 1, FACE_BLENDTIME, 0)
    SetPosition("HERO_01", -0.07, 0.506, -99.845, "SCURVE", 15, 10)
    SetRotation("HERO_01", 0, 183, 0, "LINEAR", 15, 10)
    SetMouth("HERO_01", 0, FACE_BLENDTIME, 20)
    SetMouth("HERO_01", 1, MOUTH_BLENDTIME, 80)
    WaitFrame(110)
  elseif result == RESULT_TALK02 then
    PlayMotion("HERO_01", "e023", 10, true, 0)
    SetFace("HERO_01", "E12_M01", 0, 1, FACE_BLENDTIME, 0)
    EndMotion("HERO_01", 60)
    SetPosition("HERO_01", 0.03, 0.506, -99.845, "LINEAR", 15, 10)
    SetMouth("HERO_01", 0, FACE_BLENDTIME, 10)
    SetMouth("HERO_01", 1, MOUTH_BLENDTIME, 70)
    WaitFrame(120)
  end
  CUT("3.0")
  SetEnv_All("c7.0", 0)
  SetCamera(0.122, 1.438, -104.76, 0, 20, "LINEAR", 0, false, 0)
  SetCameraTarget(-0.095, 1.608, -106.953, "LINEAR", 0, false, 0)
  WaitFrame(30)
  MessageTalk("m420_100_140")
  BlendFace("AEGIOMON_01", 21, 0, 0, true, "SCURVE", 40, 0)
  SetFace("AEGIOMON_01", "E04_M15", 2, 1, FACE_BLENDTIME, 20)
  MessageClose()
  WaitFrame(30)
  MessageTalk("m420_100_150")
  MessageClose()
  MessageTalk("m420_100_160")
  BlendFace("AEGIOMON_01", -21, 0, 8, true, "SCURVE", 40, 0)
  SetFace("AEGIOMON_01", "E04_M02", 1, 1, 5, 20)
  MessageClose()
  WaitFrame(40)
  CUT("4.0")
  SetEnv_All("c8.0", 0)
  SetPosition("HERO_01", 0, 0.506, -99.845, "LINEAR", 0, 0)
  SetRotation("HERO_01", 0, 180, 0, "LINEAR", 0, 0)
  SetPosition("AEGIOMON_01", 0, 0.506, -106.043, "LINEAR", 0, 0)
  SetRotation("AEGIOMON_01", 0, 0, 0, "LINEAR", 0, 0)
  SetPosition("chr805_02", -5.034, 0.506, -95.901, "LINEAR", 0, 0)
  SetRotation("chr805_02", 0, 123.5, 0, "LINEAR", 0, 0)
  SetPosition("chr805_03", -11.231, 0.506, -99.559, "LINEAR", 0, 0)
  SetRotation("chr805_03", 0, 82.5, 0, "LINEAR", 0, 0)
  SetPosition("chr805_04", -8.874, 0.506, -105.247, "LINEAR", 0, 0)
  SetRotation("chr805_04", 0, 59.5, 0, "LINEAR", 0, 0)
  SetPosition("chr805_05", -9.685, 0.506, -110.754, "LINEAR", 0, 0)
  SetRotation("chr805_05", 0, 39.5, 0, "LINEAR", 0, 0)
  SetPosition("chr805_06", -9.272, 0.506, -116.939, "LINEAR", 0, 0)
  SetRotation("chr805_06", 0, 9, 0, "LINEAR", 0, 0)
  SetPosition("chr805_07", -2.842, 0.506, -114.077, "LINEAR", 0, 0)
  SetRotation("chr805_07", 0, 10.5, 0, "LINEAR", 0, 0)
  SetPosition("chr805_08", 4.422, 0.506, -116.712, "LINEAR", 0, 0)
  SetRotation("chr805_08", 0, -17.5, 0, "LINEAR", 0, 0)
  SetPosition("chr805_09", 11.261, 0.506, -115.189, "LINEAR", 0, 0)
  SetRotation("chr805_09", 0, -61, 0, "LINEAR", 0, 0)
  SetPosition("chr805_10", 9.428, 0.506, -109.57, "LINEAR", 0, 0)
  SetRotation("chr805_10", 0, -67.5, 0, "LINEAR", 0, 0)
  SetPosition("chr805_11", 11.045, 0.506, -105.611, "LINEAR", 0, 0)
  SetRotation("chr805_11", 0, -81, 0, "LINEAR", 0, 0)
  SetPosition("chr805_12", 13.587, 0.506, -101.936, "LINEAR", 0, 0)
  SetRotation("chr805_12", 0, -144, 0, "LINEAR", 0, 0)
  SetPosition("chr805_13", 5.692, 0.506, -97.994, "LINEAR", 0, 0)
  SetRotation("chr805_13", 0, -115, 0, "LINEAR", 0, 0)
  PlayMotion("HERO_01", "fn01_01", 0, true, 0)
  BlendEye("HERO_01", 0, 0, "SCURVE", 0, 0)
  BlendFace("HERO_01", 0, 0, 0, false, "SCURVE", 0, 0)
  SetCamera(16.136, 0.63, -102.931, 0, 27, "LINEAR", 0, false, 0, false)
  SetCameraTarget(-0.071, 2.882, -102.626, "LINEAR", 0, false, 0, false)
  SetCamera(16.131, 0.645, -103.325, 0, 27, "DECEL", 200, false, 0, false)
  SetCameraTarget(-0.076, 2.897, -103.02, "DECEL", 200, false, 0, false)
  WaitFrame(30)
  MessageTalk("m420_100_170")
  MessageClose()
  WaitFrame(10)
  Fade_OutNoLoadingWithWait(0, FADE_TIME)
  if Debug.IsEventView() then
    Event_StopBGM(0, 0)
    Event_StopAllSE(0, 0)
  end
  Vista.SetKeepBGM()
  EVENT_END()
end

function CUT(cut_no)
  CUT_START(cut_no)
end

function main()
  m420_103()
end
