S050_176 = {
  ID = 176,
  STEP_001 = 1,
  STEP_005 = 5,
  STEP_255 = 255,
  Flg01 = "FLAG_SUB_050_176_001",
  Flg02 = "FLAG_SUB_050_176_002",
  Flg03 = "FLAG_SUB_050_176_003",
  Flg04 = "FLAG_SUB_050_176_004",
  Flg05 = "FLAG_SUB_050_176_005"
}
local text_file = "s050_176"
local base = text_file .. "_"
local tlk = Tlk:new(text_file, 1, true)

function S050_176:Event_010()
  local f_fq01 = Motion.Object:new(NPC, "s050_176_001", "fq01")
  local f_fq02 = Motion.Object:new(NPC, "s050_176_001", "fq02")
  local f_fe02 = Motion.Object:new(NPC, "s050_176_001", "fe02")
  local f_fe04 = Motion.Object:new(NPC, "s050_176_001", "fe04")
  local f_bn01 = Motion.Object:new(NPC, "s050_176_001", "bn01")
  local r_fq01 = Motion.Object:new(NPC, "s050_176_002", "fq01")
  local r_fq02 = Motion.Object:new(NPC, "s050_176_002", "fq02")
  local r_fe02 = Motion.Object:new(NPC, "s050_176_002", "fe02")
  local r_fe04 = Motion.Object:new(NPC, "s050_176_002", "fe04")
  local r_bn01 = Motion.Object:new(NPC, "s050_176_002", "bn01")
  local m_index = GetIndex(NPC, "npc_0001")
  local e101 = Motion.Object:new(NPC, "npc_0001", "e101")
  local e104 = Motion.Object:new(NPC, "npc_0001", "e104")
  local e105 = Motion.Object:new(NPC, "npc_0001", "e105")
  local e108 = Motion.Object:new(NPC, "npc_0001", "e108")
  local e100 = Motion.Object:new(NPC, "npc_0001", "e100")
  local e002 = Motion.Object:new(PLAYER, "", "e002")
  local e004 = Motion.Object:new(PLAYER, "", "e004")
  local e008 = Motion.Object:new(PLAYER, "", "e008")
  local e012 = Motion.Object:new(PLAYER, "", "e012")
  local fn01_01 = Motion.Object:new(PLAYER, "", "fn01_01")
  if Qst.Sub:Check(self.ID, self.STEP_001, self.STEP_005) then
    Fade_OutNoLoadingWithWait(FADE_BLACK, FADE_TIME)
    fn01_01:Play(15, true)
    HideMinimap(true)
    HideGuide(true)
    Field_InvisibleFollowerAllPartyMember(0, 0, false)
    Field_InvisibleFollowerAllGuest(0, 0, false)
    Field.ObjectLookAtTheObject(PLAYER, 1, NPC, m_index, 0)
    Obj:new(PLAYER, ""):SetPos(0, 0, -35)
    Obj:new(PLAYER, ""):SetRotationY(0, 0)
    Cam.Inst:Set(-1.1059, 1.7516, -38.528, 3.9237, 1.1573, -29.906, default, 30)
    WaitFrame(30)
    FadeAllInWithWait(FADE_BLACK, FADE_TIME)
    local tlk = Tlk:new(text_file, 1, true)
    tlk:StartTalkAndCancelDigimonRide()
    if not Flg.Check(self.Flg05) then
      Flg.Set(self.Flg05)
      r_fq02:PlayWithStartMoveMotion(10, 10)
      tlk:Message(base .. "010")
      f_fe04:PlayWithStartMoveMotion(10, 10)
      tlk:Message(base .. "020")
      e101:PlayWithStartMoveMotion(10, 10)
      tlk:Message(base .. "030")
      e100:PlayWithStartMoveMotion(10, 10)
      local result = tlk:Select(3, base .. "040")
      if result == RESULT_TALK00 then
        WaitFrame(15)
        e101:PlayWithStartMoveMotion(10, 10)
        tlk:Message(base .. "050")
      elseif result == RESULT_TALK01 then
        WaitFrame(15)
        e101:PlayWithStartMoveMotion(10, 10)
        tlk:Message(base .. "060")
      else
        WaitFrame(15)
        e101:PlayWithStartMoveMotion(10, 10)
        tlk:Message(base .. "070")
        tlk:EndTalk(true)
        Fade_OutNoLoadingWithWait(FADE_BLACK, FADE_TIME)
        Field.ObjectResetMotion(PLAYER, 1, 0)
        Cam.Inst:Clear(0)
        WaitFrame(15)
        HideMinimap(false)
        HideGuide(false)
        Field_CancelInvisibleFollowerAllGuest(0, 15, false, false)
        Field_CancelInvisibleFollowerAllPartyMember(0, 15, false, false)
        FieldObjectSync(FOR_ALL, false)
        FadeInWithWaitNotFlgCheck(FADE_BLACK, FADE_TIME)
        goto lbl_872
      end
    else
      e101:PlayWithStartMoveMotion(10, 10)
      tlk:Message(base .. "530")
      local result = tlk:Select(2, base .. "540")
      if result == RESULT_TALK00 then
        WaitFrame(15)
        e101:PlayWithStartMoveMotion(10, 10)
        tlk:Message(base .. "550")
      else
        WaitFrame(15)
        e101:PlayWithStartMoveMotion(10, 10)
        tlk:Message(base .. "560")
        tlk:EndTalk(true)
        Fade_OutNoLoadingWithWait(FADE_BLACK, FADE_TIME)
        Field.ObjectResetMotion(PLAYER, 1, 0)
        Cam.Inst:Clear(0)
        WaitFrame(15)
        HideMinimap(false)
        HideGuide(false)
        Field_CancelInvisibleFollowerAllGuest(0, 15, false, false)
        Field_CancelInvisibleFollowerAllPartyMember(0, 15, false, false)
        FieldObjectSync(FOR_ALL, false)
        FadeInWithWaitNotFlgCheck(FADE_BLACK, FADE_TIME)
        goto lbl_872
      end
    end
    e100:PlayWithStartMoveMotion(10, 10)
    r_fq01:PlayWithStartMoveMotion(10, 10)
    tlk:Message(base .. "080")
    f_fq01:PlayWithStartMoveMotion(10, 10)
    tlk:Message(base .. "090")
    f_fq02:PlayWithStartMoveMotion(10, 10)
    tlk:Message(base .. "100")
    local result = tlk:Select(3, base .. "110")
    if result == RESULT_TALK00 then
      WaitFrame(15)
      r_fq01:PlayWithStartMoveMotion(10, 10)
      tlk:Message(base .. "120")
    elseif result == RESULT_TALK01 then
      WaitFrame(15)
      r_fq02:PlayWithStartMoveMotion(10, 10)
      tlk:Message(base .. "130")
    else
      WaitFrame(15)
      r_fq01:PlayWithStartMoveMotion(10, 10)
      tlk:Message(base .. "140")
    end
    f_fq02:PlayWithStartMoveMotion(10, 10)
    tlk:Message(base .. "150")
    r_fq01:PlayWithStartMoveMotion(10, 10)
    tlk:Message(base .. "160")
    e101:PlayWithStartMoveMotion(10, 10)
    tlk:Message(base .. "170")
    e100:PlayWithStartMoveMotion(10, 10)
    f_fq01:PlayWithStartMoveMotion(10, 10)
    tlk:Message(base .. "180")
    f_fq02:PlayWithStartMoveMotion(10, 10)
    tlk:Message(base .. "190")
    r_fq02:PlayWithStartMoveMotion(10, 10)
    tlk:Message(base .. "200")
    r_fe04:PlayWithStartMoveMotion(10, 10)
    tlk:Message(base .. "210")
    f_fq01:PlayWithStartMoveMotion(10, 10)
    tlk:Message(base .. "220")
    e101:PlayWithStartMoveMotion(10, 10)
    tlk:Message(base .. "230")
    e105:PlayWithStartMoveMotion(10, 10)
    tlk:Message(base .. "240")
    e101:PlayWithStartMoveMotion(10, 10)
    tlk:Message(base .. "250")
    result = tlk:Select(3, base .. "260")
    if result == RESULT_TALK00 then
      WaitFrame(15)
      e104:PlayWithStartMoveMotion(10, 10)
      tlk:Message(base .. "270")
    elseif result == RESULT_TALK01 then
      WaitFrame(15)
      e101:PlayWithStartMoveMotion(10, 10)
      tlk:Message(base .. "280")
    else
      WaitFrame(15)
      e101:PlayWithStartMoveMotion(10, 10)
      tlk:Message(base .. "290")
    end
    e101:PlayWithStartMoveMotion(10, 10)
    tlk:Message(base .. "300")
    e100:PlayWithStartMoveMotion(10, 10)
    f_fq01:PlayWithStartMoveMotion(10, 10)
    tlk:Message(base .. "310")
    r_fq01:PlayWithStartMoveMotion(10, 10)
    tlk:Message(base .. "320")
    e101:PlayWithStartMoveMotion(10, 10)
    tlk:Message(base .. "340")
    e104:PlayWithStartMoveMotion(10, 10)
    tlk:Message(base .. "350")
    e100:PlayWithStartMoveMotion(10, 10)
    r_fq01:PlayWithStartMoveMotion(10, 10)
    tlk:Message(base .. "360")
    f_fq01:PlayWithStartMoveMotion(10, 10)
    tlk:Message(base .. "330")
    tlk:MessageClose()
    Flg.Set(self.Flg01)
    Fade_OutNoLoadingWithWait(FADE_BLACK, FADE_TIME)
    FieldObjectSync(NPC, true)
    WaitFrame(30)
    FadeAllInWithWait(FADE_BLACK, FADE_TIME)
    tlk:Message(base .. "373")
    tlk:Message(base .. "375")
    tlk:EndTalk(true)
    Flg.Set("FLAG_FREEARENA_RELEASE_023")
    Flg.Set("FLAG_SKIP_AREACHANGE_MOVE")
    Qst.Sub:Start(self.ID, 1, false)
    Fade_OutNoLoadingWithWait(FADE_BLACK, FADE_TIME)
    Field.ObjectResetMotion(PLAYER, 1, 0)
    Cam.Inst:Clear(0)
    WaitFrame(15)
    HideMinimap(false)
    HideGuide(false)
    Field_CancelInvisibleFollowerAllGuest(0, 15, false, false)
    Field_CancelInvisibleFollowerAllPartyMember(0, 15, false, false)
    FieldObjectSync(FOR_ALL, false)
    FadeInWithWaitNotFlgCheck(FADE_BLACK, FADE_TIME)
    Digitter.Send(7010230)
    Qst.Sub:Set(self.ID, self.STEP_005)
  end
  ::lbl_872::
end

function S050_176:Event_020()
  if Qst.Sub:Check(self.ID, self.STEP_005, self.STEP_255) then
    Cam.Inst:Set(2.788, 0.833, 77.119, -3.39, 3.091, 84.651, default, 30)
    tlk:StartTalkAndCancelDigimonRide()
    tlk:Message(base .. "360")
    tlk:Message(base .. "370")
    tlk:EndTalk()
  end
end

function S050_176:Event_030()
  if Qst.Sub:Check(self.ID, self.STEP_005, self.STEP_255) and Flg.Check(self.Flg02, self.Flg04) then
    local f_fq01 = Motion.Object:new(NPC, "s050_176_001", "fq01")
    local f_fq02 = Motion.Object:new(NPC, "s050_176_001", "fq02")
    local f_fe02 = Motion.Object:new(NPC, "s050_176_001", "fe02")
    local f_fe04 = Motion.Object:new(NPC, "s050_176_001", "fe04")
    local f_bn01 = Motion.Object:new(NPC, "s050_176_001", "bn01")
    local rapid_index = GetIndex(NPC, "s050_176_002")
    local r_fq01 = Motion.Object:new(NPC, "s050_176_002", "fq01")
    local r_fq02 = Motion.Object:new(NPC, "s050_176_002", "fq02")
    local r_fe02 = Motion.Object:new(NPC, "s050_176_002", "fe02")
    local r_fe04 = Motion.Object:new(NPC, "s050_176_002", "fe04")
    local r_bn01 = Motion.Object:new(NPC, "s050_176_002", "bn01")
    local mercri = Obj:new(NPC, "s050_176_003")
    local mercri_index = GetIndex(NPC, "s050_176_003")
    local m_e002 = Motion.Object:new(NPC, "s050_176_003", "e002")
    local m_e004 = Motion.Object:new(NPC, "s050_176_003", "e004")
    local m_e005 = Motion.Object:new(NPC, "s050_176_003", "e005")
    local m_e008 = Motion.Object:new(NPC, "s050_176_003", "e008")
    local m_e012 = Motion.Object:new(NPC, "s050_176_003", "e012")
    local m_bn01 = Motion.Object:new(NPC, "s050_176_003", "bn01")
    local e002 = Motion.Object:new(PLAYER, "", "e002")
    local e004 = Motion.Object:new(PLAYER, "", "e004")
    local e008 = Motion.Object:new(PLAYER, "", "e008")
    local e012 = Motion.Object:new(PLAYER, "", "e012")
    local fn01_01 = Motion.Object:new(PLAYER, "", "fn01_01")
    HideMinimap(true)
    HideGuide(true)
    FieldObjectSync(NPC, true)
    WaitFrame(5)
    Cam.Inst:Set(2.788, 0.833, 77.119, -3.39, 3.091, 84.651, default, 30)
    Obj:new(PLAYER, ""):SetPos(-0.557, 0.022, 81.34)
    Obj:new(PLAYER, ""):SetRotationYToObject(NPC, "s050_176_001", 0)
    Field.ObjectLookAtTheObject(PLAYER, 1, NPC, rapid_index, 30)
    WaitFrame(30)
    FadeAllInWithWait(FADE_BLACK, FADE_TIME)
    tlk:StartTalkAndCancelDigimonRide()
    r_fq01:PlayWithStartMoveMotion(10, 10)
    tlk:Message(base .. "380")
    f_fq01:PlayWithStartMoveMotion(10, 10)
    tlk:Message(base .. "390")
    local result = tlk:Select(3, base .. "400")
    if result == RESULT_TALK00 then
      WaitFrame(15)
      r_fq01:PlayWithStartMoveMotion(10, 10)
      tlk:Message(base .. "410")
    elseif result == RESULT_TALK01 then
      WaitFrame(15)
      r_fq02:PlayWithStartMoveMotion(10, 10)
      tlk:Message(base .. "420")
    else
      WaitFrame(15)
      r_fq02:PlayWithStartMoveMotion(10, 10)
      tlk:Message(base .. "430")
    end
    tlk:Message(base .. "440")
    r_fq02:PlayWithStartMoveMotion(10, 10)
    tlk:Message(base .. "450")
    f_fq01:PlayWithStartMoveMotion(10, 10)
    tlk:Message(base .. "460")
    tlk:Message(base .. "470")
    r_fq01:PlayWithStartMoveMotion(10, 10)
    tlk:Message(base .. "480")
    tlk:Message(base .. "490")
    r_bn01:PlayWithStartMoveMotion(10, 10)
    Flg.Set(self.Flg04)
    Fade_OutNoLoadingWithWait(FADE_BLACK, FADE_TIME)
    FieldObjectSync(NPC, true)
    WaitFrame(5)
    Obj:new(PLAYER, ""):SetRotationYToObject(NPC, "s050_176_003", 0)
    Obj:new(NPC, "s050_176_003"):SetRotationYToObject(PLAYER, "", 0)
    Cam.Inst:Set(4.613, 3.608, 80.88, -4.764, 1.134, 83.316, default, 0)
    Field.ObjectLookAtTheObject(PLAYER, 1, NPC, mercri_index, 30)
    WaitFrame(30)
    FadeAllInWithWait(FADE_BLACK, FADE_TIME)
    mercri:ChangeExpression("F01_T01", EYE_BLINK, true, 10)
    m_e002:Play(10, true)
    tlk:Message(base .. "500")
    tlk:Message(base .. "510")
    tlk:Message(base .. "520")
    Field.ObjectResetMotion(NPC, mercri_index, 30)
    tlk:EndTalk()
    Fade_OutNoLoadingWithWait(FADE_BLACK, FADE_TIME)
    Cam.Inst:Clear(0)
    WaitFrame(30)
    HideMinimap(false)
    HideGuide(false)
    Field.ObjectResetAim(FLD_OBJ_PLAYER, 1, 0)
    Flg.Clear("FLAG_IS_NOT_MAP_NAME_DISP")
    Field.ObjectInvisible(NPC, mercri_index, 1, 0, false)
    FieldObjectSync(FOR_ALL, false)
    Qst.Sub:End(self.ID, self.STEP_255)
  end
end
