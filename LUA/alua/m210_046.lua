require("include")

function m210_046()
  EVENT_BEGIN()
  Talk.Load("m210")
  SetEventCutNo(3)
  if Debug.IsEventView() then
    SetTimeZone("Evening")
    SetTimeAxis("A2020_dbef_210")
    LoadMap("t0381b")
  end
  LoadModel("HERO_01", "Player")
  LoadModel("chr950_01", "char_TITAMON_2")
  Vista.BindSpeaker("chr950_01", "char_TITAMON")
  LoadSceneViewerResource("c1.0", "t0381b_pe")
  LoadSceneViewerResource("c2.0", "t0381b_pe")
  LoadSceneViewerResource("c3.0", "t0381b_pe")
  LoadEnvironmentFile("c1.0", "es_m210_046_c1.0")
  LoadEnvironmentFile("c2.0", "es_m210_046_c2.0")
  LoadEnvironmentFile("c3.0", "es_m210_046_c3.0")
  WaitVistaLoad()
  SetPosition("HERO_01", -0.8, 0, 9.5, "LINEAR", 0, 0)
  SetRotation("HERO_01", 0, 170, 0, "LINEAR", 0, 0)
  SetRotation("chr950_01", 0, 0, 0, "LINEAR", 0, 0)
  local pos = Battle.GetModelPosition(1, 0)
  SetPosition("chr950_01", pos.x, pos.y, pos.z, "LINEAR", 0, 0)
  local z = pos.z + 13
  PlayMotion("HERO_01", "fn01_01", 0, true, 0)
  SetFace("HERO_01", "E03_M01", 0, 1, 0, 0)
  BlendEye("HERO_01", 0, 0, "SCURVE", 0, 0)
  BlendFace("HERO_01", 0, 0, 0, true, "SCURVE", 0, 0)
  BlendFaceDigi("chr950_01", 0, 0, 0, "SCURVE", 0, 0)
  Flg.Set("FLAG_IS_NOT_MAP_NAME_DISP")
  FIELD_SET()
  EVENT_START()
  CUT("1.0")
  SetEnv_All("c1.0", 0)
  BlendFaceDigi("chr950_01", 0, 0, 0, "SCURVE", 0, 0)
  SetCamera(pos.x - 0.238, pos.y + 7.935, z - 6.631, 0, 50, "LINEAR", 0, false, 0, false)
  SetCameraTarget(pos.x + 0.299, pos.y + 6.27, z - 12.235, "LINEAR", 0, false, 0, false)
  SetCamera(pos.x + 1.798, pos.y + 7.955, z - 6.814, 0, 50, "LINEAR", 300, false, 0, true)
  SetCameraTarget(pos.x + 0.299, pos.y + 6.27, z - 12.235, "LINEAR", 300, false, 0, true)
  SetFace("chr950_01", "F03_M01", 0, 2, 0, 0)
  PlayMotion("chr950_01", "bn02", 0, true, 0)
  if Common.IsVoiceJapanese() then
    SetMouth("chr950_01", 0, 6, 0)
    SetMouth("chr950_01", 2, 6, 30)
    SetMouth("chr950_01", 0, 6, 75)
    SetMouth("chr950_01", 2, 6, 120)
  else
    SetMouth("chr950_01", 0, 6, 99)
    SetMouth("chr950_01", 2, 6, 133)
  end
  MessageTalk("m210_045_010")
  MessageClose()
  WaitFrame(10)
  if Common.IsVoiceJapanese() then
    SetMouth("chr950_01", 0, 6, 0)
    SetMouth("chr950_01", 2, 6, 9)
    SetMouth("chr950_01", 0, 6, 39)
    SetMouth("chr950_01", 2, 6, 103)
  else
    SetMouth("chr950_01", 0, 6, 33)
    SetMouth("chr950_01", 2, 6, 95)
  end
  MessageTalk("m210_045_020")
  MessageClose()
  WaitFrame(0)
  SetMouth("chr950_01", 2, 8, 0)
  WaitFrame(10)
  CUT("2.0")
  SetEnv_All("c2.0", 0)
  SetPosition("HERO_01", -0.8, 0, 9.5, "LINEAR", 0, 0)
  SetRotation("HERO_01", 0, 170, 0, "LINEAR", 0, 0)
  BlendEye("HERO_01", 0, 0, "SCURVE", 0, 0)
  BlendFace("HERO_01", 0, 0, 0, false, "SCURVE", 0, 0)
  SetCamera(-0.251, 1.209, 8.832, -12, 50, "LINEAR", 0, false, 0)
  SetCameraTarget(-1.046, 1.34, 9.75, "LINEAR", 0, false, 0)
  PlayMotion("chr950_01", "bd02", 0, true, 0)
  PlayMotion("HERO_01", "e018", 0, true, 15)
  SetFace("HERO_01", "F16", 0, 1, FACE_BLENDTIME, 0)
  SetFace("HERO_01", "F15", 0, 1, FACE_BLENDTIME, 15)
  Event_PlaySE(400001, 100, false, 0, 1)
  WaitFrame(50)
  SetCamera(-0.472, 1.367, 9.088, -12, 50, "SCURVE", 0, false, 0)
  SetCameraTarget(-0.952, 1.421, 9.85, "SCURVE", 0, false, 0)
  SetFace("HERO_01", "E03_M01", 2, 1, 3, 22)
  SetFace("HERO_01", "E03_M01", 1, 1, FACE_BLENDTIME, 25)
  WaitFrame(45)
  CUT("3.0")
  SetEnv_All("c3.0", 0)
  SetPosition("chr950_01", pos.x, pos.y, pos.z, "LINEAR", 0, 0)
  SetRotation("chr950_01", 0, 0, 0, "LINEAR", 0, 0)
  SetScale("chr950_01", 1.6, 1.6, 1.6)
  z = pos.z + 10
  SetCamera(pos.x + 1.813, pos.y + 2.714, z - 4.647, 0, 60, "LINEAR", 0, false, 0)
  SetCameraTarget(pos.x - 0.797, pos.y + 7.159, z - 12.933, "LINEAR", 0, false, 0)
  SetCamera(pos.x + 3.299, pos.y + 1.068, z - 0.666, 0, 61, "SCURVE", 80, true, 20, false)
  SetCameraTarget(pos.x, pos.y + 5.967, z - 12.435, "SCURVE", 80, true, 20, false)
  PlayMotion("chr950_01", "bd03", 3, false, 10)
  PlayMotion("chr950_01", "bn01", 2, true, 62)
  SetFace("chr950_01", "F03_M01", 0, 2, 0, 0)
  if Common.IsVoiceJapanese() then
    SetMouth("chr950_01", 0, 6, 30)
    SetMouth("chr950_01", 2, 6, 69)
    SetMouth("chr950_01", 0, 6, 90)
    SetMouth("chr950_01", 2, 6, 165)
    SetMouth("chr950_01", 0, 6, 210)
    SetMouth("chr950_01", 2, 6, 294)
  else
    SetMouth("chr950_01", 0, 6, 0)
    SetMouth("chr950_01", 2, 6, 24)
    SetMouth("chr950_01", 0, 6, 45)
    SetMouth("chr950_01", 2, 6, 97)
    SetMouth("chr950_01", 0, 6, 122)
    SetMouth("chr950_01", 2, 6, 153)
    SetMouth("chr950_01", 0, 6, 182)
    SetMouth("chr950_01", 2, 6, 210)
    SetMouth("chr950_01", 0, 6, 224)
    SetMouth("chr950_01", 2, 6, 275)
  end
  Event_PlaySE(404082, 100, false, 0, 0.7)
  MessageTalk("m210_045_030")
  MessageClose()
  WaitFrame(20)
  CAM_POS_WAIT(0)
  Vista.SetKeepBGM()
  Battle.PlayAnimation(1, 0, "bn01", 0, true, -1)
  Battle.ResetFormation(false)
  EVENT_END()
end

function CUT(cut_no)
  CUT_START(cut_no)
end

function main()
  m210_046()
end
