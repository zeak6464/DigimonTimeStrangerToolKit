require("include")

function arena_m320_01()
  Fade_Out(0, 0)
  EVENT_BEGIN()
  Talk.Load("arena01")
  SetEventCutNo(5)
  if Debug.IsEventView() then
    SetTimeZone("Noon")
    SetTimeAxis("P2028_daft_320")
    SetMapStatus("Enable")
    LoadMap("d0507")
  end
  LoadModel("AEGIOMON_01", "char_AEGIOMON")
  LoadModel("HERO_01", "Player")
  LoadModel("HEROINE_01", "char_HEROINE")
  LoadModel("chr403_01", "char_GRAPLEOMON")
  LoadModel("enemy_01", "char_MINOTAURMON")
  LoadModel("enemy_02", "char_MATADRMON")
  LoadModel("referee_01", "char_ETEMON")
  LoadSceneViewerResource("c1.0", "d0507f_sa")
  LoadSceneViewerResource("c2.0", "d0507f_sa")
  LoadSceneViewerResource("c3.0", "d0507f_sa")
  LoadSceneViewerResource("c4.0", "d0507f_sa")
  LoadEnvironmentFile("c1.0", "es_m320_020_c1.0")
  LoadEnvironmentFile("c2.0", "es_m320_020_c2.0")
  LoadEnvironmentFile("c3.0", "es_m320_020_c3.0")
  LoadEnvironmentFile("c4.0", "es_m320_020_c4.0")
  WaitVistaLoad()
  Event_PlayBGM(313, 0, 0)
  local slot_id = Event_PlaySE(405004, 100, true, 0, 0)
  ModelVisible("HERO_01", false, 0, 0)
  ModelVisible("AEGIOMON_01", false, 0, 0)
  ModelVisible("HEROINE_01", false, 0, 0)
  ModelVisible("chr403_01", false, 0, 0)
  ModelVisible("enemy_01", false, 0, 0)
  ModelVisible("enemy_02", false, 0, 0)
  SetPosition("AEGIOMON_01", 6, 0, -0.494, "LINEAR", 0, 0)
  SetRotation("AEGIOMON_01", 0, -90, 0, "LINEAR", 0, 0)
  SetPosition("HERO_01", 6, 0, 0.833, "LINEAR", 0, 0)
  SetRotation("HERO_01", 0, -90, 0, "LINEAR", 0, 0)
  SetPosition("HEROINE_01", 6.978, 0, 0.19, "LINEAR", 0, 0)
  SetRotation("HEROINE_01", 0, -90, 0, "LINEAR", 0, 0)
  SetPosition("chr403_01", 5.449, -0.118, 1.374, "LINEAR", 0, 0)
  SetRotation("chr403_01", 0, -90, 0, "LINEAR", 0, 0)
  SetPosition("enemy_01", -8.688, 0, -1.971, "LINEAR", 0, 0)
  SetRotation("enemy_01", 0, 90, 0, "LINEAR", 0, 0)
  SetPosition("enemy_02", -6.785, 0, 0.529, "LINEAR", 0, 0)
  SetRotation("enemy_02", 0, 90, 0, "LINEAR", 0, 0)
  PlayMotion("AEGIOMON_01", "bn01", 0, true, 0)
  SetFace("AEGIOMON_01", "E03_M14", 0, 1, FACE_BLENDTIME, 0)
  PlayMotion("HERO_01", "bn01", 0, true, 0)
  SetFace("HERO_01", "E03_M15", 0, 1, FACE_BLENDTIME, 0)
  PlayMotion("HEROINE_01", "e005_01", 0, true, 0)
  SetFace("HEROINE_01", "F04", 0, 1, FACE_BLENDTIME, 0)
  PlayMotion("enemy_01", "bn01", 0, true, 0)
  SetFace("enemy_01", "F03", 0, 1, FACE_BLENDTIME, 0)
  PlayMotion("enemy_02", "bn01", 0, true, 0)
  SetFace("enemy_02", "F03", 0, 1, FACE_BLENDTIME, 0)
  SetPosition("referee_01", 0.443, 0, 3.568, "LINEAR", 0, 0)
  SetRotation("referee_01", 0, 180, 0, "LINEAR", 0, 0)
  PlayMotion("referee_01", "f000", 0, true, 0)
  SetFace("referee_01", "F01", 0, 1, FACE_BLENDTIME, 0)
  BlendEye("AEGIOMON_01", 0, 0, "SCURVE", 0, 0)
  BlendFace("AEGIOMON_01", 0, 0, 0, false, "SCURVE", 0, 0)
  BlendEye("HERO_01", 0, 0, "SCURVE", 0, 0)
  BlendFace("HERO_01", 0, 0, 0, false, "SCURVE", 0, 0)
  BlendEye("HEROINE_01", 0, 0, "SCURVE", 0, 0)
  BlendFace("HEROINE_01", 0, 0, 0, false, "SCURVE", 0, 0)
  BlendFaceDigi("enemy_01", 0, 0, 0, "SCURVE", 0, 0)
  BlendFaceDigi("enemy_02", 0, 0, 0, "SCURVE", 0, 0)
  SetCamera(-33.719, 20.895, -4.736, -10, 30, "LINEAR", 0, false, 0, false)
  SetCameraTarget(9.201, 14.993, 0.471, "LINEAR", 0, false, 0, false)
  SetCamera(-19.382, 5.118, 24.855, -10, 30, "SCURVE", 180, true, 0, false)
  SetCameraTarget(4.609, 15.63, -4.998, "SCURVE", 180, true, 0, false)
  SetCamera(-15.081, 0.385, 33.732, -10, 30, "DECEL", 200, true, 175, false)
  SetCameraTarget(3.231, 15.821, -6.639, "DECEL", 200, true, 175, false)
  FIELD_SET()
  EVENT_START()
  CUT("1.0")
  SetEnv_All("c1.0", 0)
  Fade_In(FADE_BLACK, FADE_TIME)
  WaitFrame(30)
  MessageTalk("arena01_m320_010_010")
  MessageClose()
  WaitFrame(10)
  CUT("2.0")
  SetEnv_All("c3.0", 0)
  ModelVisible("HERO_01", true, 0, 0)
  ModelVisible("chr403_01", true, 0, 0)
  if Debug.IsEventView() then
    ModelVisible("AEGIOMON_01", true, 0, 0)
  else
    local aegio = Field.GetFollowerIndexForAegiomon()
    if aegio ~= nil then
      ModelVisible("AEGIOMON_01", true, 0, 0)
    end
    Field_CancelInvisibleFollowerAllPartyMember(INVISIBLE_KEY_EVENT, 0, false, true)
    WaitFrame(1)
    Field.FollowerWarp()
    WaitFrame(1)
    local index = Digimon.GetUniqueIDInPartyMember(1)
    if index ~= nil then
      local party = Field.GetFollowerIndexByPartyUniqueID(index)
      Field.ObjectSetRotationY(FLD_OBJ_FOLLOWER, party, -90, 0)
      Field.ObjectSetPos(FLD_OBJ_FOLLOWER, party, 8.99, 0.01, 1.14, false)
    end
    local index = Digimon.GetUniqueIDInPartyMember(2)
    if index ~= nil then
      local party = Field.GetFollowerIndexByPartyUniqueID(index)
      Field.ObjectSetRotationY(FLD_OBJ_FOLLOWER, party, -90, 0)
      Field.ObjectSetPos(FLD_OBJ_FOLLOWER, party, 7.81, 0.01, 3.62, false)
    end
    local index = Digimon.GetUniqueIDInPartyMember(3)
    if index ~= nil then
      local party = Field.GetFollowerIndexByPartyUniqueID(index)
      Field.ObjectSetRotationY(FLD_OBJ_FOLLOWER, party, -90, 0)
      Field.ObjectSetPos(FLD_OBJ_FOLLOWER, party, 5.6, 0.01, 3.91, false)
    end
  end
  SetPosition("AEGIOMON_01", 5.564, -0.118, -0.526, "LINEAR", 0, 0)
  SetRotation("AEGIOMON_01", 0, -90, 0, "LINEAR", 0, 0)
  SetPosition("HERO_01", 6.965, 0, 0.206, "LINEAR", 0, 0)
  SetRotation("HERO_01", 0, -90, 0, "LINEAR", 0, 0)
  SetPosition("HEROINE_01", 12.627, 0, 0.19, "LINEAR", 0, 0)
  SetRotation("HEROINE_01", 0, -90, 0, "LINEAR", 0, 0)
  SetPosition("chr403_01", 5.449, -0.118, 1.374, "LINEAR", 0, 0)
  SetRotation("chr403_01", 0, -90, 0, "LINEAR", 0, 0)
  PlayMotion("AEGIOMON_01", "bn01", 0, true, 0)
  SetFace("AEGIOMON_01", "E03_M14", 0, 1, 0, 0)
  PlayMotion("HERO_01", "bn01", 0, true, 0)
  SetFace("HERO_01", "E03_M15", 0, 1, 0, 0)
  SetFace("HEROINE_01", "E03_M15", 0, 1, 0, 0)
  PlayMotion("chr403_01", "bn01", 0, true, 0)
  SetFace("chr403_01", "F01", 0, 1, 0, 0)
  SetCamera(9.323, 0.112, -5.047, 0, 18, "LINEAR", 0, false, 0, false)
  SetCameraTarget(5.876, 1.444, 0.654, "LINEAR", 0, false, 0, false)
  SetCamera(1.837, 0, -5.982, 0, 18, "SCURVE", 60, false, 0, false)
  SetCameraTarget(5.702, 1.498, 0.6, "SCURVE", 60, false, 0, false)
  SetCamera(-0.456, 0, -5.6, 0, 18, "LINEAR", 150, true, 60, false)
  SetCameraTarget(5.503, 1.466, 0.57, "LINEAR", 150, true, 60, false)
  WaitFrame(10)
  MessageTalk("arena01_m320_010_020")
  MessageClose()
  WaitFrame(10)
  CUT("3.0")
  SetEnv_All("c2.0", 0)
  ModelVisible("enemy_01", true, 0, 0)
  ModelVisible("enemy_02", true, 0, 0)
  SetPosition("enemy_01", -9.018, 0, -1.39, "LINEAR", 0, 0)
  SetRotation("enemy_01", 0, 90, 0, "LINEAR", 0, 0)
  SetPosition("enemy_02", -6.295, 0, 0.529, "LINEAR", 0, 0)
  SetRotation("enemy_02", 0, 101.5, 0, "LINEAR", 0, 0)
  SetCamera(-16.375, 0.01, -8.851, 0, 18, "LINEAR", 0, false, 0, false)
  SetCameraTarget(-6.701, 1.535, 0.507, "LINEAR", 0, false, 0, false)
  SetCamera(-4.505, 0.01, -10.591, 0, 18, "SCURVE", 60, false, 0, false)
  SetCameraTarget(-7.771, 1.535, 0.507, "SCURVE", 60, false, 0, false)
  SetCamera(-1.265, 0.01, -10.891, 0, 18, "LINEAR", 150, true, 60, false)
  SetCameraTarget(-7.821, 1.535, 0.507, "LINEAR", 150, true, 60, false)
  WaitFrame(10)
  MessageTalk("arena01_m320_010_030")
  MessageClose()
  WaitFrame(10)
  CUT("4.0")
  SetEnv_All("c2.0", 0)
  ModelVisible("enemy_01", true, 0, 0)
  ModelVisible("enemy_02", true, 0, 0)
  SetPosition("enemy_01", -8.218, 0, -1.09, "LINEAR", 0, 0)
  SetRotation("enemy_01", 0, 90, 0, "LINEAR", 0, 0)
  SetPosition("enemy_02", -6.295, 0, 1.36, "LINEAR", 0, 0)
  SetRotation("enemy_02", 0, 101.5, 0, "LINEAR", 0, 0)
  SetCamera(-3.329, 1.346, 0.266, 0, 45, "LINEAR", 0, true, 0, false)
  SetCameraTarget(-13.31, 1.955, 0.266, "LINEAR", 0, true, 0, false)
  WaitFrame(10)
  PlayMotion("enemy_02", "fe02", 10, false, 0)
  PlayMotion("enemy_02", "bn01", 10, true, 70)
  WaitFrame(10)
  SetFace("enemy_02", "F03", 0, 1, FACE_BLENDTIME, 0)
  MessageTalk("arena01_m320_010_040")
  SetFace("enemy_02", "F03", 0, 1, FACE_BLENDTIME, 0)
  MessageClose()
  WaitFrame(10)
  PlayMotion("enemy_01", "fe01", 10, true, 0)
  WaitFrame(30)
  SetFace("enemy_01", "F03", 0, 1, FACE_BLENDTIME, 0)
  MessageTalk("arena01_m320_010_041")
  SetFace("enemy_01", "F03", 0, 1, FACE_BLENDTIME, 0)
  MessageClose()
  WaitFrame(10)
  SetRotation("enemy_02", 0, 135, 0, "LINEAR", 20, 0)
  WaitFrame(10)
  PlayMotion("enemy_02", "fe04", 10, false, 0)
  PlayMotion("enemy_02", "bn01", 10, true, 80)
  WaitFrame(10)
  SetFace("enemy_02", "F03", 0, 1, FACE_BLENDTIME, 0)
  MessageTalk("arena01_m320_010_042")
  SetFace("enemy_02", "F03", 0, 1, FACE_BLENDTIME, 0)
  MessageClose()
  PlayMotion("enemy_01", "bn01", 10, true, 0)
  WaitFrame(20)
  CUT("5.0")
  SetEnv_All("c4.0", 0)
  if Debug.IsEventView() then
    ModelVisible("HEROINE_01", true, 0, 0)
  else
    local heroine = Field.GetFollowerIndexByGuestID(GST_HEROINE)
    if heroine ~= nil then
      ModelVisible("HEROINE_01", true, 0, 0)
    end
    Field_CancelInvisibleFollowerAllPartyMember(INVISIBLE_KEY_EVENT, 0, false, true)
    local index = Digimon.GetUniqueIDInPartyMember(1)
    if index ~= nil then
      local party = Field.GetFollowerIndexByPartyUniqueID(index)
      Field.ObjectSetRotationY(FLD_OBJ_FOLLOWER, party, -90, 0)
      Field.ObjectSetPos(FLD_OBJ_FOLLOWER, party, 8.99, 0, 2.14, false)
    end
    local index = Digimon.GetUniqueIDInPartyMember(2)
    if index ~= nil then
      local party = Field.GetFollowerIndexByPartyUniqueID(index)
      Field.ObjectSetRotationY(FLD_OBJ_FOLLOWER, party, -90, 0)
      Field.ObjectSetPos(FLD_OBJ_FOLLOWER, party, 9.95, 0, 0.08, false)
    end
    local index = Digimon.GetUniqueIDInPartyMember(3)
    if index ~= nil then
      local party = Field.GetFollowerIndexByPartyUniqueID(index)
      Field.ObjectSetRotationY(FLD_OBJ_FOLLOWER, party, -90, 0)
      Field.ObjectSetPos(FLD_OBJ_FOLLOWER, party, 9.29, 0, -2, false)
    end
  end
  SetPosition("AEGIOMON_01", 5.893, 0, -1.83, "LINEAR", 0, 0)
  SetRotation("AEGIOMON_01", 0, -90, 0, "LINEAR", 0, 0)
  SetPosition("HERO_01", 7.266, 0, -0.057, "LINEAR", 0, 0)
  SetRotation("HERO_01", 0, -118.5, 0, "LINEAR", 0, 0)
  SetPosition("HEROINE_01", 11.343, 0, 0, "LINEAR", 0, 0)
  SetRotation("HEROINE_01", 0, -109, 0, "LINEAR", 0, 0)
  SetPosition("chr403_01", 5.449, -0.118, 1.374, "LINEAR", 0, 0)
  SetRotation("chr403_01", 0, -90, 0, "LINEAR", 0, 0)
  SetPosition("enemy_01", -7.019, 0, -2.5, "LINEAR", 0, 0)
  SetRotation("enemy_01", 0, 92.5, 0, "LINEAR", 0, 0)
  SetPosition("enemy_02", -4.685, 0, 0, "LINEAR", 0, 0)
  SetRotation("enemy_02", 0, 92.5, 0, "LINEAR", 0, 0)
  BlendEye("HEROINE_01", 0, 0, "SCURVE", 0, 0)
  BlendFace("HEROINE_01", -38, 0, 0, false, "SCURVE", 0, 0)
  SetCamera(-0, 5.8, 6.565, 0, 20, "LINEAR", 0, false, 0, false)
  SetCameraTarget(0, 11.105, 37.683, "LINEAR", 0, false, 0, false)
  SetCamera(-0, 1.712, -30.731, 0, 33, "DECEL", 10, false, 0, false)
  SetCameraTarget(0, 5.361, 0, "DECEL", 10, false, 0, false)
  SetCamera(0, 1.53, -32.268, 0, 33, "LINEAR", 150, true, 10, false)
  SetCameraTarget(0, 5.361, 0, "LINEAR", 150, true, 10, false)
  MessageTalk("arena01_m320_010_050")
  MessageClose()
  WaitFrame(15)
  Fade_OutNoLoadingWithWait(1, 2)
  PlaySE(101006, 100)
  WaitFrame(20)
  Event_StopAllSE(0.2, 0)
  if Debug.IsEventView() then
  end
  EVENT_END()
end

function CUT(cut_no)
  CUT_START(cut_no)
end

function main()
  arena_m320_01()
end
