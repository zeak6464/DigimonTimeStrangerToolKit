gGimText = "field_text"

function Prcs_h06_SwitchGim(gim_loc, obj_loc1, obj_loc2, col_name1, col_name2, state_name)
  local state = GetControlScriptExternalVariableString(state_name)
  SetControlScriptExternalVariable("gim_check", gim_loc)
  SetPlayerRotationToLocator(gim_loc, 10)
  WaitFrame(10)
  Motion.Player:Play("fg07_u01", 0, false)
  WaitFrame(50)
  SetControlScriptExternalVariable("gim_camera", state_name)
  if state == "black" then
    Motion.Gimmick:Play(gim_loc, "e002", false)
    PlaySE(200002, 100)
    Motion.Gimmick:Play(obj_loc1, "e001", false)
    Motion.Gimmick:Play(obj_loc2, "e002", false)
    WaitFrame(20)
    ColOn(col_name1)
    ColOff(col_name2)
    SetControlScriptExternalVariable(state_name, "white")
  elseif state == "white" then
    Motion.Gimmick:Play(gim_loc, "e004", false)
    PlaySE(200002, 100)
    Motion.Gimmick:Play(obj_loc1, "e002", false)
    Motion.Gimmick:Play(obj_loc2, "e001", false)
    WaitFrame(20)
    ColOff(col_name1)
    ColOn(col_name2)
    SetControlScriptExternalVariable(state_name, "black")
  end
end

function Prcs_h06_WarpGim(move_in, exit, move_out, col_in, col_out)
  ColOff(col_in)
  ColOff(col_out)
  SetFollowerCameraOperateRotation(0, 270)
  local p = Field.ObjectGetPosition(FLD_OBJ_PLAYER, 1)
  Cam.Inst:Set(p.x, p.y + 2, p.z, p.x, p.y + 2, p.z + 80, 10, 80)
  Field.MovePlayerToLocatorFrame(move_in, 40)
  WaitFrame(40)
  Obj:new(PLAYER, ""):Invisible(10)
  WaitFrame(50)
  SetPlayerLocator(exit)
  p = Field.ObjectGetPosition(FLD_OBJ_PLAYER, 1)
  Cam.Inst:Set(p.x, p.y + 2, p.z, p.x, p.y + 2, p.z + 80, 10, 60)
  WaitFrame(60)
  Obj:new(PLAYER, ""):CancelInvisible(10)
  Field_CancelInvisiblePlayer(0, 10, false, false)
  Field.MovePlayerToLocatorFrame(move_out, 40)
  WaitFrame(40)
  Cam.Inst:Clear(45)
  ColOn(col_in)
  ColOn(col_out)
  WaitFrame(10)
end

function Prcs_h0601_TowerWarp(in_col, in_loc, exit_loc, move_loc)
  SetControlScriptExternalVariable("lteral_movement", "stop")
  Field_InvisibleFollowerAllPartyMember(0, 15, false)
  Field_InvisibleFollowerAllGuest(0, 15, false)
  local player_pos = Field.ObjectGetPosition(FLD_OBJ_PLAYER, 1)
  Cam.Inst:Set(player_pos.x, player_pos.y + 2, player_pos.z, player_pos.x, player_pos.y + 2, player_pos.z + 15, default, 20)
  Field.MovePlayerToLocatorFrame(in_loc, 20)
  local index = GetIndex(FLD_OBJ_LOCATOR, in_loc)
  local pos = Field.ObjectGetPosition(FLD_OBJ_LOCATOR, index)
  local degree = Field.ObjectGetRotationY(FLD_OBJ_LOCATOR, index)
  PlayEffectScript("ef_f_mov_111_wa", pos.x, pos.y + 1, pos.z, degree, 1)
  PlaySE(200006, 100)
  WaitFrame(20)
  Obj:new(PLAYER, ""):Invisible(5)
  WaitFrame(15)
  SetPlayerLocator(exit_loc)
  player_pos = Field.ObjectGetPosition(FLD_OBJ_PLAYER, 1)
  Cam.Inst:Set(player_pos.x, player_pos.y + 2, player_pos.z, player_pos.x, player_pos.y + 2, player_pos.z + 15, default, 15)
  WaitFrame(15)
  local index = GetIndex(FLD_OBJ_LOCATOR, exit_loc)
  local pos = Field.ObjectGetPosition(FLD_OBJ_LOCATOR, index)
  local degree = Field.ObjectGetRotationY(FLD_OBJ_LOCATOR, index)
  PlayEffectScript("ef_f_mov_111_wa", pos.x, pos.y + 1, pos.z, degree, 1)
  PlaySE(200006, 100)
  WaitFrame(20)
  Obj:new(PLAYER, ""):CancelInvisible(10)
  Field.MovePlayerToLocatorFrame(move_loc, 25)
  WaitFrame(20)
  Field_CancelInvisibleFollowerAllPartyMember(0, 20, false, false)
  Field_CancelInvisibleFollowerAllGuest(0, 20, false, false)
  Cam.Inst:Clear(30)
  SetControlScriptExternalVariable("lteral_movement", "start")
  SetControlScriptExternalVariable("change_cam", "start")
end
