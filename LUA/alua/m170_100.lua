require("include")

function m170_100()
  Fade_Out(0, 0)
  EVENT_BEGIN()
  Talk.Load("m170")
  SetEventCutNo(5)
  if Debug.IsEventView() then
    SetTimeZone("Noon")
    SetTimeAxis("A2020_dbef_170")
    LoadMap("d0301")
  end
  LoadModel("HERO_01", "Player")
  LoadModel("HEROINE_01", "char_HEROINE")
  LoadModel("AEGIOMON_01", "char_AEGIOMON")
  LoadModel("chr917_01", "char_WHAMON_BIG")
  LoadEffectScript("eff_01", "ef_e_com_106")
  LoadEffectScript("eff_02", "ef_e_com_105")
  LoadEffectScript("eff_13", "ef_e_com_107")
  LoadObject("COLLINGSHELL_01", "atc_callingshell00")
  LoadSceneViewerResource("c1.0", "d0301f_sa")
  LoadSceneViewerResource("c2.0", "d0301f_sa")
  LoadSceneViewerResource("c3.0", "d0301f_sa")
  LoadSceneViewerResource("c4.0", "d0301f_sa")
  LoadSceneViewerResource("c5.0", "d0301f_sa")
  LoadEnvironmentFile("c1.0", "es_m170_100_c1.0")
  LoadEnvironmentFile("c2.0", "es_m170_100_c2.0")
  LoadEnvironmentFile("c3.0", "es_m170_100_c3.0")
  LoadEnvironmentFile("c4.0", "es_m170_100_c4.0")
  LoadEnvironmentFile("c5.0", "es_m170_100_c5.0")
  WaitVistaLoad()
  SetPosition("HERO_01", -8.834, 2.776, 9.1, "LINEAR", 0, 0)
  SetRotation("HERO_01", 0, -90, 0, "LINEAR", 0, 0)
  SetPosition("HEROINE_01", -6.25, 2.251, 8, "LINEAR", 0, 0)
  SetRotation("HEROINE_01", 0, -90, 0, "LINEAR", 0, 0)
  SetPosition("AEGIOMON_01", -7, 2.386, 9.8, "LINEAR", 0, 0)
  SetRotation("AEGIOMON_01", 0, -108, 0, "LINEAR", 0, 0)
  SetPosition("chr917_01", -25, -2, 9.5, "LINEAR", 0, 0)
  SetRotation("chr917_01", -11, 90, 0, "LINEAR", 0, 0)
  SetScale("chr917_01", 3.75, 3.75, 3.75)
  SetPosition("eff_01", -20.525, 1.043, 9.927, "LINEAR", 0, 0)
  SetRotation("eff_01", 0, 0, 0, "LINEAR", 0, 0)
  SetScale("eff_01", 4, 4, 4)
  PlayMotion("HERO_01", "e212", 0, true, 0)
  SetFace("HERO_01", "F01", 0, 1, FACE_BLENDTIME, 0)
  AttachObject("HERO_01", "COLLINGSHELL_01", 9)
  PlayMotion("HEROINE_01", "fn01_01", 0, true, 0)
  SetFace("HEROINE_01", "F01", 0, 1, FACE_BLENDTIME, 0)
  PlayMotion("AEGIOMON_01", "fn01_01", 0, true, 0)
  SetFace("AEGIOMON_01", "F01", 0, 1, FACE_BLENDTIME, 0)
  BlendEye("HERO_01", 0, 0, "SCURVE", 0, 0)
  BlendFace("HERO_01", 0, 0, 0, true, "SCURVE", 0, 0)
  BlendEye("HEROINE_01", 0, 0, "SCURVE", 0, 0)
  BlendFace("HEROINE_01", 0, 0, 0, true, "SCURVE", 0, 0)
  BlendEye("AEGIOMON_01", 0, 0, "SCURVE", 0, 0)
  BlendFace("AEGIOMON_01", 0, 0, 0, true, "SCURVE", 0, 0)
  BlendFaceDigi("chr917_01", 0, 0, 0, "SCURVE", 0, 0)
  ModelVisible("chr917_01", false, 0, 0)
  ModelVisible("AEGIOMON_01", false, 0, 0)
  SetEnv_All("c1.0", 0)
  SetCamera(-9.694, 3.887, 9.668, 0, 40, "LINEAR", 0, false, 0)
  SetCameraTarget(-8.974, 4.096, 9.051, "LINEAR", 0, false, 0)
  FIELD_SET()
  NpcInvisible(FOR_ALL)
  EVENT_START()
  CUT("1.0")
  SetCamera(-7.337, 2.9, 11.983, 0, 40, "SCURVE_B", 120, true, 20)
  SetCameraTarget(-9.47, 4.236, 8.961, "SCURVE_B", 120, true, 20)
  Vista.SetNextAnimationPlaySpeed(0.4)
  local slot_id = Event_PlaySE(401036, 100, false, 0, 2.5)
  PlayMotion("HERO_01", "e213", 0, false, 0)
  SetFace("HERO_01", "F01", 2, 1, FACE_BLENDTIME, 30)
  SetFace("HERO_01", "E01_M16", 0, 1, FACE_BLENDTIME, 70)
  Fade_In(0, FADE_TIME)
  WaitFrame(150)
  CUT("2.0")
  SetEnv_All("c2.0", 0)
  SetCamera(-12.378, 2.178, 15.14, 0, 50, "LINEAR", 0, false, 0)
  SetCameraTarget(-23.657, 6.519, 10.452, "LINEAR", 0, false, 0)
  SetCameraTarget(-23.657, 7.54, 10.452, "DECEL", 20, true, 30)
  SetCameraTarget(-23.657, 6.519, 10.452, "DECEL", 10, true, 60)
  Event_Quake_Start(7, 7, 30, 10)
  Vista.SetNextAnimationPlaySpeed(1)
  local slot_id = Event_PlaySE(403039, 100, false, 0, 0)
  PlayEffect("eff_02", false, 20)
  PlayMotion("HERO_01", "e212", 4, true, 0)
  PlayMotion("HEROINE_01", "e006", 4, true, 10)
  PlayMotion("AEGIOMON_01", "e006", 4, true, 6)
  ModelVisible("AEGIOMON_01", true, 0, 0)
  SetPosition("chr917_01", -25, 0, 9.5, "LINEAR", 0, 0)
  SetRotation("chr917_01", -11, 90, 0, "LINEAR", 0, 0)
  SetPosition("chr917_01", -25, 2, 9.5, "DECEL", 20, 30)
  SetPosition("chr917_01", -25, 0, 9.5, "DECEL", 20, 60)
  SetPosition("eff_02", -25, 0, 9.5, "LINEAR", 0, 0)
  SetRotation("eff_02", -11, 90, 0, "LINEAR", 0, 0)
  SetScale("eff_02", 1, 1, 1)
  ModelVisible("chr917_01", true, 0, 20)
  PlayMotion("chr917_01", "f007", 0, false, 20)
  MessageTalk("m170_100_030")
  MessageClose()
  WaitFrame(10)
  MOTION_WAIT("chr917_01", 0, 0)
  WaitFrame(30)
  Event_Quake_Stop(1)
  CUT("3.0")
  SetEnv_All("c3.0", 0)
  SetCamera(0.149, 6.195, 24.484, 0, 40, "LINEAR", 0, false, 0)
  SetCameraTarget(-14.842, 5.169, 9.548, "LINEAR", 0, false, 0)
  SetPosition("chr917_01", -25, -1, 9.5, "LINEAR", 0, 0)
  SetRotation("chr917_01", -11, 90, 0, "LINEAR", 0, 0)
  SetScale("chr917_01", 3.75, 3.75, 3.75)
  local slot_id = Event_PlaySE(403058, 100, false, 0, 0)
  PlayEffect("eff_01", true, 30)
  SetPosition("eff_08", -19.5, 0, 14.25, "LINEAR", 0, 0)
  SetRotation("eff_08", 0, 0, 0, "LINEAR", 0, 0)
  SetScale("eff_08", 1, 1, 1)
  SetPosition("eff_09", -15.493, 0, 6.502, "LINEAR", 0, 0)
  SetRotation("eff_09", 0, 0, 0, "LINEAR", 0, 0)
  SetScale("eff_09", 1, 1, 1)
  SetPosition("eff_10", -16.33, 0.6, 14, "LINEAR", 0, 0)
  SetRotation("eff_10", 0, 0, 0, "LINEAR", 0, 0)
  SetScale("eff_10", 1, 1, 1)
  SetPosition("eff_11", -13.72, 0.6, 12.4, "LINEAR", 0, 0)
  SetRotation("eff_11", 0, 0, 0, "LINEAR", 0, 0)
  SetScale("eff_11", 1, 1, 1)
  SetPosition("eff_12", -34.4, -2, 13.66, "LINEAR", 0, 0)
  SetRotation("eff_12", 0, 0, 0, "LINEAR", 0, 0)
  SetScale("eff_12", 1, 1, 1)
  PlayMotion("chr917_01", "f000", 2, false, 30)
  PlayMotion("chr917_01", "f004", 4, false, 81)
  PlayMotion("chr917_01", "f001", 25, true, 177)
  EndMotion("HERO_01", 12)
  EndMotion("HEROINE_01", 18)
  EndMotion("AEGIOMON_01", 5)
  WaitFrame(90)
  MessageTalk("m170_100_040")
  MessageClose()
  WaitFrame(10)
  MessageTalkSel(3, "m170_100_050")
  result = Talk.GetResultSelectedNum()
  if result == RESULT_TALK00 then
    PlayMotionBlend("HERO_01", "blend01", 0, false, 0)
    WaitFrame(40)
    PlayMotion("chr917_01", "e500", 5, false, 0)
    PlayMotion("chr917_01", "f001", 3, true, 96)
    MessageTalk("m170_100_060")
    MessageClose()
    WaitFrame(10)
  elseif result == RESULT_TALK01 then
    PlayMotionBlend("HERO_01", "blend01", 0, false, 0)
    WaitFrame(40)
    PlayMotion("chr917_01", "e500", 5, false, 0)
    PlayMotion("chr917_01", "f001", 3, true, 96)
    SetFace("chr917_01", "F01", 0, 1, FACE_BLENDTIME, 0)
    MessageTalk("m170_100_070")
    MessageClose()
    WaitFrame(10)
  elseif result == RESULT_TALK02 then
    PlayMotionBlend("HERO_01", "blend01", 0, false, 0)
    WaitFrame(40)
    PlayMotion("chr917_01", "e500", 5, false, 0)
    PlayMotion("chr917_01", "f001", 3, true, 96)
    SetFace("chr917_01", "F01", 0, 1, FACE_BLENDTIME, 0)
    MessageTalk("m170_100_080")
    MessageClose()
    WaitFrame(10)
  end
  CUT("4.0")
  SetEnv_All("c4.0", 0)
  SetCamera(-2.785, 4.121, 11.586, 0, 50, "LINEAR", 0, false, 0)
  SetCameraTarget(-13.12, 4.08, 9, "LINEAR", 0, false, 0)
  SetPosition("chr917_01", -25, -2, 9.5, "LINEAR", 0, 0)
  SetRotation("chr917_01", -11, 95.5, 0, "LINEAR", 0, 0)
  SetScale("chr917_01", 3.75, 3.75, 3.75)
  SetFace("HERO_01", "F01", 0, 1, 0, 0)
  PlayMotion("chr917_01", "f004", 0, true, 0)
  MessageTalk("m170_100_090")
  MessageClose()
  WaitFrame(10)
  Fade_OutNoLoadingWithWait(0, 10)
  CUT("5.0")
  SetEnv_All("c5.0", 0)
  SetCamera(-4.573, 1.863, 22.281, 0, 50, "LINEAR", 0, false, 0)
  SetCameraTarget(-20.604, 4.947, 11.213, "LINEAR", 0, false, 0)
  SetCamera(-1.545, 5.033, 2.019, 0, 50, "SCURVE_B", 190, true, 0)
  SetCameraTarget(-38.454, 4.947, 6.983, "SCURVE_B", 190, true, 0)
  DetachObject("COLLINGSHELL_01", "HERO_01", 9)
  SetScale("COLLINGSHELL_01", 0, 0, 0)
  ModelVisible("HERO_01", false, 0, 0)
  ModelVisible("HEROINE_01", false, 0, 0)
  ModelVisible("AEGIOMON_01", false, 0, 0)
  PlayMotion("chr917_01", "f008", 0, false, 0)
  ModelVisible("eff_01", false, 0, 0)
  local slot_id = Event_PlaySE(403059, 100, false, 0, 0)
  Fade_In(0, 10)
  SetPosition("chr917_01", -25, 4, 9.5, "LINEAR", 40, 100)
  SetPosition("eff_13", -25, 0, 9.5, "LINEAR", 0, 0)
  SetRotation("eff_13", -11, 95.5, 0, "LINEAR", 0, 0)
  SetScale("eff_13", 1, 1, 1)
  PlayEffect("eff_13", false, 0)
  WaitFrame(210)
  Fade_OutNoLoadingWithWait(FADE_BLACK, FADE_TIME)
  EVENT_END()
end

function CUT(cut_no)
  CUT_START(cut_no)
end

function main()
  m170_100()
end
