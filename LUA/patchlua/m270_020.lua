require("include")

function m270_020()
  Fade_Out(0, 0)
  EVENT_BEGIN()
  Talk.Load("m270")
  SetEventCutNo(6)
  if Debug.IsEventView() then
    SetTimeZone("Noon")
    SetTimeAxis("A2028_daft_270")
    LoadMap("t3003")
  end
  LoadModel("HOMEROS_01", "char_HOMEROS")
  LoadModel("YGGDRASILL_01", "char_YGGDRASILL")
  LoadModel("TOUHOU_01", "char_TOUHO")
  LoadModel("HERO_01", "Player")
  LoadModel("AEGIOMON_01", "char_AEGIOMON")
  LoadModel("HEROINE_01", "char_HEROINE")
  LoadModel("MIREI_01", "char_MIREI_CHILD")
  LoadSceneViewerResource("c1.0", "m270_020_c1.0")
  LoadSceneViewerResource("c2.0", "m270_020_c1.0")
  LoadSceneViewerResource("c3.0", "m270_020_c1.0")
  LoadSceneViewerResource("c4.0", "m270_020_c1.0")
  LoadSceneViewerResource("c5.0", "m270_020_c1.0")
  LoadSceneViewerResource("c6.0", "m270_020_c1.0")
  LoadEnvironmentFile("c1.0", "es_m270_020_c1.0")
  LoadEnvironmentFile("c2.0", "es_m270_020_c2.0")
  LoadEnvironmentFile("c3.0", "es_m270_020_c3.0")
  LoadEnvironmentFile("c4.0", "es_m270_020_c4.0")
  LoadEnvironmentFile("c5.0", "es_m270_020_c5.0")
  LoadEnvironmentFile("c6.0", "es_m270_020_c6.0")
  WaitVistaLoad()
  NpcInvisible(FOR_ALL)
  Vista.SetEnableLipSyncsAnimation("HOMEROS_01", false)
  SetPosition("HOMEROS_01", 7.247, 0, -8.894, "LINEAR", 0, 0)
  SetRotation("HOMEROS_01", 0, 62, 0, "LINEAR", 0, 0)
  SetPosition("YGGDRASILL_01", 8, 0, -9.9, "LINEAR", 0, 0)
  SetRotation("YGGDRASILL_01", 0, 0, 0, "LINEAR", 0, 0)
  SetPosition("TOUHOU_01", 8.8, 0, -8.892, "LINEAR", 0, 0)
  SetRotation("TOUHOU_01", 0, -66, 0, "LINEAR", 0, 0)
  SetPosition("HERO_01", 8.301, 0, -4.821, "LINEAR", 0, 0)
  SetRotation("HERO_01", 0, 180, 0, "LINEAR", 0, 0)
  SetPosition("AEGIOMON_01", 9.036, 0, -4.751, "LINEAR", 0, 0)
  SetRotation("AEGIOMON_01", 0, 180, 0, "LINEAR", 0, 0)
  SetPosition("HEROINE_01", 7.54, 0, -4.481, "LINEAR", 0, 0)
  SetRotation("HEROINE_01", 0, 180, 0, "LINEAR", 0, 0)
  SetPosition("MIREI_01", 8.083, -0, -4.135, "LINEAR", 0, 0)
  SetRotation("MIREI_01", 0, 180, 0, "LINEAR", 0, 0)
  PlayMotion("HOMEROS_01", "fs01_01", 0, true, 0)
  SetFace("HOMEROS_01", "F01", 2, 1, FACE_BLENDTIME, 0)
  PlayMotion("YGGDRASILL_01", "fs01_01", 0, true, 0)
  SetFace("YGGDRASILL_01", "F01", 0, 1, FACE_BLENDTIME, 0)
  PlayMotion("TOUHOU_01", "fs01_01", 0, true, 0)
  SetStartFrame("TOUHOU_01", "fs01_01", 0, 0)
  SetFace("TOUHOU_01", "F01", 0, 1, FACE_BLENDTIME, 0)
  PlayMotion("HERO_01", "fn01_01", 0, true, 0)
  SetFace("HERO_01", "F01", 0, 1, FACE_BLENDTIME, 0)
  PlayMotion("AEGIOMON_01", "fn01_01", 0, true, 0)
  SetFace("AEGIOMON_01", "F01", 0, 1, FACE_BLENDTIME, 0)
  PlayMotion("HEROINE_01", "fw01_01", 0, true, 0)
  PlayMotion("HEROINE_01", "fw01_01_end01", 10, false, 70)
  PlayMotion("HEROINE_01", "fn01_01", 0, true, 90)
  SetFace("HEROINE_01", "F01", 0, 1, FACE_BLENDTIME, 0)
  PlayMotion("MIREI_01", "e002", 0, true, 0)
  SetStartFrame("MIREI_01", "e002", 0, 0)
  SetFace("MIREI_01", "F01", 0, 1, FACE_BLENDTIME, 0)
  MovePosition("HERO_01", 8.301, 0, -6.361, true, 1.2, 0)
  MovePosition("AEGIOMON_01", 9.036, 0, -6.291, true, 1, 10)
  SetPosition("HEROINE_01", 7.54, 0, -6.401, "LINEAR", 60, 10)
  BlendEye("HOMEROS_01", 0, 0, "SCURVE", 0, 0)
  BlendFace("HOMEROS_01", 0, 8, -10, false, "SCURVE", 0, 0)
  BlendEye("YGGDRASILL_01", 0, 0, "SCURVE", 0, 0)
  BlendFace("YGGDRASILL_01", -50, 0, 0, false, "SCURVE", 0, 0)
  BlendEye("TOUHOU_01", 0, 0, "SCURVE", 0, 0)
  BlendFace("TOUHOU_01", 0, 0, 0, false, "SCURVE", 0, 0)
  BlendEye("HERO_01", 0, 0, "SCURVE", 0, 0)
  BlendFace("HERO_01", 0, 0, 0, false, "SCURVE", 0, 0)
  BlendEye("AEGIOMON_01", 0, 0, "SCURVE", 0, 0)
  BlendFace("AEGIOMON_01", 0, 15, 0, false, "SCURVE", 0, 0)
  BlendEye("HEROINE_01", 0, 0, "SCURVE", 0, 0)
  BlendFace("HEROINE_01", 0, 0, 0, false, "SCURVE", 0, 0)
  BlendEye("MIREI_01", 0, 0, "SCURVE", 0, 0)
  BlendFace("MIREI_01", 0, 0, 0, false, "SCURVE", 0, 0)
  SetCamera(10.447, 2.089, -3.878, 0, 33, "LINEAR", 0, false, 0)
  SetCameraTarget(7.667, 0.738, -8.274, "LINEAR", 0, false, 0)
  Event_PlayBGM(114, 0, 0)
  if Debug.IsEventView() then
  else
    local BGM, SE = Field.GetCurrentMapDefaultBGM()
    Sound.PlayBGM(BGM, 0)
  end
  FIELD_SET()
  EVENT_START()
  CUT("1.0")
  SetEnv_All("c1.0", 0)
  BlendFace("YGGDRASILL_01", -14, 14, 0, false, "SCURVE", 35, 60)
  BlendFace("TOUHOU_01", -68, 58, 0, false, "SCURVE", 40, 40)
  FadeInWithWait(0, 30)
  WaitFrame(80)
  CUT("2.0")
  SetEnv_All("c2.0", 0)
  SetPosition("HOMEROS_01", 7.247, 0, -8.894, "LINEAR", 0, 0)
  SetRotation("HOMEROS_01", 0, 62, 0, "LINEAR", 0, 0)
  PlayMotion("HOMEROS_01", "fs01_01", 0, true, 0)
  SetFace("HOMEROS_01", "F01", 2, 1, FACE_BLENDTIME, 0)
  SetCamera(8, 1.033, -8.43, 0, 20, "LINEAR", 0, false, 0)
  SetCameraTarget(7.021, 0.957, -9.046, "LINEAR", 0, false, 0)
  WaitFrame(10)
  MessageTalk("m270_020_010")
  MessageClose()
  WaitFrame(10)
  CUT("3.0")
  SetEnv_All("c3.0", 0)
  SetPosition("HOMEROS_01", 7.247, 0, -8.894, "LINEAR", 0, 0)
  SetRotation("HOMEROS_01", 0, 62, 0, "LINEAR", 0, 0)
  SetPosition("YGGDRASILL_01", 8, 0, -9.9, "LINEAR", 0, 0)
  SetRotation("YGGDRASILL_01", 0, 0, 0, "LINEAR", 0, 0)
  SetPosition("TOUHOU_01", 8.8, 0, -8.892, "LINEAR", 0, 0)
  SetRotation("TOUHOU_01", 0, -66, 0, "LINEAR", 0, 0)
  PlayMotion("HOMEROS_01", "fs01_01", 0, true, 0)
  SetFace("HOMEROS_01", "F01", 2, 1, FACE_BLENDTIME, 0)
  PlayMotion("YGGDRASILL_01", "fs01_01", 0, true, 0)
  SetFace("YGGDRASILL_01", "F04", 0, 1, FACE_BLENDTIME, 0)
  PlayMotion("TOUHOU_01", "fs01_01", 0, true, 0)
  SetStartFrame("TOUHOU_01", "fs01_01", 0, 0)
  SetFace("TOUHOU_01", "F04", 0, 1, FACE_BLENDTIME, 0)
  BlendEye("YGGDRASILL_01", 0, -45, "SCURVE", 0, 0)
  BlendFace("YGGDRASILL_01", -5, -30, 0, false, "SCURVE", 0, 0)
  BlendEye("TOUHOU_01", 0, 0, "SCURVE", 0, 0)
  BlendFace("TOUHOU_01", -22, -20, 24, false, "SCURVE", 0, 0)
  SetCamera(10.8, 1.061, -7.918, 0, 27, "LINEAR", 0, false, 0)
  SetCameraTarget(7.412, 0.607, -9.746, "LINEAR", 0, false, 0)
  WaitFrame(10)
  MessageTalk("m270_020_020")
  BlendEye("TOUHOU_01", -21, -36, "SCURVE", 10, 10)
  BlendFace("TOUHOU_01", -68, 79, -45, false, "SCURVE", 50, 0)
  MessageTalk("m270_020_030")
  MessageClose()
  WaitFrame(10)
  CUT("4.0")
  SetEnv_All("c4.0", 0)
  SetCamera(9.659, 0.958, -7.877, 0, 20, "LINEAR", 0, false, 0)
  SetCameraTarget(8.228, 0.818, -10.547, "LINEAR", 0, false, 0)
  BlendEye("TOUHOU_01", -56.72, 0, "SCURVE", 0, 0)
  BlendFace("TOUHOU_01", -56, 75.82, -18.58, false, "SCURVE", 0, 0)
  SetFace("YGGDRASILL_01", "F04", 2, 1, FACE_BLENDTIME, 10)
  BlendEye("YGGDRASILL_01", 0, 0, "SCURVE", 10, 10)
  BlendFace("YGGDRASILL_01", 46, 4, 0, false, "SCURVE", 30, 0)
  WaitFrame(20)
  MessageTalk("m270_020_040")
  SetFace("YGGDRASILL_01", "F06", 0, 1, FACE_BLENDTIME, 10)
  BlendEye("YGGDRASILL_01", 3, 0, "SCURVE", 10, 10)
  BlendFace("YGGDRASILL_01", -28, 8, 0, false, "SCURVE", 40, 0)
  MessageClose()
  WaitFrame(10)
  MessageTalk("m270_020_050")
  SetFace("TOUHOU_01", "F01", 0, 1, 6, 0)
  BlendEye("TOUHOU_01", -12, -16, "SCURVE", 10, 10)
  BlendFace("TOUHOU_01", -56, 75.82, -72.58, false, "SCURVE", 30, 0)
  MessageClose()
  WaitFrame(10)
  SetFace("YGGDRASILL_01", "E02_M01", 0, 1, FACE_BLENDTIME, 20)
  BlendEye("YGGDRASILL_01", 10, 39, "SCURVE", 10, 20)
  BlendFace("YGGDRASILL_01", 8, 24, -30, false, "SCURVE", 40, 10)
  MessageTalk("m270_020_060")
  BlendEye("YGGDRASILL_01", 39, 0, "SCURVE", 10, 15)
  BlendFace("YGGDRASILL_01", 1, 5, 22, false, "SCURVE", 40, 5)
  MessageClose()
  WaitFrame(40)
  CUT("5.0")
  SetEnv_All("c5.0", 0)
  SetCamera(8.064, 1.113, -9.604, 0, 30, "LINEAR", 0, false, 0, false)
  SetCameraTarget(8.019, 0.99, -10.041, "LINEAR", 0, false, 0, false)
  SetCamera(8.075, 1.142, -9.501, 0, 30, "LINEAR", 240, true, 0, false)
  SetCameraTarget(8.019, 0.99, -10.041, "LINEAR", 240, true, 0, false)
  PlayMotion("YGGDRASILL_01", "fs01_01", 0, true, 0)
  SetFace("YGGDRASILL_01", "E02_M01", 0, 1, FACE_BLENDTIME, 0)
  WaitFrame(10)
  MessageTalk("m270_020_070")
  BlendEye("YGGDRASILL_01", 0, 0, "SCURVE", 10, 10)
  BlendFace("YGGDRASILL_01", -32, 8, 0, false, "SCURVE", 40, 0)
  MessageClose()
  WaitFrame(20)
  BlendEye("YGGDRASILL_01", -19, 0, "SCURVE", 20, 60)
  BlendFace("YGGDRASILL_01", -4, 8, 0, false, "SCURVE", 20, 60)
  BlendEye("YGGDRASILL_01", 4, 0, "SCURVE", 30, 90)
  BlendFace("YGGDRASILL_01", -28, 8, 0, false, "SCURVE", 30, 90)
  MessageTalk("m270_020_080")
  MessageClose()
  WaitFrame(10)
  CUT("6.0")
  SetEnv_All("c6.0", 0)
  SetPosition("HERO_01", 8.301, 0, -6.361, "LINEAR", 0, 0)
  SetRotation("HERO_01", 0, 180, 0, "LINEAR", 0, 0)
  SetPosition("AEGIOMON_01", 9.036, 0, -6.291, "LINEAR", 0, 0)
  SetRotation("AEGIOMON_01", 0, 180, 0, "LINEAR", 0, 0)
  SetPosition("HEROINE_01", 7.54, 0, -6.401, "LINEAR", 0, 0)
  SetRotation("HEROINE_01", 0, 180, 0, "LINEAR", 0, 0)
  SetPosition("MIREI_01", 8.083, -0, -2.195, "LINEAR", 0, 0)
  SetRotation("MIREI_01", 0, 180, 0, "LINEAR", 0, 0)
  PlayMotion("HERO_01", "fn01_01", 0, false, 0)
  SetFace("HERO_01", "F11", 0, 1, 0, 0)
  PlayMotion("AEGIOMON_01", "fn01_01", 0, false, 0)
  SetFace("AEGIOMON_01", "F11", 0, 1, 0, 0)
  PlayMotion("HEROINE_01", "fn01_01", 0, false, 0)
  SetFace("HEROINE_01", "F11", 0, 1, 0, 0)
  PlayMotion("MIREI_01", "fn01_01", 0, true, 0)
  SetFace("MIREI_01", "F01", 0, 1, 0, 0)
  MovePosition("MIREI_01", 8.083, -0, -4.134, true, 1, 0)
  MoveRotation("MIREI_01", 0, 180, 0, "LINEAR", 1, true, 0)
  BlendEye("HERO_01", 15, 0, "SCURVE", 0, 0)
  BlendFace("HERO_01", -8, -12, 0, false, "SCURVE", 0, 0)
  BlendFace("HERO_01", -8, -12, -35, false, "SCURVE", 30, 10)
  BlendEye("AEGIOMON_01", 0, 0, "SCURVE", 0, 0)
  BlendFace("AEGIOMON_01", 0, 17, 0, false, "SCURVE", 0, 0)
  BlendEye("HEROINE_01", -8, 0, "SCURVE", 0, 0)
  BlendFace("HEROINE_01", 0, -15, 0, false, "SCURVE", 0, 0)
  BlendEye("MIREI_01", 0, 0, "SCURVE", 0, 0)
  BlendFace("MIREI_01", -23, -7, 0, false, "SCURVE", 0, 0)
  SetCamera(8.868, 1.667, -7.4, 0, 27, "LINEAR", 0, false, 0)
  SetCameraTarget(8.418, 1.483, -6.373, "LINEAR", 0, false, 0)
  WaitFrame(60)
  SetRotation("HERO_01", 0, 11.5, 0, "LINEAR", 60, 10)
  SetRotation("AEGIOMON_01", 0, 322, 0, "LINEAR", 60, 0)
  SetRotation("HEROINE_01", 0, 19.5, 0, "LINEAR", 60, 5)
  PlayMotion("HERO_01", "ft02_01", 3, false, 10)
  PlayMotion("HERO_01", "fn01_01", 3, true, 70)
  SetFace("HERO_01", "F15", 0, 1, FACE_BLENDTIME, 10)
  PlayMotion("AEGIOMON_01", "ft02_02", 0, false, 0)
  PlayMotion("AEGIOMON_01", "fn01_01", 0, true, 60)
  SetFace("AEGIOMON_01", "F01", 0, 1, FACE_BLENDTIME, 0)
  PlayMotion("HEROINE_01", "ft02_01", 3, false, 5)
  PlayMotion("HEROINE_01", "fn01_01", 3, true, 65)
  SetFace("HEROINE_01", "F16", 0, 1, FACE_BLENDTIME, 5)
  PlayMotion("MIREI_01", "e002", 10, false, 40)
  PlayMotion("MIREI_01", "fn01_01", 0, true, 230)
  BlendEye("HERO_01", 10, -20, "SCURVE", 10, 0)
  BlendFace("HERO_01", 0, 10, 0, false, "SCURVE", 30, 10)
  BlendEye("AEGIOMON_01", 0, 0, "SCURVE", 10, 0)
  BlendFace("AEGIOMON_01", -15, 10, 0, false, "SCURVE", 30, 0)
  BlendEye("HEROINE_01", 10, -20, "SCURVE", 10, 5)
  BlendFace("HEROINE_01", 22, 0, 0, false, "SCURVE", 30, 5)
  WaitFrame(60)
  Fade_OutNoLoadingWithWait(0, 30)
  EVENT_END()
end

function CUT(cut_no)
  CUT_START(cut_no)
end

function main()
  m270_020()
end
