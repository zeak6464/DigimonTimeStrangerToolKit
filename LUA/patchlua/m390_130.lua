require("include")

function m390_130()
  Fade_Out(1, 0)
  EVENT_BEGIN()
  Talk.Load("m390")
  SetEventCutNo(6)
  if Debug.IsEventView() then
    SetTimeZone("Night")
    SetTimeAxis("P2028_daft_390")
    LoadMap("t3001")
  end
  LoadModel("HERO_01", "Player")
  LoadModel("MIREI_01", "char_MIREI_CHILD")
  Load_Relief()
  LoadEffectScript("eff_01", "ef_e_com_270")
  LoadSceneViewerResource("c1.0", "t3001f_pn")
  LoadSceneViewerResource("c1.5", "t3001f_pn")
  LoadSceneViewerResource("c2.0", "t3001f_pn")
  LoadSceneViewerResource("c3.0", "t3001f_pn")
  LoadSceneViewerResource("c4.0", "t3001f_pn")
  LoadSceneViewerResource("c5.0", "t3001f_pn")
  LoadSceneViewerResource("c6.0", "t3001f_pn")
  LoadEnvironmentFile("c1.0", "es_m390_130_c1.0")
  LoadEnvironmentFile("c1.5", "es_m390_130_c1.5")
  LoadEnvironmentFile("c2.0", "es_m390_130_c2.0")
  LoadEnvironmentFile("c3.0", "es_m390_130_c3.0")
  LoadEnvironmentFile("c4.0", "es_m390_130_c4.0")
  LoadEnvironmentFile("c5.0", "es_m390_130_c5.0")
  LoadEnvironmentFile("c6.0", "es_m390_130_c6.0")
  WaitVistaLoad()
  SetPosition("HERO_01", -0.008, 0, -9.809, "LINEAR", 0, 0)
  SetRotation("HERO_01", 0, 180, 0, "LINEAR", 0, 0)
  SetPosition("MIREI_01", -0.732, 0, -7.285, "LINEAR", 0, 0)
  SetRotation("MIREI_01", 0, 158.5, 0, "LINEAR", 0, 0)
  SetPosition("eff_01", 0, 12.57, -24.85, "LINEAR", 0, 0)
  SetRotation("eff_01", 0, 0, 32.74, "LINEAR", 0, 0)
  PlayMotion("HERO_01", "fn01_01", 0, false, 0)
  SetFace("HERO_01", "F15", 0, 1, FACE_BLENDTIME, 0)
  PlayMotion("MIREI_01", "fn01_01", 0, true, 0)
  SetFace("MIREI_01", "F01", 0, 1, FACE_BLENDTIME, 0)
  BlendEye("HERO_01", 0, 0, "SCURVE", 0, 0)
  BlendFace("HERO_01", -41, 0, 0, false, "SCURVE", 0, 0)
  BlendEye("MIREI_01", 0, 0, "SCURVE", 0, 0)
  BlendFace("MIREI_01", 0, 0, 0, false, "SCURVE", 0, 0)
  SetPosition_Relief()
  PlayMotion_Relief()
  ModelVisible("t3001jewel06_01", false, 0, 0)
  ModelVisible("t3001reliefparts06_01", false, 0, 0)
  ModelVisible("t3001digi06_01", false, 0, 0)
  ModelVisible("t3001jewel07_01", false, 0, 0)
  ModelVisible("t3001reliefparts07_01", false, 0, 0)
  ModelVisible("t3001digi07_01", false, 0, 0)
  ModelVisible("t3001jewel08_01", false, 0, 0)
  ModelVisible("t3001reliefparts08_01", false, 0, 0)
  ModelVisible("t3001digi08_01", false, 0, 0)
  ModelVisible("t3001jewel09_01", false, 0, 0)
  ModelVisible("t3001reliefparts09_01", false, 0, 0)
  ModelVisible("t3001digi09_01", false, 0, 0)
  ModelVisible("t3001jewel10_01", false, 0, 0)
  ModelVisible("t3001reliefparts10_01", false, 0, 0)
  ModelVisible("t3001digi10_01", false, 0, 0)
  ModelVisible("t3001jewel11_01", false, 0, 0)
  ModelVisible("t3001digi11_01", false, 0, 0)
  ModelVisible("t3001jewel12_01", false, 0, 0)
  ModelVisible("t3001digi12_01", false, 0, 0)
  SetCamera(0, 11.183, -19.067, 0, 30, "LINEAR", 0, false, 0, false)
  SetCameraTarget(0, 11.637, -25.597, "LINEAR", 0, false, 0, false)
  SetCamera(0, 11.194, -18.47, 0, 30, "SCURVE", 70, true, 0, false)
  SetCameraTarget(0, 11.667, -25.597, "SCURVE", 70, true, 0, false)
  ModelVisible("MIREI_01", false, 0, 0)
  Event_PlayBGM(114, 0, 0)
  if Debug.IsEventView() then
  else
    local BGM, SE = Field.GetCurrentMapDefaultBGM()
    Sound.PlayBGM(BGM, 0)
  end
  FIELD_SET()
  EVENT_START()
  CUT("1.0")
  SetEnv_All("c1.0", 0)
  Fade_In(1, 60)
  WaitFrame(50)
  Event_PlaySE(401045, 100, false, 0, 0)
  Event_PlaySE(401046, 100, false, 0, 1.6)
  ModelVisible("t3001jewel06_01", true, 0, 0)
  PlayMotion("t3001jewel06_01", "e001", 0, false, 0)
  PlayEffect("eff_01", false, 0)
  CtrVibration(1, 0, 3, 48)
  CtrVibration(0, 0, 0, 51)
  WaitFrame(48)
  SetCamera(0, 11.183, -19.067, 0, 30, "LINEAR", 0, false, 0, false)
  SetCameraTarget(0, 11.637, -25.597, "LINEAR", 0, false, 0, false)
  SetCamera(0, 11.194, -18.47, 0, 30, "DECEL", 3, true, 0, false)
  SetCameraTarget(0, 11.667, -25.597, "DECEL", 3, true, 0, false)
  WaitFrame(30)
  CUT("1.5")
  SetEnv_All("c1.5", 0)
  SetCamera(-1.761, 8.978, -20.317, 0, 30, "LINEAR", 0, false, 0)
  SetCameraTarget(0.923, 10.761, -24.8, "LINEAR", 0, false, 0)
  SetCamera(-1.997, 8.821, -19.921, 0, 30, "SCURVE", 80, true, 0)
  SetCameraTarget(0.923, 10.761, -24.8, "SCURVE", 80, true, 0)
  local slot_01 = Event_PlaySE(200018, 100, false, 0, 0)
  ModelVisible("t3001reliefparts06_01", true, 0, 0)
  PlayMotion("t3001reliefparts06_01", "e001", 0, false, 0)
  PlayMotion("t3001reliefparts06_01", "e002", 0, true, 24)
  WaitFrame(30)
  Event_PlaySE(401047, 100, false, 0, 0)
  ModelVisible("t3001digi06_01", true, 0, 0)
  PlayMotion("t3001digi06_01", "e001", 0, false, 0)
  Event_Quake_Start(3, 3, 10, 25)
  WaitFrame(90)
  CUT("2.0")
  SetEnv_All("c2.0", 0)
  SetCamera(0.415, 9.033, -13.621, 0, 35, "LINEAR", 0, false, 0, false)
  SetCameraTarget(0.059, 10.383, -25.24, "LINEAR", 0, false, 0, false)
  SetCamera(0.49, 8.834, -11.19, 0, 35, "SCURVE", 100, true, 0, false)
  SetCameraTarget(0.059, 10.383, -25.24, "SCURVE", 100, true, 0, false)
  WaitFrame(160)
  CUT("3.0")
  SetEnv_All("c3.0", 0)
  SetCamera(1.736, 1.184, -5.499, 0, 30, "LINEAR", 0, false, 0)
  SetCameraTarget(1.177, 2.958, -9.625, "LINEAR", 0, false, 0)
  SetCamera(1.736, -0.196, -5.499, 0, 30, "SCURVE", 100, true, 0)
  SetCameraTarget(1.177, 1.578, -9.625, "SCURVE", 100, true, 0)
  WaitFrame(150)
  CUT("4.0")
  SetEnv_All("c4.0", 0)
  ModelVisible("MIREI_01", true, 0, 0)
  BlendEye("MIREI_01", 0, 0, "SCURVE", 0, 0)
  BlendFace("MIREI_01", -39, 0, 0, false, "SCURVE", 0, 0)
  SetCamera(0.743, 1.744, -9.018, 0, 30, "LINEAR", 0, false, 0)
  SetCameraTarget(-0.593, 1.234, -7.874, "LINEAR", 0, false, 0)
  SetPosition("HERO_01", -0.008, 0, -8.56, "LINEAR", 0, 0)
  SetRotation("HERO_01", 0, 340, 0, "LINEAR", ROTATION180, 10)
  BlendEye("HERO_01", 12, 0, "SCURVE", 0, 0)
  BlendFace("HERO_01", 28, 0, 0, false, "SCURVE", 30, 10)
  PlayMotion("HERO_01", "ft02_02", 5, false, 10)
  PlayMotion("HERO_01", "fn01_01", 3, true, 70)
  MessageTalk("m390_130_010")
  MessageClose()
  WaitFrame(10)
  CUT("5.0")
  SetEnv_All("c5.0", 0)
  SetCamera(-0.145, 1.378, -8.049, 0, 30, "LINEAR", 0, false, 0)
  SetCameraTarget(-0.718, 1.143, -7.294, "LINEAR", 0, false, 0)
  PlayMotion("MIREI_01", "e002", 0, true, 0)
  SetFace("MIREI_01", "F01", 0, 1, FACE_BLENDTIME, 0)
  MessageTalk("m390_130_020")
  PlayMotionBlend("MIREI_01", "blend02", 0, false, 60)
  MessageTalk("m390_130_030")
  MessageTalk("m390_130_040")
  MessageClose()
  WaitFrame(10)
  CUT("6.0")
  SetEnv_All("c6.0", 0)
  SetCamera(-0.477, 0.301, -5.479, 0, 30, "LINEAR", 0, false, 0)
  SetCameraTarget(-0.37, 4.417, -14.691, "LINEAR", 0, false, 0)
  SetCamera(-0.47, 0.577, -6.098, 0, 30, "LINEAR", 180, true, 0)
  SetCameraTarget(-0.37, 4.417, -14.691, "LINEAR", 180, true, 0)
  SetFace("HERO_01", "E03_M15", 0, 1, FACE_BLENDTIME, 0)
  PlayMotion("MIREI_01", "fn01_01", 0, true, 0)
  PlayMotionBlend("MIREI_01", "blend01", 3, false, 0)
  SetFace("MIREI_01", "F01", 0, 1, FACE_BLENDTIME, 0)
  MessageTalk("m390_130_050")
  MessageClose()
  WaitFrame(10)
  Fade_OutNoLoadingWithWait(FADE_BLACK, 30)
  EVENT_END()
end

function CUT(cut_no)
  CUT_START(cut_no)
end

function main()
  m390_130()
end
