require("include")

function arena_f001_20()
  Fade_Out(0, 0)
  EVENT_BEGIN()
  Talk.Load("arena01")
  SetEventCutNo(5)
  if Debug.IsEventView() then
    SetTimeZone("Noon")
    SetTimeAxis("P2028_daft_320")
    SetMapStatus("Enable")
    LoadMap("d0513")
  end
  LoadModel("AEGIOMON_01", "char_AEGIOMON")
  LoadModel("HERO_01", "Player")
  LoadModel("HEROINE_01", "char_HEROINE")
  LoadModel("enemy_02", "char_SUSANOOMON")
  LoadModel("referee_01", "char_ETEMON")
  LoadSceneViewerResource("c1.0", "d0513f_sa")
  LoadSceneViewerResource("c2.0", "d0513f_sa")
  LoadSceneViewerResource("c3.0", "d0513f_sa")
  LoadSceneViewerResource("c4.0", "d0513f_sa")
  LoadEnvironmentFile("c1.0", "es_m320_020_c1.0")
  LoadEnvironmentFile("c2.0", "es_m320_020_c2.0")
  LoadEnvironmentFile("c3.0", "es_m320_020_c3.0")
  LoadEnvironmentFile("c4.0", "es_m320_020_c4.0")
  WaitVistaLoad()
  Event_PlayBGM(313, 0, 0)
  local slot_id = Event_PlaySE(405004, 100, true, 0, 0)
  ModelVisible("HERO_01", false, 0, 0)
  ModelVisible("AEGIOMON_01", false, 0, 0)
  ModelVisible("HEROINE_01", false, 0, 0)
  ModelVisible("enemy_01", false, 0, 0)
  ModelVisible("enemy_02", false, 0, 0)
  ModelVisible("enemy_03", false, 0, 0)
  SetPosition("AEGIOMON_01", 6, 0, -0.494, "LINEAR", 0, 0)
  SetRotation("AEGIOMON_01", 0, -90, 0, "LINEAR", 0, 0)
  SetPosition("HERO_01", 6, 0, 0.833, "LINEAR", 0, 0)
  SetRotation("HERO_01", 0, -90, 0, "LINEAR", 0, 0)
  SetPosition("HEROINE_01", 6.978, 0, 0.19, "LINEAR", 0, 0)
  SetRotation("HEROINE_01", 0, -90, 0, "LINEAR", 0, 0)
  SetPosition("enemy_02", -6.785, 0, 0.529, "LINEAR", 0, 0)
  SetRotation("enemy_02", 0, 90, 0, "LINEAR", 0, 0)
  PlayMotion("AEGIOMON_01", "bn01", 0, true, 0)
  SetFace("AEGIOMON_01", "E03_M14", 0, 1, FACE_BLENDTIME, 0)
  PlayMotion("HERO_01", "bn01", 0, true, 0)
  SetFace("HERO_01", "E03_M15", 0, 1, FACE_BLENDTIME, 0)
  PlayMotion("HEROINE_01", "e005_01", 0, true, 0)
  SetFace("HEROINE_01", "F04", 0, 1, FACE_BLENDTIME, 0)
  PlayMotion("enemy_02", "bn01", 0, true, 0)
  SetFace("enemy_02", "F03", 0, 1, FACE_BLENDTIME, 0)
  SetPosition("referee_01", 0.443, 0, 3.568, "LINEAR", 0, 0)
  SetRotation("referee_01", 0, 180, 0, "LINEAR", 0, 0)
  PlayMotion("referee_01", "f000", 0, true, 0)
  SetFace("referee_01", "F01", 0, 1, FACE_BLENDTIME, 0)
  BlendEye("AEGIOMON_01", 0, 0, "SCURVE", 0, 0)
  BlendFace("AEGIOMON_01", 0, 0, 0, false, "SCURVE", 0, 0)
  BlendEye("HERO_01", 0, 0, "SCURVE", 0, 0)
  BlendFace("HERO_01", 0, 0, 0, false, "SCURVE", 0, 0)
  BlendEye("HEROINE_01", 0, 0, "SCURVE", 0, 0)
  BlendFace("HEROINE_01", 0, 0, 0, false, "SCURVE", 0, 0)
  BlendFaceDigi("enemy_02", 0, 0, 0, "SCURVE", 0, 0)
  SetCamera(84.124, 6.276, 16.326, -10, 40, "LINEAR", 0, false, 0)
  SetCameraTarget(1.489, 48.364, -1.034, "LINEAR", 0, false, 0)
  SetCamera(-8.754, 8.881, 49.323, -10, 40, "SCURVE", 165, false, 0)
  SetCameraTarget(0.944, 39.278, 2.236, "SCURVE", 165, false, 0)
  SetCamera(-28.901, 10.284, 41.053, -10, 40, "DECEL", 180, false, 160)
  SetCameraTarget(-0.892, 38.724, 0.075, "DECEL", 180, false, 160)
  FIELD_SET()
  EVENT_START()
  CUT("1.0")
  SetEnv_All("c1.0", 0)
  Fade_In(FADE_BLACK, FADE_TIME)
  WaitFrame(30)
  Vista.ApplyVoiceSnapshot(SOUND_SNAPSHOT_MIC)
  MessageTalk("arena01_f001_020_010")
  MessageClose()
  WaitFrame(10)
  CUT("2.0")
  SetEnv_All("c3.0", 0)
  ModelVisible("HERO_01", true, 0, 0)
  if Debug.IsEventView() then
    ModelVisible("AEGIOMON_01", true, 0, 0)
  else
    local aegio = Field.GetFollowerIndexForAegiomon()
    if aegio ~= nil then
      ModelVisible("AEGIOMON_01", true, 0, 0)
    end
    Field_CancelInvisibleFollowerAllPartyMember(INVISIBLE_KEY_EVENT, 0, false, true)
    WaitFrame(1)
    Field.FollowerWarp()
    WaitFrame(1)
    local index = Digimon.GetUniqueIDInPartyMember(1)
    if index ~= nil then
      local party = Field.GetFollowerIndexByPartyUniqueID(index)
      Field.ObjectSetRotationY(FLD_OBJ_FOLLOWER, party, -90, 0)
      Field.ObjectSetPos(FLD_OBJ_FOLLOWER, party, 8.99, 0.01, 1.14, false)
    end
    local index = Digimon.GetUniqueIDInPartyMember(2)
    if index ~= nil then
      local party = Field.GetFollowerIndexByPartyUniqueID(index)
      Field.ObjectSetRotationY(FLD_OBJ_FOLLOWER, party, -90, 0)
      Field.ObjectSetPos(FLD_OBJ_FOLLOWER, party, 7.81, 0.01, 3.62, false)
    end
    local index = Digimon.GetUniqueIDInPartyMember(3)
    if index ~= nil then
      local party = Field.GetFollowerIndexByPartyUniqueID(index)
      Field.ObjectSetRotationY(FLD_OBJ_FOLLOWER, party, -90, 0)
      Field.ObjectSetPos(FLD_OBJ_FOLLOWER, party, 5.6, 0.01, 3.91, false)
    end
  end
  SetPosition("AEGIOMON_01", 5.564, -0.118, -0.526, "LINEAR", 0, 0)
  SetRotation("AEGIOMON_01", 0, -90, 0, "LINEAR", 0, 0)
  SetPosition("HERO_01", 6.965, 0, 0.206, "LINEAR", 0, 0)
  SetRotation("HERO_01", 0, -90, 0, "LINEAR", 0, 0)
  SetPosition("HEROINE_01", 12.627, 0, 0.19, "LINEAR", 0, 0)
  SetRotation("HEROINE_01", 0, -90, 0, "LINEAR", 0, 0)
  PlayMotion("AEGIOMON_01", "bn01", 0, true, 0)
  SetFace("AEGIOMON_01", "E03_M14", 0, 1, 0, 0)
  PlayMotion("HERO_01", "bn01", 0, true, 0)
  SetFace("HERO_01", "E03_M15", 0, 1, 0, 0)
  SetFace("HEROINE_01", "E03_M15", 0, 1, 0, 0)
  PlayMotion("chr403_01", "bn01", 0, true, 0)
  SetFace("chr403_01", "F01", 0, 1, 0, 0)
  SetCamera(9.323, 0.112, -5.047, 0, 18, "LINEAR", 0, false, 0, false)
  SetCameraTarget(5.876, 1.444, 0.654, "LINEAR", 0, false, 0, false)
  SetCamera(1.837, 0, -5.982, 0, 18, "SCURVE", 60, false, 0, false)
  SetCameraTarget(5.702, 1.498, 0.6, "SCURVE", 60, false, 0, false)
  SetCamera(-0.456, 0, -5.6, 0, 18, "LINEAR", 150, true, 60, false)
  SetCameraTarget(5.503, 1.466, 0.57, "LINEAR", 150, true, 60, false)
  WaitFrame(10)
  MessageTalk("arena01_f001_020_020")
  MessageClose()
  WaitFrame(10)
  CUT("3.0")
  SetEnv_All("c2.0", 0)
  ModelVisible("enemy_02", true, 0, 0)
  SetPosition("enemy_02", -7.295, 0, 0.529, "LINEAR", 0, 0)
  SetRotation("enemy_02", 0, 101.5, 0, "LINEAR", 0, 0)
  SetCamera(-19.499, 3.421, -13.134, 0, 20, "LINEAR", 0, false, 0, false)
  SetCameraTarget(-5.398, 5.644, 0.507, "LINEAR", 0, false, 0, false)
  SetCamera(-1.075, 3.128, -17.804, 0, 20, "SCURVE", 60, false, 0, false)
  SetCameraTarget(-6.474, 5.644, 0.507, "SCURVE", 60, false, 0, false)
  SetCamera(2.978, 3.435, -16.001, 0, 20, "LINEAR", 150, true, 60, false)
  SetCameraTarget(-6.518, 5.644, 0.507, "LINEAR", 150, true, 60, false)
  WaitFrame(10)
  MessageTalk("arena01_f001_020_030")
  MessageClose()
  WaitFrame(10)
  CUT("4.0")
  SetEnv_All("c2.0", 0)
  ModelVisible("enemy_02", true, 0, 0)
  SetPosition("enemy_02", -6.785, -1.639, 0.529, "LINEAR", 0, 0)
  SetRotation("enemy_02", 0, 90, 0, "LINEAR", 0, 0)
  SetCamera(-0.268, 4.092, 0.573, 0, 45, "LINEAR", 0, false, 0)
  SetCameraTarget(-7.064, 4.949, 0.504, "LINEAR", 0, false, 0)
  WaitFrame(10)
  PlayMotion("enemy_02", "fe02", 10, false, 0)
  PlayMotion("enemy_02", "bn01", 10, true, 57)
  WaitFrame(10)
  SetFace("enemy_02", "F03", 0, 1, FACE_BLENDTIME, 0)
  MessageTalk("arena01_f001_020_040")
  MessageClose()
  WaitFrame(10)
  PlayMotion("enemy_02", "fq01", 10, false, 0)
  PlayMotion("enemy_02", "bn01", 10, true, 55)
  WaitFrame(10)
  MessageTalk("arena01_f001_020_041")
  MessageClose()
  WaitFrame(10)
  PlayMotion("enemy_02", "fe04", 10, false, 0)
  PlayMotion("enemy_02", "bn01", 10, true, 40)
  WaitFrame(10)
  MessageTalk("arena01_f001_020_042")
  SetFace("enemy_02", "F03", 0, 1, FACE_BLENDTIME, 0)
  MessageClose()
  WaitFrame(20)
  CUT("5.0")
  SetEnv_All("c4.0", 0)
  if Debug.IsEventView() then
    ModelVisible("HEROINE_01", true, 0, 0)
  else
    local heroine = Field.GetFollowerIndexByGuestID(GST_HEROINE)
    if heroine ~= nil then
      ModelVisible("HEROINE_01", true, 0, 0)
    end
    Field_CancelInvisibleFollowerAllPartyMember(INVISIBLE_KEY_EVENT, 0, false, true)
    local index = Digimon.GetUniqueIDInPartyMember(1)
    if index ~= nil then
      local party = Field.GetFollowerIndexByPartyUniqueID(index)
      Field.ObjectSetRotationY(FLD_OBJ_FOLLOWER, party, -90, 0)
      Field.ObjectSetPos(FLD_OBJ_FOLLOWER, party, 8.99, 0, 2.14, false)
    end
    local index = Digimon.GetUniqueIDInPartyMember(2)
    if index ~= nil then
      local party = Field.GetFollowerIndexByPartyUniqueID(index)
      Field.ObjectSetRotationY(FLD_OBJ_FOLLOWER, party, -90, 0)
      Field.ObjectSetPos(FLD_OBJ_FOLLOWER, party, 9.95, 0, 0.08, false)
    end
    local index = Digimon.GetUniqueIDInPartyMember(3)
    if index ~= nil then
      local party = Field.GetFollowerIndexByPartyUniqueID(index)
      Field.ObjectSetRotationY(FLD_OBJ_FOLLOWER, party, -90, 0)
      Field.ObjectSetPos(FLD_OBJ_FOLLOWER, party, 9.29, 0, -2, false)
    end
  end
  SetPosition("AEGIOMON_01", 5.893, 0, -1.83, "LINEAR", 0, 0)
  SetRotation("AEGIOMON_01", 0, -90, 0, "LINEAR", 0, 0)
  SetPosition("HERO_01", 7.266, 0, -0.057, "LINEAR", 0, 0)
  SetRotation("HERO_01", 0, -118.5, 0, "LINEAR", 0, 0)
  SetPosition("HEROINE_01", 11.343, 0, 0, "LINEAR", 0, 0)
  SetRotation("HEROINE_01", 0, -109, 0, "LINEAR", 0, 0)
  SetPosition("enemy_02", -4.685, 0, 0, "LINEAR", 0, 0)
  SetRotation("enemy_02", 0, 92.5, 0, "LINEAR", 0, 0)
  BlendEye("HEROINE_01", 0, 0, "SCURVE", 0, 0)
  BlendFace("HEROINE_01", -38, 0, 0, false, "SCURVE", 0, 0)
  SetCamera(-0, 5.247, 6.565, 0, 20, "LINEAR", 0, false, 0, false)
  SetCameraTarget(0, 6.752, 37.683, "LINEAR", 0, false, 0, false)
  SetCamera(-0, 0.747, -22.412, 0, 33, "DECEL", 10, false, 0, false)
  SetCameraTarget(0, 3, 0, "DECEL", 10, false, 0, false)
  SetCamera(-0, 0.45, -24.91, 0, 33, "LINEAR", 150, true, 10, false)
  SetCameraTarget(0, 3, 0, "LINEAR", 150, true, 10, false)
  Vista.ApplyVoiceSnapshot(SOUND_SNAPSHOT_MIC)
  MessageTalk("arena01_f001_020_050")
  MessageClose()
  WaitFrame(15)
  Sound.PlaySE(300018, 100)
  StartEncountEffectNormal()
  WaitFrame(5)
  if Debug.IsEventView() then
  end
  EVENT_END()
end

function CUT(cut_no)
  CUT_START(cut_no)
end

function main()
  arena_f001_20()
end
