S010_003 = {
  ID = 3,
  STEP_001 = 1,
  STEP_005 = 5,
  STEP_010 = 10,
  STEP_015 = 15,
  STEP_020 = 20,
  STEP_025 = 25,
  STEP_030 = 30,
  STEP_035 = 35,
  STEP_040 = 40,
  STEP_255 = 255
}
local fldtxt = "s010_003_010"
local base = "s010_003_"
local text_file = "s010_003"
local tlk = Tlk:new(text_file, 1, true)

function S010_003:Event_010()
  local hiroko_index = GetIndex(NPC, "npc_0500")
  Field.ObjectLoadMotion(NPC, hiroko_index, "fn01_01")
  Field.ObjectLoadMotion(NPC, hiroko_index, "e002")
  Field.ObjectLoadMotion(NPC, hiroko_index, "e004")
  Field.ObjectLoadMotion(NPC, hiroko_index, "e006")
  Field.ObjectLoadMotion(NPC, hiroko_index, "e008")
  Field.ObjectLoadMotion(NPC, hiroko_index, "e010")
  Field.ObjectLoadMotion(NPC, hiroko_index, "e012")
  if Qst.Sub:Check(self.ID, self.STEP_001, self.STEP_005) then
    local fn01_01 = Motion.Object:new(NPC, "npc_0500", "fn01_01")
    HideMinimap(true)
    HideGuide(true)
    Fade_OutNoLoadingWithWait(FADE_BLACK, FADE_TIME)
    Obj:new(OGIM, "fa_sub201_t0302"):Invisible()
    Cam.Inst:Set(17.9576, -0.056, 19.52, 15.91, 1.543, 29.178, default, 0)
    Obj:new(PLAYER, ""):SetPos(15.82, 0, 27.92, true)
    Obj:new(PLAYER, ""):SetRotationY(30, 0)
    tlk:StartTalkAndCancelDigimonRide()
    WaitFrame(15)
    FadeInWithWaitNotFlgCheck(FADE_BLACK, FADE_TIME)
    Field.ObjectChangeExpression(NPC, hiroko_index, "F01", EYES_BLINK_TYPE_BLINK, true, 30, AUTO_CANCEL_NONE, 15)
    Field.ObjectPlayMotionWithStartMoveMotion(NPC, hiroko_index, "e002", 10, 10)
    tlk:Message("s010_003_010")
    Field.ObjectPlayMotionWithStartMoveMotion(NPC, hiroko_index, "e008", 10, 10)
    tlk:Message("s010_003_020")
    Field.ObjectPlayMotionWithStartMoveMotion(NPC, hiroko_index, "e002", 10, 10)
    tlk:Message("s010_003_030")
    Flg.Set("FLAG_S003_001")
    Field.ObjectChangeExpression(NPC, hiroko_index, "F01", EYES_BLINK_TYPE_BLINK, false, 30, AUTO_CANCEL_NONE, 15)
    local result = tlk:Select(3, "s010_003_040")
    WaitFrame(15)
    Field.ObjectChangeExpression(NPC, hiroko_index, "F01", EYES_BLINK_TYPE_BLINK, true, 30, AUTO_CANCEL_NONE, 15)
    if result == RESULT_TALK00 then
      Field.ObjectPlayMotionWithStartMoveMotion(NPC, hiroko_index, "e012", 10, 10)
      tlk:Message("s010_003_050")
      tlk:Message("s010_003_120")
      Field.ObjectChangeExpression(NPC, hiroko_index, "F01", EYES_BLINK_TYPE_BLINK, false, 30, AUTO_CANCEL_NONE, 15)
      Talk.CloseLetterBox()
      Qst.Sub:Start(self.ID, 1, false)
      Flg.Set("FLAG_S003_008")
      Fade_OutNoLoadingWithWait(FADE_BLACK, FADE_TIME)
      Talk.OpenLetterBox()
      tlk:EndTalk()
      Obj:new(OGIM, "fa_sub201_t0302"):CancelInvisible()
      Cam.Inst:Clear(0)
      Field.ObjectCheckSync(FOR_ALL, false)
      SetEnableGimmickCheck("map_0001", false)
      SetEnableGimmickCheck("map_0002", false)
      SetEnableGimmickCheck("map_0003", false)
      Common.ProhibitSave()
      FadeInWithWaitNotFlgCheck(FADE_BLACK, FADE_TIME)
      HideMinimap(false)
      HideGuide(false)
      Qst.Sub:Set(self.ID, self.STEP_005)
      Qst.Sub:Set(self.ID, self.STEP_010)
    elseif result == RESULT_TALK01 then
      Field.ObjectPlayMotionWithStartMoveMotion(NPC, hiroko_index, "e010", 10, 10)
      tlk:Message("s010_003_060")
      tlk:Message("s010_003_120")
      Field.ObjectChangeExpression(NPC, hiroko_index, "F01", EYES_BLINK_TYPE_BLINK, false, 30, AUTO_CANCEL_NONE, MOUTH_BLENDTIME)
      Talk.CloseLetterBox()
      Qst.Sub:Start(self.ID, 1, false)
      Flg.Set("FLAG_S003_008")
      Fade_OutNoLoadingWithWait(FADE_BLACK, FADE_TIME)
      Talk.OpenLetterBox()
      tlk:EndTalk()
      Obj:new(OGIM, "fa_sub201_t0302"):CancelInvisible()
      Cam.Inst:Clear(0)
      Field.ObjectCheckSync(FOR_ALL, false)
      SetEnableGimmickCheck("map_0001", false)
      SetEnableGimmickCheck("map_0002", false)
      SetEnableGimmickCheck("map_0003", false)
      Common.ProhibitSave()
      FadeInWithWaitNotFlgCheck(FADE_BLACK, FADE_TIME)
      HideMinimap(false)
      HideGuide(false)
      Qst.Sub:Set(self.ID, self.STEP_005)
      Qst.Sub:Set(self.ID, self.STEP_010)
    else
      if result == RESULT_TALK02 then
        Field.ObjectPlayMotionWithStartMoveMotion(NPC, hiroko_index, "e002", 10, 10)
        tlk:Message("s010_003_070")
        tlk:EndTalk()
        Field.ObjectChangeExpression(NPC, hiroko_index, "F01", EYES_BLINK_TYPE_BLINK, false, 30, AUTO_CANCEL_NONE, 15)
        HideMinimap(false)
        HideGuide(false)
        Qst.Sub:Set(self.ID, self.STEP_005)
        Fade_OutNoLoadingWithWait(FADE_BLACK, FADE_TIME)
        Cam.Inst:Clear(0)
        Obj:new(OGIM, "fa_sub201_t0302"):CancelInvisible()
        FadeInWithWaitNotFlgCheck(FADE_BLACK, FADE_TIME)
      else
      end
    end
  else
    HideMinimap(true)
    HideGuide(true)
    Fade_OutNoLoadingWithWait(FADE_BLACK, FADE_TIME)
    Obj:new(OGIM, "fa_sub201_t0302"):Invisible()
    Cam.Inst:Set(17.9576, -0.056, 19.52, 15.91, 1.543, 29.178, default, 0)
    Obj:new(PLAYER, ""):SetPos(15.82, 0, 27.92, true)
    Obj:new(PLAYER, ""):SetRotationY(30, 0)
    tlk:StartTalkAndCancelDigimonRide()
    WaitFrame(15)
    FadeInWithWaitNotFlgCheck(FADE_BLACK, FADE_TIME)
    Field.ObjectPlayMotionWithStartMoveMotion(NPC, hiroko_index, "e002", 10, 10)
    Field.ObjectChangeExpression(NPC, hiroko_index, "F01", EYES_BLINK_TYPE_BLINK, true, 30, AUTO_CANCEL_NONE, 15)
    tlk:Message("s010_003_080")
    Field.ObjectChangeExpression(NPC, hiroko_index, "F01", EYES_BLINK_TYPE_BLINK, false, 30, AUTO_CANCEL_NONE, 15)
    MessageClose()
    local result = tlk:Select(2, "s010_003_090")
    WaitFrame(15)
    Field.ObjectChangeExpression(NPC, hiroko_index, "F01", EYES_BLINK_TYPE_BLINK, true, 30, AUTO_CANCEL_NONE, 15)
    if result == RESULT_TALK00 then
      Field.ObjectPlayMotionWithStartMoveMotion(NPC, hiroko_index, "e012", 10, 10)
      tlk:Message("s010_003_100")
      tlk:Message("s010_003_120")
      Field.ObjectChangeExpression(NPC, hiroko_index, "F01", EYES_BLINK_TYPE_BLINK, false, 30, AUTO_CANCEL_NONE, 15)
      Talk.CloseLetterBox()
      Qst.Sub:Start(self.ID, 1, false)
      Flg.Set("FLAG_S003_008")
      Fade_OutNoLoadingWithWait(FADE_BLACK, FADE_TIME)
      Talk.OpenLetterBox()
      tlk:EndTalk()
      Obj:new(OGIM, "fa_sub201_t0302"):CancelInvisible()
      Cam.Inst:Clear(0)
      Field.ObjectCheckSync(FOR_ALL, false)
      SetEnableGimmickCheck("map_0001", false)
      SetEnableGimmickCheck("map_0002", false)
      SetEnableGimmickCheck("map_0003", false)
      Common.ProhibitSave()
      FadeInWithWaitNotFlgCheck(FADE_BLACK, FADE_TIME)
      HideMinimap(false)
      HideGuide(false)
      Qst.Sub:Set(self.ID, self.STEP_010)
    elseif result == RESULT_TALK01 then
      Field.ObjectPlayMotionWithStartMoveMotion(NPC, hiroko_index, "e002", 10, 10)
      tlk:Message("s010_003_110")
      tlk:EndTalk()
      HideMinimap(false)
      HideGuide(false)
      Field.ObjectChangeExpression(NPC, hiroko_index, "F01", EYES_BLINK_TYPE_BLINK, false, 30, AUTO_CANCEL_NONE, 15)
      Fade_OutNoLoadingWithWait(FADE_BLACK, FADE_TIME)
      Cam.Inst:Clear(0)
      Obj:new(OGIM, "fa_sub201_t0302"):CancelInvisible()
      FadeInWithWaitNotFlgCheck(FADE_BLACK, FADE_TIME)
    end
  end
end

function S010_003:Event_020()
  if Qst.Sub:Check(self.ID, self.STEP_010, self.STEP_015) then
    local hiroko_index = GetIndex(NPC, "s010_003_hiroko_01")
    local asuna_index = GetIndex(NPC, "npc_0501")
    Field.ObjectLoadMotion(NPC, hiroko_index, "fn01_01")
    Field.ObjectLoadMotion(NPC, hiroko_index, "e002")
    Field.ObjectLoadMotion(NPC, hiroko_index, "e004")
    Field.ObjectLoadMotion(NPC, hiroko_index, "e006")
    Field.ObjectLoadMotion(NPC, hiroko_index, "e008")
    Field.ObjectLoadMotion(NPC, hiroko_index, "e010")
    Field.ObjectLoadMotion(NPC, hiroko_index, "e012")
    Field.ObjectLoadMotion(NPC, asuna_index, "fn01_01")
    Field.ObjectLoadMotion(NPC, asuna_index, "e002")
    Field.ObjectLoadMotion(NPC, asuna_index, "e004")
    Field.ObjectLoadMotion(NPC, asuna_index, "e006")
    Field.ObjectLoadMotion(NPC, asuna_index, "e008")
    Field.ObjectLoadMotion(NPC, asuna_index, "e012")
    tlk:StartTalkAndCancelDigimonRide()
    HideMinimap(true)
    HideGuide(true)
    ObjectTurnToPlayer(NPC, "npc_0501")
    Field.ObjectPlayMotionWithStartMoveMotion(NPC, asuna_index, "e006", 10, 10)
    tlk:Message("s010_003_130")
    Flg.Set("FLAG_S003_009")
    FadeOutWithWait(0, 15)
    WaitFrame(15)
    Cam.Inst:Set(12.847, -0.2316, -20.123, 11.046, 1.547, -10.449, default, 0)
    Obj:new(PLAYER, ""):SetPos(10.94, 0, -12.053)
    Obj:new(PLAYER, ""):SetRotationY(40, 0)
    Field.ObjectCheckSync(FOR_ALL, false)
    WaitFrame(1)
    ObjectTurnToPlayer(NPC, "npc_0501")
    Field.ObjectLookAtTheObject(NPC, asuna_index, PLAYER, 1, 0)
    FadeInWithWait(0, 15)
    Field.ObjectChangeExpression(NPC, asuna_index, "F01", EYES_BLINK_TYPE_BLINK, true, 30, AUTO_CANCEL_NONE, 15)
    Field.ObjectPlayMotionWithStartMoveMotion(NPC, asuna_index, "e002", 10, 10)
    tlk:Message("s010_003_140")
    Field.ObjectChangeExpression(NPC, asuna_index, "F01", EYES_BLINK_TYPE_BLINK, false, 30, AUTO_CANCEL_NONE, 15)
    Field.ObjectChangeExpression(NPC, hiroko_index, "F01", EYES_BLINK_TYPE_BLINK, true, 30, AUTO_CANCEL_NONE, 15)
    Field.ObjectPlayMotionWithStartMoveMotion(NPC, hiroko_index, "e010", 10, 10)
    tlk:Message("s010_003_150")
    Field.ObjectChangeExpression(NPC, hiroko_index, "F01", EYES_BLINK_TYPE_BLINK, false, 30, AUTO_CANCEL_NONE, 15)
    Field.ObjectChangeExpression(NPC, asuna_index, "F01", EYES_BLINK_TYPE_BLINK, true, 30, AUTO_CANCEL_NONE, 15)
    Field.ObjectPlayMotion(NPC, asuna_index, "e008", 15, true)
    tlk:Message("s010_003_160")
    Field.ObjectChangeExpression(NPC, asuna_index, "F01", EYES_BLINK_TYPE_BLINK, false, 30, AUTO_CANCEL_NONE, 15)
    Field.ObjectChangeExpression(NPC, hiroko_index, "F01", EYES_BLINK_TYPE_BLINK, true, 30, AUTO_CANCEL_NONE, 15)
    Field.ObjectPlayMotionWithStartMoveMotion(NPC, hiroko_index, "e006", 10, 10)
    tlk:Message("s010_003_170")
    Field.ObjectChangeExpression(NPC, hiroko_index, "F01", EYES_BLINK_TYPE_BLINK, false, 30, AUTO_CANCEL_NONE, 15)
    Field.ObjectChangeExpression(NPC, asuna_index, "F01", EYES_BLINK_TYPE_BLINK, true, 30, AUTO_CANCEL_NONE, 15)
    Field.ObjectPlayMotionWithStartMoveMotion(NPC, asuna_index, "e002", 10, 10)
    tlk:Message("s010_003_180")
    Field.ObjectChangeExpression(NPC, asuna_index, "F01", EYES_BLINK_TYPE_BLINK, false, 30, AUTO_CANCEL_NONE, 15)
    Field.ObjectChangeExpression(NPC, hiroko_index, "F01", EYES_BLINK_TYPE_BLINK, true, 30, AUTO_CANCEL_NONE, 15)
    Field.ObjectPlayMotionWithStartMoveMotion(NPC, hiroko_index, "e002", 10, 10)
    tlk:Message("s010_003_190")
    Field.ObjectChangeExpression(NPC, hiroko_index, "F01", EYES_BLINK_TYPE_BLINK, false, 30, AUTO_CANCEL_NONE, 15)
    Field.ObjectChangeExpression(NPC, asuna_index, "F01", EYES_BLINK_TYPE_BLINK, true, 30, AUTO_CANCEL_NONE, 15)
    Field.ObjectPlayMotion(NPC, asuna_index, "e012", 15, true)
    tlk:Message("s010_003_200")
    Field.ObjectChangeExpression(NPC, asuna_index, "F01", EYES_BLINK_TYPE_BLINK, false, 30, AUTO_CANCEL_NONE, 15)
    Field.ObjectChangeExpression(NPC, hiroko_index, "F01", EYES_BLINK_TYPE_BLINK, true, 30, AUTO_CANCEL_NONE, 15)
    Field.ObjectPlayMotion(NPC, hiroko_index, "e008", 15, true)
    tlk:Message("s010_003_210")
    Field.ObjectChangeExpression(NPC, hiroko_index, "F01", EYES_BLINK_TYPE_BLINK, false, 30, AUTO_CANCEL_NONE, 15)
    Field.ObjectChangeExpression(NPC, asuna_index, "F01", EYES_BLINK_TYPE_BLINK, true, 30, AUTO_CANCEL_NONE, 15)
    Field.ObjectPlayMotionWithStartMoveMotion(NPC, asuna_index, "e002", 10, 10)
    tlk:Message("s010_003_220")
    Field.ObjectChangeExpression(NPC, asuna_index, "F01", EYES_BLINK_TYPE_BLINK, false, 30, AUTO_CANCEL_NONE, 15)
    Field.ObjectChangeExpression(NPC, hiroko_index, "F01", EYES_BLINK_TYPE_BLINK, true, 30, AUTO_CANCEL_NONE, 15)
    Field.ObjectPlayMotion(NPC, hiroko_index, "e012", 15, true)
    tlk:Message("s010_003_230")
    Field.ObjectChangeExpression(NPC, hiroko_index, "F01", EYES_BLINK_TYPE_BLINK, false, 30, AUTO_CANCEL_NONE, 15)
    Field.ObjectChangeExpression(NPC, asuna_index, "F01", EYES_BLINK_TYPE_BLINK, true, 30, AUTO_CANCEL_NONE, 15)
    Field.ObjectPlayMotion(NPC, asuna_index, "e008", 15, true)
    tlk:Message("s010_003_240")
    Field.ObjectPlayMotionWithStartMoveMotion(NPC, asuna_index, "e002", 10, 10)
    tlk:Message("s010_003_250")
    tlk:EndTalk()
    Field.ObjectChangeExpression(NPC, asuna_index, "F01", EYES_BLINK_TYPE_BLINK, false, 30, AUTO_CANCEL_NONE, 15)
    Flg.Set("FLAG_S003_010")
    Fade_OutNoLoadingWithWait(FADE_BLACK, FADE_TIME)
    Cam.Inst:Clear(0)
    Field.ObjectCheckSync(FOR_ALL, false)
    Qst.Sub:Set(self.ID, self.STEP_015)
    Flg.Set("FLAG_S003_002")
    Flg.Set("FLAG_SKIP_AREACHANGE_MOVE")
    MapChange("t", 303, "start_01", false, 0, FADE_TIME)
  end
end

function S010_003:Event_030()
  if Qst.Sub:Check(self.ID, self.STEP_015, self.STEP_020) then
    local hiroko_index = GetIndex(NPC, "Hiroko_01")
    local asuna_index = GetIndex(NPC, "Koan_01")
    Field.ObjectLoadMotion(NPC, hiroko_index, "fn01_01")
    Field.ObjectLoadMotion(NPC, hiroko_index, "e002")
    Field.ObjectLoadMotion(NPC, hiroko_index, "e004")
    Field.ObjectLoadMotion(NPC, hiroko_index, "e006")
    Field.ObjectLoadMotion(NPC, hiroko_index, "e008")
    Field.ObjectLoadMotion(NPC, hiroko_index, "e010")
    Field.ObjectLoadMotion(NPC, hiroko_index, "e012")
    Field.ObjectLoadMotion(NPC, asuna_index, "fn01_01")
    Field.ObjectLoadMotion(NPC, asuna_index, "e002")
    Field.ObjectLoadMotion(NPC, asuna_index, "e004")
    Field.ObjectLoadMotion(NPC, asuna_index, "e006")
    Field.ObjectLoadMotion(NPC, asuna_index, "e008")
    Field.ObjectLoadMotion(NPC, asuna_index, "e012")
    Cam.Inst:Set(-7.42, -0.68, -0.003, -17.295, 0.883, 0.317, default, 0)
    Obj:new(PLAYER, ""):SetPos(-14.3935, 0, 0.1611, true)
    HideMinimap(true)
    WaitFrame(5)
    HideGuide(true)
    WaitFrame(5)
    tlk:StartTalkAndCancelDigimonRide()
    WaitFrame(15)
    FadeAllInWithWait(FADE_BLACK, FADE_TIME)
    Field.ObjectPlayMotionWithStartMoveMotion(NPC, asuna_index, "e002", 10, 10)
    tlk:Message("s010_003_260")
    Field.ObjectChangeExpression(NPC, hiroko_index, "F01", EYES_BLINK_TYPE_BLINK, true, 30, AUTO_CANCEL_NONE, 15)
    Field.ObjectPlayMotion(NPC, hiroko_index, "e008", 15, true)
    tlk:Message("s010_003_270")
    Field.ObjectChangeExpression(NPC, hiroko_index, "F01", EYES_BLINK_TYPE_BLINK, false, 30, AUTO_CANCEL_NONE, 15)
    Field.ObjectPlayMotionWithStartMoveMotion(NPC, asuna_index, "fn01_01", 10, 10)
    tlk:Message("s010_003_280")
    Field.ObjectPlayMotion(NPC, asuna_index, "e012", 15, true)
    tlk:Message("s010_003_290")
    Field_StopBGM()
    Field.ObjectChangeExpression(NPC, hiroko_index, "F01", EYES_BLINK_TYPE_BLINK, true, 30, AUTO_CANCEL_NONE, 15)
    Field.ObjectPlayMotionWithStartMoveMotion(NPC, hiroko_index, "e002", 10, 10)
    Field.ObjectLookAtTheObject(NPC, hiroko_index, NPC, asuna_index, 30)
    tlk:Message("s010_003_300")
    Field.ObjectChangeExpression(NPC, hiroko_index, "F01", EYES_BLINK_TYPE_BLINK, false, 30, AUTO_CANCEL_NONE, 15)
    Field.ObjectPlayMotion(NPC, asuna_index, "e008", 15, true)
    tlk:Message("s010_003_310")
    tlk:Message("s010_003_320")
    Field.ObjectPlayMotionWithStartMoveMotion(NPC, asuna_index, "e002", 10, 10)
    tlk:Message("s010_003_330")
    Field.ObjectChangeExpression(NPC, hiroko_index, "F01", EYES_BLINK_TYPE_BLINK, true, 30, AUTO_CANCEL_NONE, 15)
    Field.ObjectPlayMotionWithStartMoveMotion(NPC, hiroko_index, "e002", 10, 10)
    tlk:Message("s010_003_340")
    Field.ObjectChangeExpression(NPC, hiroko_index, "F01", EYES_BLINK_TYPE_BLINK, false, 30, AUTO_CANCEL_NONE, 15)
    Field.ObjectPlayMotion(NPC, asuna_index, "e012", 15, true)
    tlk:Message("s010_003_350")
    tlk:EndTalk()
    Flg.Set("FLAG_S003_007")
    FadeOutWithWait(0, 15)
    Cam.Inst:Clear(0)
    Field.ObjectCheckSync(FOR_ALL, false)
    HideMinimap(false)
    WaitFrame(5)
    HideGuide(false)
    FadeInWithWait(0, 15)
    Field_PlayBGM(900)
    SetEnableGimmickCheck("map_0001", false)
    Common.CancelProhibitSave()
    Qst.Sub:Set(self.ID, self.STEP_020)
  end
end

function S010_003:Event_035()
  if Qst.Sub:Check(self.ID, self.STEP_020, self.STEP_025) then
    tlk:StartTalkAndCancelDigimonRide()
    tlk:Message("s010_003_350")
    tlk:EndTalk()
    Field.MovePlayerToRelativePosFrame(2, 0, 30)
    WaitFrame(30)
  end
end

function S010_003:Event_037()
  if Qst.Sub:Check(self.ID, self.STEP_020, self.STEP_025) then
    tlk:StartTalkAndCancelDigimonRide()
    tlk:Message("s010_003_350")
    tlk:EndTalk()
  end
end

function S010_003:Event_040()
  if Qst.Sub:Check(self.ID, self.STEP_020, self.STEP_025) then
    local girumon_index = GetIndex(NPC, "Giru_01")
    Field.ObjectLoadMotion(NPC, girumon_index, "bn01")
    Field.ObjectLoadMotion(NPC, girumon_index, "bn02")
    Field.ObjectLoadMotion(NPC, girumon_index, "ba01")
    Field.ObjectLoadMotion(NPC, girumon_index, "fe02")
    Field.ObjectLoadMotion(NPC, girumon_index, "fe03")
    Field.ObjectLoadMotion(NPC, girumon_index, "fe04")
    Field.ObjectLoadMotion(NPC, girumon_index, "fq01")
    Field.ObjectLoadMotion(NPC, girumon_index, "fq02")
    HideMinimap(true)
    HideGuide(true)
    Flg.Set("FLAG_S003_003")
    Fade_OutNoLoadingWithWait(FADE_BLACK, FADE_TIME)
    Cam.Inst:Set(-13.78, -2.1378, -13.13, -16.076, 1.4, -4.069, default, 0)
    tlk:StartTalkAndCancelDigimonRide()
    Obj:new(PLAYER, ""):SetPos(-14.62, 0, -6.7, true)
    Obj:new(PLAYER, ""):SetRotationY(345, 0)
    WaitFrame(15)
    Field.ObjectLookAtTheObject(PLAYER, 1, NPC, girumon_index, 15)
    FadeInWithWaitNotFlgCheck(FADE_BLACK, FADE_TIME)
    Field.ObjectPlayMotionWithStartMoveMotion(NPC, girumon_index, "fe02", 10, 10)
    tlk:Message("s010_003_360")
    Field.ObjectLookAtTheObject(PLAYER, 1, NPC, girumon_index, 15)
    tlk:Message("s010_003_370")
    MessageClose()
    while true do
      tlk:Message("s010_003_380")
      local result = tlk:Select(3, "s010_003_390")
      WaitFrame(15)
      if result == RESULT_TALK00 then
        Field.ObjectPlayMotionWithStartMoveMotion(NPC, girumon_index, "fe03", 10, 10)
        tlk:Message("s010_003_400")
        MessageClose()
      elseif result == RESULT_TALK01 then
        Field.ObjectPlayMotionWithStartMoveMotion(NPC, girumon_index, "fe02", 10, 10)
        tlk:Message("s010_003_410")
        break
      elseif result == RESULT_TALK02 then
        Field.ObjectPlayMotionWithStartMoveMotion(NPC, girumon_index, "fe03", 10, 10)
        tlk:Message("s010_003_420")
        MessageClose()
      end
    end
    Field.ObjectResetAim(NPC, girumon_index, 10)
    Field.ObjectPlayMotionWithStartMoveMotion(NPC, girumon_index, "fq01", 10, 10)
    tlk:Message("s010_003_430")
    tlk:Message("s010_003_440")
    Field.ObjectPlayMotionWithStartMoveMotion(NPC, girumon_index, "fe04", 10, 10)
    tlk:Message("s010_003_450")
    FadeOutWithWait(0, 15)
    Obj:new(NPC, "Giru_01"):Invisible()
    FadeInWithWait(0, 15)
    tlk:Message("s010_003_460")
    tlk:EndTalk()
    Flg.Set("FLAG_S003_005")
    HideMinimap(false)
    HideGuide(false)
    Cam.Inst:Clear(30)
    Qst.Sub:Set(self.ID, self.STEP_025)
    SetEnableGimmickCheck("map_0001", true)
  end
end

function S010_003:Event_050()
  local hiroko_index = GetIndex(NPC, "hiroko_003")
  local asuna_index = GetIndex(NPC, "koan_01")
  local girumon_index = GetIndex(NPC, "Giru_02")
  Field.ObjectLoadMotion(NPC, hiroko_index, "fn01_01")
  Field.ObjectLoadMotion(NPC, hiroko_index, "e002")
  Field.ObjectLoadMotion(NPC, hiroko_index, "e003")
  Field.ObjectLoadMotion(NPC, hiroko_index, "e004")
  Field.ObjectLoadMotion(NPC, hiroko_index, "e010")
  Field.ObjectLoadMotion(NPC, hiroko_index, "e006")
  Field.ObjectLoadMotion(NPC, hiroko_index, "e008")
  Field.ObjectLoadMotion(NPC, hiroko_index, "e012")
  Field.ObjectLoadMotion(NPC, asuna_index, "fn01_01")
  Field.ObjectLoadMotion(NPC, asuna_index, "e002")
  Field.ObjectLoadMotion(NPC, asuna_index, "e004")
  Field.ObjectLoadMotion(NPC, asuna_index, "e006")
  Field.ObjectLoadMotion(NPC, asuna_index, "e008")
  Field.ObjectLoadMotion(NPC, asuna_index, "e012")
  Field.ObjectLoadMotion(NPC, asuna_index, "e018")
  Field.ObjectLoadMotion(PLAYER, 1, "e002")
  Field.ObjectLoadMotion(PLAYER, 1, "e004_01")
  Field.ObjectLoadMotion(PLAYER, 1, "e008")
  Field.ObjectLoadMotion(PLAYER, 1, "e012")
  Field.ObjectLoadMotion(PLAYER, 1, "e013")
  Field.ObjectLoadMotion(PLAYER, 1, "e015")
  Field.ObjectLoadMotion(PLAYER, 1, "e018")
  Field.ObjectLoadMotion(PLAYER, 1, "e019")
  Field.ObjectLoadMotion(NPC, girumon_index, "bn01")
  Field.ObjectLoadMotion(NPC, girumon_index, "bn02")
  Field.ObjectLoadMotion(NPC, girumon_index, "fe02")
  Field.ObjectLoadMotion(NPC, girumon_index, "fe04")
  Field.ObjectLoadMotion(NPC, girumon_index, "fq01")
  Field.ObjectLoadMotion(NPC, girumon_index, "fq02")
  if Qst.Sub:Check(self.ID, self.STEP_025, self.STEP_030) then
    Flg.Set("FLAG_S003_004")
    HideMinimap(true)
    HideGuide(true)
    tlk:StartTalkAndCancelDigimonRide()
    FadeOutWithWait(0, 15)
    Obj:new(PLAYER, ""):SetPos(-121, 5, -32.56)
    Obj:new(PLAYER, ""):SetRotationY(180, 0)
    Field.ObjectCheckSync(FOR_ALL, false)
    Cam.Inst:Set(-118.1, 3.45, -28.19, -123.58, 7.366, -35.59, default, 0)
    FadeInWithWait(0, 15)
    Field.ObjectPlayMotionWithStartMoveMotion(NPC, girumon_index, "fe04", 10, 10)
    tlk:Message("s010_003_470")
    Field.ObjectPlayMotion(PLAYER, 1, "e018", 15, true)
    WaitFrame(5)
    Field.ObjectPlayMotion(NPC, hiroko_index, "e006", 15, true)
    WaitFrame(7)
    Field.ObjectPlayMotion(NPC, asuna_index, "e018", 15, true)
    tlk:Message("s010_003_480")
    tlk:EndTalk(true)
    Qst.Sub:Set(self.ID, self.STEP_030)
    EncountFromField_PlaySound(20100030, 11171, false)
  end
end

function S010_003:Event_060()
  if Qst.Sub:Check(self.ID, self.STEP_030, self.STEP_035) and Flg.Check("FLAG_S003_000") then
    local hiroko_index = GetIndex(NPC, "hiroko_003")
    local asuna_index = GetIndex(NPC, "koan_01")
    local girumon_index = GetIndex(NPC, "Giru_02")
    Field.ObjectLoadMotion(NPC, hiroko_index, "fn01_01")
    Field.ObjectLoadMotion(NPC, hiroko_index, "e002")
    Field.ObjectLoadMotion(NPC, hiroko_index, "e003")
    Field.ObjectLoadMotion(NPC, hiroko_index, "e004")
    Field.ObjectLoadMotion(NPC, hiroko_index, "e010")
    Field.ObjectLoadMotion(NPC, hiroko_index, "e006")
    Field.ObjectLoadMotion(NPC, hiroko_index, "e008")
    Field.ObjectLoadMotion(NPC, hiroko_index, "e012")
    Field.ObjectLoadMotion(NPC, asuna_index, "fn01_01")
    Field.ObjectLoadMotion(NPC, asuna_index, "e002")
    Field.ObjectLoadMotion(NPC, asuna_index, "e004")
    Field.ObjectLoadMotion(NPC, asuna_index, "e006")
    Field.ObjectLoadMotion(NPC, asuna_index, "e008")
    Field.ObjectLoadMotion(NPC, asuna_index, "e012")
    Field.ObjectLoadMotion(NPC, girumon_index, "bn01")
    Field.ObjectLoadMotion(NPC, girumon_index, "bn02")
    Field.ObjectLoadMotion(NPC, girumon_index, "fe02")
    Field.ObjectLoadMotion(NPC, girumon_index, "fe04")
    Field.ObjectLoadMotion(NPC, girumon_index, "fq01")
    Field.ObjectLoadMotion(NPC, girumon_index, "fq02")
    Cam.Inst:Set(-120.236, 4.696, -28.95, -123.997, 8.624, -37.342, default, 30)
    HideMinimap(true)
    HideGuide(true)
    tlk:StartTalkAndCancelDigimonRide()
    Field.ObjectPlayMotion(NPC, girumon_index, "bn02", 15, true)
    Field.ObjectPlayMotion(PLAYER, 1, "fn01_01", 15, true)
    Field.ObjectPlayMotion(NPC, hiroko_index, "fn01_01", 15, true)
    tlk:Message("s010_003_490")
    Field.ObjectPlayMotionWithStartMoveMotion(NPC, asuna_index, "e002", 10, 10)
    tlk:Message("s010_003_500")
    Field.ObjectPlayMotionWithStartMoveMotion(NPC, hiroko_index, "e012", 10, 10)
    tlk:Message("s010_003_510")
    Field.ObjectPlayMotionWithStartMoveMotion(NPC, asuna_index, "e012", 10, 10)
    tlk:Message("s010_003_520")
    Field.ObjectPlayMotionWithStartMoveMotion(NPC, girumon_index, "fq02", 10, 10)
    tlk:Message("s010_003_530")
    FadeOutWithWait(0, 15)
    Obj:new(NPC, "Giru_02"):Invisible()
    FadeInWithWait(0, 15)
    PlayerLookAtObject(NPC, "hiroko_003")
    Field.ObjectPlayMotionWithStartMoveMotion(NPC, hiroko_index, "e008", 10, 10)
    tlk:Message("s010_003_540")
    PlayerLookAtObject(NPC, "koan_01")
    Field.ObjectPlayMotion(NPC, asuna_index, "e008", 15, true)
    tlk:Message("s010_003_550")
    Field.ObjectPlayMotionWithStartMoveMotion(NPC, asuna_index, "e012", 10, 10)
    tlk:Message("s010_003_560")
    Field.ObjectPlayMotionWithStartMoveMotion(NPC, asuna_index, "e002", 10, 10)
    tlk:Message("s010_003_570")
    tlk:EndTalk(true)
    Qst.Sub:Set(self.ID, self.STEP_035)
    Cam.Inst:Clear(30)
    MapChange("t", 303, "start_02", true, 0, FADE_TIME)
  end
end

function S010_003:Event_070()
  if Qst.Sub:Check(self.ID, self.STEP_035, self.STEP_040) then
    local hiroko_index = GetIndex(NPC, "Hiroko_03")
    local asuna_index = GetIndex(NPC, "Koan_03")
    Field.ObjectLoadMotion(NPC, hiroko_index, "fn01_01")
    Field.ObjectLoadMotion(NPC, hiroko_index, "e002")
    Field.ObjectLoadMotion(NPC, hiroko_index, "e003")
    Field.ObjectLoadMotion(NPC, hiroko_index, "e004")
    Field.ObjectLoadMotion(NPC, hiroko_index, "e010")
    Field.ObjectLoadMotion(NPC, hiroko_index, "e006")
    Field.ObjectLoadMotion(NPC, hiroko_index, "e008")
    Field.ObjectLoadMotion(NPC, hiroko_index, "e012")
    Field.ObjectLoadMotion(NPC, asuna_index, "fn01_01")
    Field.ObjectLoadMotion(NPC, asuna_index, "e002")
    Field.ObjectLoadMotion(NPC, asuna_index, "e004")
    Field.ObjectLoadMotion(NPC, asuna_index, "e006")
    Field.ObjectLoadMotion(NPC, asuna_index, "e008")
    Field.ObjectLoadMotion(NPC, asuna_index, "e012")
    Obj:new(NPC, "Hiroko_03"):CancelInvisible()
    Obj:new(NPC, "Koan_03"):CancelInvisible()
    HideMinimap(true)
    HideGuide(true)
    tlk:StartTalkAndCancelDigimonRide()
    Cam.Inst:Set(6.84, -0.03, -2.31, -3.01, 1.54, -1.645, default, 30)
    PlayerLookAtObject(NPC, "Koan_03")
    Field.ObjectChangeExpression(NPC, asuna_index, "F01", EYES_BLINK_TYPE_BLINK, true, 30, AUTO_CANCEL_NONE, 15)
    Field.ObjectPlayMotionWithStartMoveMotion(NPC, asuna_index, "e002", 10, 10)
    tlk:Message("s010_003_580")
    Field.ObjectPlayMotion(NPC, asuna_index, "e012", 15, true)
    tlk:Message("s010_003_590")
    Field.ObjectChangeExpression(NPC, asuna_index, "F01", EYES_BLINK_TYPE_BLINK, false, 30, AUTO_CANCEL_NONE, 15)
    Field.ObjectChangeExpression(NPC, hiroko_index, "F01", EYES_BLINK_TYPE_BLINK, true, 30, AUTO_CANCEL_NONE, 15)
    Field.ObjectLookAtTheObject(NPC, hiroko_index, NPC, asuna_index, 30)
    Field.ObjectPlayMotionWithStartMoveMotion(NPC, hiroko_index, "e002", 10, 10)
    tlk:Message("s010_003_610")
    Field.ObjectChangeExpression(NPC, hiroko_index, "F01", EYES_BLINK_TYPE_BLINK, false, 30, AUTO_CANCEL_NONE, 15)
    Field.ObjectPlayMotion(NPC, asuna_index, "e008", 15, true)
    tlk:Message("s010_003_620")
    Field.ObjectChangeExpression(NPC, asuna_index, "F01", EYES_BLINK_TYPE_BLINK, true, 30, AUTO_CANCEL_NONE, 15)
    Field.ObjectPlayMotionWithStartMoveMotion(NPC, asuna_index, "e002", 10, 10)
    tlk:Message("s010_003_630")
    Field.ObjectChangeExpression(NPC, asuna_index, "F01", EYES_BLINK_TYPE_BLINK, false, 30, AUTO_CANCEL_NONE, 15)
    tlk:EndTalk(true)
    Qst.Sub:Set(self.ID, self.STEP_040)
    MapChange("t", 302, "start_00", true, 0, FADE_TIME)
  end
end

function S010_003:Event_080()
  if Qst.Sub:Check(self.ID, self.STEP_040, self.STEP_255) then
    local hiroko_index = GetIndex(NPC, "npc_0502")
    Field.ObjectLoadMotion(NPC, hiroko_index, "fn01_01")
    Field.ObjectLoadMotion(NPC, hiroko_index, "e002")
    Field.ObjectLoadMotion(NPC, hiroko_index, "e003")
    Field.ObjectLoadMotion(NPC, hiroko_index, "e004")
    Field.ObjectLoadMotion(NPC, hiroko_index, "e010")
    Field.ObjectLoadMotion(NPC, hiroko_index, "e006")
    Field.ObjectLoadMotion(NPC, hiroko_index, "e008")
    Field.ObjectLoadMotion(NPC, hiroko_index, "e012")
    Obj:new(NPC, "npc_0502"):CancelInvisible()
    Flg.Set("FLAG_S003_006")
    Obj:new(NPC, "npc_0502"):SetPos(0.557, 0, 38.3)
    HideMinimap(true)
    HideGuide(true)
    tlk:StartTalkAndCancelDigimonRide()
    Cam.Inst:Set(0.6327, 0.05, 31.44, 0.44, 1.424, 41.35, default, 30)
    Field.ObjectChangeExpression(NPC, hiroko_index, "F01", EYES_BLINK_TYPE_BLINK, true, 30, AUTO_CANCEL_NONE, 15)
    Field.ObjectPlayMotionWithStartMoveMotion(NPC, hiroko_index, "e002", 10, 10)
    tlk:Message("s010_003_650")
    Field.ObjectPlayMotionWithStartMoveMotion(NPC, hiroko_index, "e008", 10, 10)
    tlk:Message("s010_003_660")
    Field.ObjectPlayMotionWithStartMoveMotion(NPC, hiroko_index, "e012", 10, 10)
    tlk:Message("s010_003_670")
    tlk:Message("s010_003_680")
    Field.ObjectChangeExpression(NPC, hiroko_index, "F01", EYES_BLINK_TYPE_BLINK, false, 30, AUTO_CANCEL_NONE, 15)
    FadeOutWithWait(0, 15)
    Obj:new(NPC, "npc_0502"):Invisible()
    tlk:EndTalk()
    SetEnableGimmickCheck("s200_147_start", true)
    Obj:new(NPC, "s910_171_002"):CancelInvisible(0)
    Obj:new(NPC, "npc_0317"):CancelInvisible(0)
    FadeInWithWait(0, 15)
    WaitFrame(15)
    HideMinimap(false)
    HideGuide(false)
    Cam.Inst:Clear(30)
    Digitter.Send(2003020)
    Flg.Set("FLAG_IS_CLEAR_S010_003")
    Qst.Sub:End(self.ID, self.STEP_255)
  end
end

function S010_003:Event_091()
  if Qst.Sub:Check(self.ID, self.STEP_010, self.STEP_025) then
    local tlk = Tlk:new("t04", 1, true)
    tlk:StartTalkAndCancelDigimonRide()
    tlk:Message("f_t0401_0050_0010")
    Field.MovePlayerToRelativePosFrame(3, 0, 30)
    WaitFrame(30)
    tlk:EndTalk()
  end
end

function S010_003:Event_092()
  if Qst.Sub:Check(self.ID, self.STEP_010, self.STEP_025) then
    local tlk = Tlk:new("t01", 1, true)
    tlk:StartTalkAndCancelDigimonRide()
    tlk:Message("f_t0102_0080_0010")
    tlk:EndTalk()
  end
end
