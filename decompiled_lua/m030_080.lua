require("include")

function m030_080()
  Fade_Out(0, 0)
  BackFade_In(0, 0)
  EVENT_BEGIN()
  Talk.Load("m030")
  SetEventCutNo(5)
  SetTimeZone("Noon")
  SetTimeAxis("A2020_dbef_30")
  LoadMap("t3003")
  LoadModel("HOMEROS_01", "char_HOMEROS")
  LoadModel("YGGDRASILL_01", "char_YGGDRASILL")
  LoadModel("TOUHOU_01", "char_TOUHO")
  Vista.LoadAnimationFace("HOMEROS_01", "e01", "m01")
  Vista.BindSpeaker("HOMEROS_01", "char_HOMEROS_SLEEPY_GIRL")
  Vista.BindSpeaker("YGGDRASILL_01", "char_YGGDRASILL_SELFISH_GIRL")
  Vista.BindSpeaker("TOUHOU_01", "char_TOUHO_CALM_BOY")
  LoadSceneViewerResource("c1.0", "m030_080_c1.0")
  LoadSceneViewerResource("c2.0", "m030_080_c2.0")
  LoadSceneViewerResource("c3.0", "m030_080_c3.0")
  LoadSceneViewerResource("c4.0", "m030_080_c4.0")
  LoadSceneViewerResource("c5.0", "m030_080_c5.0")
  LoadEnvironmentFile("c1.0", "es_m030_080_c1.0")
  LoadEnvironmentFile("c2.0", "es_m030_080_c2.0")
  LoadEnvironmentFile("c3.0", "es_m030_080_c3.0")
  LoadEnvironmentFile("c4.0", "es_m030_080_c4.0")
  LoadEnvironmentFile("c5.0", "es_m030_080_c5.0")
  WaitVistaLoad()
  NpcInvisible(FOR_ALL)
  SetPosition("TOUHOU_01", 8.8, 0, -8.892, "LINEAR", 0, 0)
  SetRotation("TOUHOU_01", 0, -66, 0, "LINEAR", 0, 0)
  SetPosition("YGGDRASILL_01", 8, 0, -9.9, "LINEAR", 0, 0)
  SetRotation("YGGDRASILL_01", 0, 0, 0, "LINEAR", 0, 0)
  SetPosition("HOMEROS_01", 7.247, 0, -8.894, "LINEAR", 0, 0)
  SetRotation("HOMEROS_01", 0, 62, 0, "LINEAR", 0, 0)
  PlayMotion("HOMEROS_01", "fs01_01", 0, true, 0)
  SetFace("HOMEROS_01", "F01", 2, 1, FACE_BLENDTIME, 0)
  PlayMotion("YGGDRASILL_01", "fs01_01", 0, true, 0)
  SetFace("YGGDRASILL_01", "F01", 0, 1, FACE_BLENDTIME, 0)
  PlayMotion("TOUHOU_01", "fs01_01", 0, true, 0)
  SetFace("TOUHOU_01", "F01", 0, 1, FACE_BLENDTIME, 0)
  BlendEye("YGGDRASILL_01", 0, 0, "SCURVE", 0, 0)
  BlendFace("YGGDRASILL_01", 0, 0, 0, false, "SCURVE", 0, 0)
  BlendEye("TOUHOU_01", 0, 0, "SCURVE", 0, 0)
  BlendFace("TOUHOU_01", 0, 0, 0, false, "SCURVE", 0, 0)
  SetEnv_All("c1.0", 0)
  SetCamera(2.5, 1.6, -11.4, 0, 55, "LINEAR", 0, false, 0)
  SetCameraTarget(5, 1.4, -11.4, "LINEAR", 0, false, 0)
  SetCamera(2.5, 1.6, -11.08, 0, 55, "LINEAR", 120, false, 0)
  SetCameraTarget(5, 1.4, -11.08, "LINEAR", 120, false, 0)
  Event_PlayBGM(114, 0, 0)
  FIELD_SET()
  SetMobTransparentRange(1000, 1000, 1000)
  EVENT_START()
  CUT("1.0")
  Fade_In(0, 80)
  WaitFrame(120)
  CUT("2.0")
  SetEnv_All("c2.0", 0)
  SetCamera(8.925, 0.987, -8.532, 0, 40, "LINEAR", 0, false, 0)
  SetCameraTarget(9.299, 0.547, -9.113, "LINEAR", 0, false, 0)
  SetCamera(8.925, 1.037, -8.532, 0, 40, "LINEAR", 120, true, 0)
  SetCameraTarget(9.299, 0.597, -9.113, "LINEAR", 120, true, 0)
  SetFace("TOUHOU_01", "F01", 2, 1, FACE_BLENDTIME, 0)
  MessageTalk("m030_080_010")
  MessageClose()
  WaitFrame(10)
  SetFace("TOUHOU_01", "F01", 0, 1, FACE_BLENDTIME, 0)
  MessageTalk("m030_080_015")
  MessageClose()
  WaitFrame(10)
  CUT("3.0")
  SetEnv_All("c3.0", 0)
  SetCamera(8.832, 0.665, -9.396, 0, 40, "LINEAR", 0, false, 0)
  SetCameraTarget(7.959, 0.577, -10.667, "LINEAR", 0, false, 0)
  SetCamera(8.82, 0.665, -9.388, 0, 40, "LINEAR", 120, true, 0)
  SetCameraTarget(7.948, 0.577, -10.659, "LINEAR", 120, true, 0)
  MessageTalk("m030_080_020")
  MessageClose()
  WaitFrame(10)
  BlendFace("YGGDRASILL_01", 0, -19, 0, false, "SCURVE", 30, 0)
  MessageTalk("m030_080_025")
  MessageClose()
  WaitFrame(10)
  CUT("4.0")
  SetEnv_All("c4.0", 0)
  SetCamera(7.058, 1.248, -8.49, 0, 30, "LINEAR", 0, false, 0)
  SetCameraTarget(6.482, 0.529, -9.709, "LINEAR", 0, false, 0)
  SetCamera(7.036, 1.22, -8.537, 0, 30, "LINEAR", 120, true, 0)
  SetCameraTarget(6.482, 0.529, -9.709, "LINEAR", 120, true, 0)
  Vista.SetEnableLipSyncsAnimation("HOMEROS_01", false)
  SetFace("HOMEROS_01", "E02_M01", 0, 1, 20, 0)
  MessageTalk("m030_080_030")
  MessageClose()
  WaitFrame(10)
  CUT("5.0")
  SetEnv_All("c5.0", 0)
  SetCamera(7.996, 1.1, -2.801, 0, 65, "LINEAR", 0, false, 0)
  SetCameraTarget(7.909, 0.52, -8.922, "LINEAR", 0, false, 0)
  SetCamera(8.005, 1.164, -2.125, 0, 65, "LINEAR", 140, true, 0)
  SetCameraTarget(7.909, 0.52, -8.922, "LINEAR", 140, true, 0)
  WaitFrame(20)
  if not Vista.IsSkipping() then
    Vista.SetSkip(false, true)
    Event_StopBGM(4)
    Fade_OutNoLoadingWithWait(1, 120)
  end
  Fade_OutNoLoadingWithWait(1, 0)
  EVENT_END(1)
end

function CUT(cut_no)
  CUT_START(cut_no)
end

function main()
  m030_080()
end
