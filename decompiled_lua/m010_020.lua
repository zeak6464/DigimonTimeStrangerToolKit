require("include")

function m010_020()
  EVENT_BEGIN()
  Talk.Load("m010")
  SetEventCutNo(5)
  if Debug.IsEventView() then
    SetTimeZone("Morning")
    SetTimeAxis("X2028_daft_10")
    LoadMap("t0101")
    Event_StopBGM(0, 0)
  end
  LoadModel("HERO_01", "Player")
  LoadObject("OBJ_01", "t0101m010020vision")
  Load_DigiviceHologram()
  LoadSceneViewerResource("c01", "t0101f_cm")
  LoadSceneViewerResource("c02", "t0101f_cm")
  LoadSceneViewerResource("c03", "t0101f_cm")
  LoadSceneViewerResource("c04", "t0101f_cm")
  LoadSceneViewerResource("c04_A1", "t0101f_cm")
  LoadSceneViewerResource("c04_B1", "t0101f_cm")
  LoadSceneViewerResource("c04_C1", "t0101f_cm")
  LoadSceneViewerResource("c05", "t0101f_cm")
  LoadSceneViewerResource("c05_A1", "t0101f_cm")
  LoadSceneViewerResource("c05_B1", "t0101f_cm")
  LoadSceneViewerResource("c05_C1", "t0101f_cm")
  LoadSceneViewerResource("c06", "t0101f_cm")
  LoadEnvironmentFile("c01", "es_m010_020_c01")
  LoadEnvironmentFile("c02", "es_m010_020_c02")
  LoadEnvironmentFile("c03", "es_m010_020_c03")
  LoadEnvironmentFile("c04", "es_m010_020_c04")
  LoadEnvironmentFile("c04_A1", "es_m010_020_c04_A1")
  LoadEnvironmentFile("c04_B1", "es_m010_020_c04_B1")
  LoadEnvironmentFile("c04_C1", "es_m010_020_c04_C1")
  LoadEnvironmentFile("c05", "es_m010_020_c05")
  LoadEnvironmentFile("c05_A1", "es_m010_020_c05_A1")
  LoadEnvironmentFile("c05_B1", "es_m010_020_c05_B1")
  LoadEnvironmentFile("c05_C1", "es_m010_020_c05_C1")
  LoadEnvironmentFile("c06", "es_m010_020_c06")
  WaitVistaLoad()
  SetPosition("HERO_01", -0.326, 0.68, -4.326, "LINEAR", 0, 0)
  SetRotation("HERO_01", 0, 191.5, 0, "LINEAR", 0, 0)
  PlayMotion("HERO_01", "fn01_01", 0, true, 0)
  SetFace("HERO_01", "F15", 0, 1, 0, 0)
  BlendEye("HERO_01", 0, 0, "SCURVE", 0, 0)
  BlendFace("HERO_01", -80, 11, 0, false, "SCURVE", 0, 0)
  SetMobTransparentRange(0.02, 0.02, 0.2)
  Set_DigiviceHologram()
  SetEnv_All("c01", 0)
  SetCamera(-2.272, 6.811, -16.653, 0, 35, "LINEAR", 0, false, 0)
  SetCameraTarget(-4, 12.863, -30, "LINEAR", 0, false, 0)
  BackFade_In(0, 0)
  Field_InvisiblePlayer(INVISIBLE_KEY_EVENT, 0, false)
  Field_InvisibleFollowerAllGuest(INVISIBLE_KEY_EVENT, 0, false)
  Field_InvisibleFollowerAllPartyMember(INVISIBLE_KEY_EVENT, 0, false)
  Field_InvisibleAllSymbolEnemy(INVISIBLE_KEY_EVENT, 0, false)
  EVENT_START()
  SetMobTransparentRange(0.3, 0.3, 0.3)
  CUT("1.0")
  Fade_In(0, FADE_TIME)
  SetCamera(-0.454, 1.855, -2.608, 0, 35, "SCURVE", 240, false, 0)
  SetCameraTarget(-4, 9.823, -30, "SCURVE", 240, false, 0)
  WaitFrame(260)
  CUT("2.0")
  SetEnv_All("c02", 0)
  ModelVisible("OBJ_01", false, 0, 0)
  SetCamera(-1.656, 1.007, -3.513, 0, 40, "LINEAR", 0, false, 0)
  SetCameraTarget(-0.449, 1.098, -4.38, "LINEAR", 0, false, 0)
  SetCamera(-1.033, 2.083, -5.052, 0, 40, "SCURVE_B", 140, false, 0)
  SetCameraTarget(-0.449, 2.098, -4.51, "SCURVE_B", 140, false, 0)
  BlendEye("HERO_01", 0, 0, "SCURVE", 0, 0)
  BlendFace("HERO_01", -35, 0, 0, false, "SCURVE", 0, 0)
  WaitFrame(150)
  local slot_01 = Event_PlaySE(500006, 100, false, 0, 0)
  SetFace("HERO_01", "F16", 0, 1, 2, 15)
  SetFace("HERO_01", "F15", 0, 1, 6, 30)
  BlendEye("HERO_01", 30, 10, "SCURVE", 10, 10)
  BlendFace("HERO_01", 35, 15, 0, false, "SCURVE", 25, 15)
  WaitFrame(40)
  CUT("3.0")
  SetEnv_All("c03", 0)
  Vista.RestoreMovieToMaterial()
  SetCamera(-0.9, 2.35, -3.85, 0, 30, "LINEAR", 0, false, 0)
  SetCameraTarget(-0.268, 2.05, -4.7, "LINEAR", 0, false, 0)
  SetPosition("HERO_01", -0.326, 0.68, -4.326, "LINEAR", 0, 0)
  SetRotation("HERO_01", 0, 191.5, 0, "LINEAR", 0, 0)
  BlendEye("HERO_01", 0, 0, "SCURVE", 0, 0)
  BlendFace("HERO_01", 0, 0, 0, false, "SCURVE", 0, 0)
  SetFace("HERO_01", "F15", 0, 1, FACE_BLENDTIME, 0)
  PlayMotion("HERO_01", "e200", 5, true, 0)
  WaitFrame(15)
  BlendFace("Horo_AGENT", -50, 0, 0, true, "SCURVE", 0, 0)
  Vista.AttachModelToModel("ATCdigivice00_01", "Horo_AGENT", "holo")
  Vista.SetModelAlpha("Horo_AGENT", 0.7)
  Vista.SetModelPhantom("Horo_AGENT", 0.3, 0.9, 1)
  Vista.SetAttachModelScale("Horo_AGENT", 0.2)
  Vista.SetAttachModelPos("Horo_AGENT", 0, -0.8, -0.5)
  Vista.SetAttachModelRot("Horo_AGENT", -30, 0, 0)
  ModelVisible("ATCdigivice00_01", true, 0, 0)
  PlayMotion("ATCdigivice00_01", "e200", 0, true, 0)
  SetLoopFrame("ATCdigivice00_01", "e200", 100, 200)
  WaitFrame(50)
  Event_StopSE(slot_01, 0, 0)
  WaitFrame(5)
  Event_PlaySE(401052, 100, false, 0, 0)
  WaitFrame(25)
  Vista.AttachEffectToModel("Horo_Effect", "ATCdigivice00_01", "holo")
  PlayEffect("Horo_Effect", true, 0)
  ModelVisible("Horo_AGENT", true, 0, 0)
  Vista.PlayDissolve("Horo_AGENT", 401)
  local slot_02 = Event_PlaySE(402002, 100, false, 0, 0)
  Event_PlayBGM(601, 0, 0.5)
  WaitFrame(30)
  PlayMotion("Horo_AGENT", "e033_01", 5, true, 0)
  WaitFrame(20)
  MessageTalk("m010_020_010")
  MessageTalk("m010_020_020")
  EndMotion("Horo_AGENT", 0)
  MessageClose()
  WaitFrame(20)
  PlayMotion("Horo_AGENT", "e013_01", 5, true, 15)
  PlayMotionBlend("Horo_AGENT", "blend05", 5, false, 0)
  MessageTalk("m010_020_030")
  MessageTalk("m010_020_040")
  EndMotion("Horo_AGENT", 0)
  MessageClose()
  WaitFrame(20)
  PlayMotionBlend("Horo_AGENT", "blend01", 5, false, 0)
  MessageTalk("m010_020_050")
  MessageClose()
  WaitFrame(10)
  CUT("4.0")
  SetEnv_All("c04", 0)
  SetCamera(-1.031, 2.082, -5.464, 0, 30, "LINEAR", 0, false, 0)
  SetCameraTarget(-0.272, 2.1, -4.417, "LINEAR", 0, false, 0)
  BlendEye("HERO_01", 10, 0, "SCURVE", 0, 0)
  WaitFrame(6)
  BlendFace("HERO_01", 20, 0, 0, false, "SCURVE", 10, 0)
  BlendFace("HERO_01", 0, 0, 0, false, "SCURVE", 12, 11)
  WaitFrame(40)
  PlayMotion("Horo_AGENT", "e023", 6, false, 0)
  EndMotion("Horo_AGENT", 100)
  MessageTalk("m010_020_060")
  MessageClose()
  WaitFrame(10)
  correct = false
  while not Vista.IsSkipping() and not correct do
    SetEnv_All("c04", 0)
    SetCamera(-1.031, 2.082, -5.464, 0, 30, "LINEAR", 0, false, 0)
    SetCameraTarget(-0.272, 2.1, -4.417, "LINEAR", 0, false, 0)
    SetFace("HERO_01", "F15", 0, 1, 0, 0)
    MessageTalkSel(3, "m010_020_070")
    result = Talk.GetResultSelectedNum()
    if result == RESULT_TALK00 then
      PlayMotionBlend("HERO_01", "blend01", 0, false, 0)
      SetMouth("HERO_01", 0, 0, 0)
      SetMouth("HERO_01", 1, 0, 30)
      WaitFrame(32)
      CUT("04_A1")
      SetEnv_All("c04_A1", 0)
      SetCamera(-0.9, 2.35, -3.85, 0, 30, "LINEAR", 0, false, 0)
      SetCameraTarget(-0.268, 2.05, -4.7, "LINEAR", 0, false, 0)
      PlayMotionForce("Horo_AGENT", "e012_01", 5, true, 0)
      MessageTalk("m010_020_080")
      MessageTalk("m010_020_090")
      MessageClose()
      WaitFrame(10)
      EndMotion("Horo_AGENT", 0)
      MessageTalk("m010_020_120")
      MessageClose()
      WaitFrame(10)
      correct = true
    elseif result == RESULT_TALK01 then
      SetFace("HERO_01", "E12_M06", 0, 1, 6, 0)
      SetMouth("HERO_01", 0, 0, 0)
      SetMouth("HERO_01", 1, 0, 30)
      WaitFrame(32)
      CUT("04_B1")
      SetEnv_All("c04_B1", 0)
      SetCamera(-0.9, 2.35, -3.85, 0, 30, "LINEAR", 0, false, 0)
      SetCameraTarget(-0.268, 2.05, -4.7, "LINEAR", 0, false, 0)
      PlayMotionForce("Horo_AGENT", "e012_01", 5, true, 0)
      MessageTalk("m010_020_130")
      MessageTalk("m010_020_140")
      MessageClose()
      WaitFrame(10)
      EndMotion("Horo_AGENT", 0)
    elseif result == RESULT_TALK02 then
      SetFace("HERO_01", "E12_M06", 0, 1, 6, 0)
      SetMouth("HERO_01", 0, 0, 0)
      SetMouth("HERO_01", 1, 0, 35)
      WaitFrame(38)
      CUT("04_C1")
      SetEnv_All("c04_C1", 0)
      SetCamera(-0.9, 2.35, -3.85, 0, 30, "LINEAR", 0, false, 0)
      SetCameraTarget(-0.268, 2.05, -4.7, "LINEAR", 0, false, 0)
      PlayMotionBlend("Horo_AGENT", "blend02", 5, false, 0)
      MessageTalk("m010_020_150")
      MessageClose()
      WaitFrame(10)
      PlayMotion("Horo_AGENT", "e021_01", 5, false, 0)
      MessageTalk("m010_020_160")
      MessageTalk("m010_020_170")
      MessageTalk("m010_020_180")
      MessageClose()
      WaitFrame(10)
    end
  end
  CUT("5.0")
  SetEnv_All("c05", 0)
  SetCamera(-1.031, 2.082, -5.464, 0, 30, "LINEAR", 0, false, 0)
  SetCameraTarget(-0.272, 2.1, -4.417, "LINEAR", 0, false, 0)
  correct = false
  while not Vista.IsSkipping() and not correct do
    SetEnv_All("c05", 0)
    SetCamera(-1.031, 2.082, -5.464, 0, 30, "LINEAR", 0, false, 0)
    SetCameraTarget(-0.272, 2.1, -4.417, "LINEAR", 0, false, 0)
    SetFace("HERO_01", "F15", 0, 1, 3, 0)
    MessageTalkSel(3, "m010_020_190")
    result = Talk.GetResultSelectedNum()
    if result == RESULT_TALK00 then
      PlayMotionBlend("HERO_01", "blend01", 0, false, 0)
      SetMouth("HERO_01", 0, 0, 0)
      SetMouth("HERO_01", 1, 0, 30)
      WaitFrame(32)
      CUT("05_A1")
      SetEnv_All("c05_A1", 0)
      SetCamera(-0.9, 2.35, -3.85, 0, 30, "LINEAR", 0, false, 0)
      SetCameraTarget(-0.268, 2.05, -4.7, "LINEAR", 0, false, 0)
      PlayMotionForce("Horo_AGENT", "e023", 5, false, 0)
      EndMotion("Horo_AGENT", 100)
      MessageTalk("m010_020_200")
      MessageClose()
      WaitFrame(10)
      MessageTalk("m010_020_210")
      MessageClose()
      WaitFrame(10)
      PlayMotionBlend("Horo_AGENT", "blend01", 5, false, 0)
      MessageTalk("m010_020_220")
      Event_StopBGM(3, 0)
      MessageClose()
      WaitFrame(20)
      correct = true
    elseif result == RESULT_TALK01 then
      SetFace("HERO_01", "E12_M06", 0, 1, 6, 0)
      SetMouth("HERO_01", 0, 0, 0)
      SetMouth("HERO_01", 1, 0, 30)
      WaitFrame(32)
      CUT("05_B1")
      SetEnv_All("c05_B1", 0)
      SetCamera(-0.9, 2.35, -3.85, 0, 30, "LINEAR", 0, false, 0)
      SetCameraTarget(-0.268, 2.05, -4.7, "LINEAR", 0, false, 0)
      MessageTalk("m010_020_230")
      EndMotion("Horo_AGENT", 0)
      MessageClose()
      WaitFrame(10)
      PlayMotion("Horo_AGENT", "e002", 5, true, 15)
      MessageTalk("m010_020_240")
      MessageClose()
      WaitFrame(10)
    elseif result == RESULT_TALK02 then
      SetFace("HERO_01", "E12_M06", 0, 1, 6, 0)
      SetMouth("HERO_01", 0, 0, 0)
      SetMouth("HERO_01", 1, 0, 30)
      WaitFrame(32)
      CUT("05_C1")
      SetEnv_All("c05_C1", 0)
      SetCamera(-0.9, 2.35, -3.85, 0, 30, "LINEAR", 0, false, 0)
      SetCameraTarget(-0.268, 2.05, -4.7, "LINEAR", 0, false, 0)
      PlayMotionForce("Horo_AGENT", "e023", 5, true, 0)
      EndMotion("Horo_AGENT", 100)
      MessageTalk("m010_020_250")
      MessageClose()
      WaitFrame(10)
      MessageTalk("m010_020_260")
      MessageClose()
      WaitFrame(10)
    end
  end
  CUT("6.0")
  SetEnv_All("c06", 60)
  SetCamera(0.017, 1.521, -2.585, 0, 60, "LINEAR", 0, false, 60)
  SetCameraTarget(-1.504, 4.07, -12.134, "LINEAR", 0, false, 60)
  Close_DigiviceHologram()
  SetFace("HERO_01", "F01", 0, 1, 0, 0)
  BlendEye("HERO_01", 0, 0, "SCURVE", 10, 0)
  Event_StopBGM(1.5, 0)
  WaitFrame(60)
  if Debug.IsEventView() then
    Event_StopAllSE(0, 0)
    EVENT_END()
  else
    EVENT_END_SEAMLESS(60)
  end
end

function CUT(cut_no)
  CUT_START(cut_no)
end

function main()
  m010_020()
end
