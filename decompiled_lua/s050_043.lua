S050_043 = {
  ID = 43,
  STEP_001 = 1,
  STEP_004 = 4,
  STEP_005 = 5,
  STEP_010 = 10,
  STEP_015 = 15,
  STEP_020 = 20,
  STEP_025 = 25,
  STEP_255 = 255
}
local base = "s050_043_"
local text_file = "s050_043"

function S050_043:Event_010()
  if Qst.Sub:Check(self.ID, self.STEP_001, self.STEP_005) and Qst.Main:IsCompleted(M150.ID) and Qst.Sub:IsCompleted(42) and not Qst.Sub:Check(self.ID, self.STEP_255) then
    local tlk = Tlk:new(text_file, 1, true)
    local bear_o_index = GetIndex(NPC, "npc_0034")
    local bear_y_index = GetIndex(NPC, "npc_0035")
    local solar_index = GetIndex(NPC, "npc_0036")
    Field.ObjectLoadMotion(NPC, solar_index, "bn01")
    Field.ObjectLoadMotion(NPC, solar_index, "bn02")
    Field.ObjectLoadMotion(NPC, solar_index, "br01")
    Field.ObjectLoadMotion(NPC, solar_index, "fq01")
    Field.ObjectLoadMotion(NPC, solar_index, "fq02")
    Field.ObjectLoadMotion(NPC, solar_index, "fe02")
    Field.ObjectLoadMotion(NPC, solar_index, "fe04")
    Field.ObjectLoadMotion(NPC, bear_o_index, "e002")
    Field.ObjectLoadMotion(NPC, bear_o_index, "e004")
    Field.ObjectLoadMotion(NPC, bear_o_index, "e005")
    Field.ObjectLoadMotion(NPC, bear_o_index, "e006")
    Field.ObjectLoadMotion(NPC, bear_o_index, "e007")
    Field.ObjectLoadMotion(NPC, bear_o_index, "e008")
    Field.ObjectLoadMotion(NPC, bear_o_index, "bn01")
    Field.ObjectLoadMotion(NPC, bear_o_index, "bn02")
    Field.ObjectLoadMotion(NPC, bear_o_index, "fq01")
    Field.ObjectLoadMotion(NPC, bear_o_index, "fq02")
    Field.ObjectLoadMotion(NPC, bear_o_index, "fe04")
    Field.ObjectLoadMotion(NPC, bear_y_index, "e002")
    Field.ObjectLoadMotion(NPC, bear_y_index, "e004")
    Field.ObjectLoadMotion(NPC, bear_y_index, "e005")
    Field.ObjectLoadMotion(NPC, bear_y_index, "e006")
    Field.ObjectLoadMotion(NPC, bear_y_index, "e007")
    Field.ObjectLoadMotion(NPC, bear_y_index, "e008")
    Field.ObjectLoadMotion(NPC, bear_y_index, "bn01")
    Field.ObjectLoadMotion(NPC, bear_y_index, "bn02")
    Field.ObjectLoadMotion(NPC, bear_y_index, "fq01")
    Field.ObjectLoadMotion(NPC, bear_y_index, "fq02")
    Field.ObjectLoadMotion(NPC, bear_y_index, "fe04")
    Field.ObjectLoadMotion(PLAYER, 1, "e002")
    Field.ObjectLoadMotion(PLAYER, 1, "e004_01")
    Field.ObjectLoadMotion(PLAYER, 1, "e008")
    Field.ObjectLoadMotion(PLAYER, 1, "e012")
    Field.ObjectLoadMotion(PLAYER, 1, "e013")
    Field.ObjectLoadMotion(PLAYER, 1, "e015")
    Field.ObjectLoadMotion(PLAYER, 1, "e018")
    Field.ObjectLoadMotion(PLAYER, 1, "e019")
    if Qst.Sub:Check(self.ID, self.STEP_001, self.STEP_004) then
      Fade_OutNoLoadingWithWait(FADE_BLACK, FADE_TIME)
      Cam.Inst:Set(-53.084, 2.113875, 8.8151, -61.31, 3.628, 2.073, default, 0)
      Obj:new(PLAYER, ""):SetPos(-56.853, 1.997, 3.1767, true)
      Obj:new(PLAYER, ""):SetRotationY(180, 0)
      HideMinimap(true)
      HideGuide(true)
      tlk:StartTalkAndCancelDigimonRide()
      Field.ObjectPlayMotionWithStartMoveMotion(NPC, bear_y_index, "bn01", 10, 10)
      Field.ObjectPlayMotionWithStartMoveMotion(NPC, bear_o_index, "bn01", 10, 10)
      Field.ObjectPlayMotionWithStartMoveMotion(NPC, solar_index, "bn01", 10, 10)
      WaitFrame(10)
      FadeInWithWaitNotFlgCheck(FADE_BLACK, FADE_TIME)
      Field.ObjectPlayMotionWithStartMoveMotion(NPC, bear_o_index, "e002", 10, 10)
      tlk:Message(base .. "010")
      Field.ObjectPlayMotionWithStartMoveMotion(NPC, solar_index, "fe02", 10, 10)
      tlk:Message(base .. "020")
      Field.ObjectPlayMotionWithStartMoveMotion(NPC, bear_o_index, "fe04", 10, 10)
      tlk:Message(base .. "030")
      local result = tlk:Select(3, base .. "040")
      WaitFrame(15)
      local solar_pos = Field.ObjectGetPosition(NPC, solar_index)
      local player_pos = Field.ObjectGetPosition(PLAYER, 1)
      local y_degree = GetAngleToTarget2D(solar_pos.x, solar_pos.z, player_pos.x, player_pos.z)
      Field.ObjectSetRotationY(NPC, solar_index, y_degree, 15)
      Field.ObjectPlayMotion(NPC, solar_index, "br01", 10, true)
      WaitFrame(20)
      if result == RESULT_TALK00 then
        Field.ObjectPlayMotionWithStartMoveMotion(NPC, solar_index, "fq01", 10, 10)
        tlk:Message(base .. "050")
      elseif result == RESULT_TALK01 then
        Field.ObjectPlayMotionWithStartMoveMotion(NPC, solar_index, "fe04", 10, 10)
        tlk:Message(base .. "060")
      elseif result == RESULT_TALK02 then
        Field.ObjectPlayMotionWithStartMoveMotion(NPC, solar_index, "fe04", 10, 10)
        tlk:Message(base .. "070")
        tlk:EndTalk()
        HideMinimap(false)
        HideGuide(false)
        Cam.Inst:Clear(30)
        Qst.Sub:Set(self.ID, self.STEP_004)
        goto lbl_767
      end
    elseif Qst.Sub:Check(self.ID, self.STEP_004, self.STEP_005) then
      Fade_OutNoLoadingWithWait(FADE_BLACK, FADE_TIME)
      Cam.Inst:Set(-53.084, 2.113875, 8.8151, -61.31, 3.628, 2.073, default, 0)
      Obj:new(PLAYER, ""):SetPos(-56.853, 1.997, 3.1767, true)
      Obj:new(PLAYER, ""):SetRotationY(180, 0)
      HideMinimap(true)
      HideGuide(true)
      tlk:StartTalkAndCancelDigimonRide()
      Field.ObjectPlayMotionWithStartMoveMotion(NPC, bear_y_index, "bn01", 10, 10)
      Field.ObjectPlayMotionWithStartMoveMotion(NPC, bear_o_index, "bn01", 10, 10)
      Field.ObjectPlayMotionWithStartMoveMotion(NPC, solar_index, "bn01", 10, 10)
      WaitFrame(10)
      FadeInWithWaitNotFlgCheck(FADE_BLACK, FADE_TIME)
      Field.ObjectPlayMotionWithStartMoveMotion(NPC, bear_o_index, "e002", 10, 10)
      tlk:Message(base .. "870")
      local result = tlk:Select(2, base .. "880")
      WaitFrame(15)
      if result == RESULT_TALK00 then
        Field.ObjectPlayMotionWithStartMoveMotion(NPC, bear_o_index, "e004", 10, 10)
        tlk:Message(base .. "900")
      elseif result == RESULT_TALK01 then
        Field.ObjectPlayMotionWithStartMoveMotion(NPC, bear_o_index, "e007", 10, 10)
        tlk:Message(base .. "910")
        tlk:EndTalk()
        HideMinimap(false)
        HideGuide(false)
        Cam.Inst:Clear(30)
        goto lbl_767
      end
    end
    Field.ObjectPlayMotionWithStartMoveMotion(NPC, bear_o_index, "e002", 10, 10)
    tlk:Message(base .. "120")
    Field.ObjectPlayMotionWithStartMoveMotion(NPC, bear_o_index, "e004", 10, 10)
    tlk:Message(base .. "130")
    Field.ObjectPlayMotionWithStartMoveMotion(NPC, bear_o_index, "e007", 10, 10)
    tlk:Message(base .. "140")
    tlk:EndTalk(true)
    Qst.Sub:Start(self.ID, 1, false)
    Qst.Sub:Set(self.ID, self.STEP_004)
    Flg.Set("FLAG_SUB_S050_043_001")
    Flg.Set("FLAG_SUB_S050_043_007")
    Fade_OutNoLoadingWithWait(FADE_BLACK, FADE_TIME)
    FieldObjectSync(NPC, false)
    Cam.Inst:Clear(0)
    FadeInWithWaitNotFlgCheck(FADE_BLACK, FADE_TIME)
    HideMinimap(false)
    HideGuide(false)
    Qst.Sub:Set(self.ID, self.STEP_005)
    Field_CancelInvisibleFollowerAllGuest(0, 15, false, false)
    Field_CancelInvisibleFollowerAllPartyMember(0, 15, false, false)
  end
  ::lbl_767::
end

function S050_043:Event_015()
  if Qst.Sub:Check(self.ID, self.STEP_005, self.STEP_010) then
  end
end

function S050_043:Event_020()
  if Qst.Sub:Check(self.ID, self.STEP_005, self.STEP_010) then
    local bear_o_index = GetIndex(NPC, "npc_0200")
    local bear_y_index = GetIndex(NPC, "npc_0201")
    local solar_index = GetIndex(NPC, "npc_0202")
    Field.ObjectLoadMotion(NPC, solar_index, "bn01")
    Field.ObjectLoadMotion(NPC, solar_index, "bn02")
    Field.ObjectLoadMotion(NPC, solar_index, "fq01")
    Field.ObjectLoadMotion(NPC, solar_index, "fq02")
    Field.ObjectLoadMotion(NPC, solar_index, "fe02")
    Field.ObjectLoadMotion(NPC, solar_index, "fe04")
    Field.ObjectLoadMotion(NPC, bear_o_index, "e002")
    Field.ObjectLoadMotion(NPC, bear_o_index, "e004")
    Field.ObjectLoadMotion(NPC, bear_o_index, "e005")
    Field.ObjectLoadMotion(NPC, bear_o_index, "e006")
    Field.ObjectLoadMotion(NPC, bear_o_index, "e007")
    Field.ObjectLoadMotion(NPC, bear_o_index, "e008")
    Field.ObjectLoadMotion(NPC, bear_o_index, "bn01")
    Field.ObjectLoadMotion(NPC, bear_o_index, "bn02")
    Field.ObjectLoadMotion(NPC, bear_o_index, "fq01")
    Field.ObjectLoadMotion(NPC, bear_o_index, "fq02")
    Field.ObjectLoadMotion(NPC, bear_o_index, "fe04")
    Field.ObjectLoadMotion(NPC, bear_y_index, "e002")
    Field.ObjectLoadMotion(NPC, bear_y_index, "e004")
    Field.ObjectLoadMotion(NPC, bear_y_index, "e005")
    Field.ObjectLoadMotion(NPC, bear_y_index, "e006")
    Field.ObjectLoadMotion(NPC, bear_y_index, "e007")
    Field.ObjectLoadMotion(NPC, bear_y_index, "e008")
    Field.ObjectLoadMotion(NPC, bear_y_index, "bn01")
    Field.ObjectLoadMotion(NPC, bear_y_index, "bn02")
    Field.ObjectLoadMotion(NPC, bear_y_index, "fq01")
    Field.ObjectLoadMotion(NPC, bear_y_index, "fq02")
    Field.ObjectLoadMotion(NPC, bear_y_index, "fe04")
    Field.ObjectLoadMotion(PLAYER, 1, "e002")
    Field.ObjectLoadMotion(PLAYER, 1, "e004_01")
    Field.ObjectLoadMotion(PLAYER, 1, "e008")
    Field.ObjectLoadMotion(PLAYER, 1, "e012")
    Field.ObjectLoadMotion(PLAYER, 1, "e013")
    Field.ObjectLoadMotion(PLAYER, 1, "e015")
    Field.ObjectLoadMotion(PLAYER, 1, "e018")
    Field.ObjectLoadMotion(PLAYER, 1, "e019")
    local tlk = Tlk:new(text_file, 1, true)
    Field_InvisibleAllSymbolEnemy(INVISIBLE_KEY_EVENT, 15, true)
    HideMinimap(true)
    HideGuide(true)
    tlk:StartTalkAndCancelDigimonRide()
    Cam.Inst:Set(47.865, 8.835, -0.05, 38.03, 10.673, -0.315, default, 30)
    Field.ObjectFrameMoveToTarget2D(PLAYER, 1, 46.03, -0.73, 6, 30)
    WaitFrame(30)
    Field.ObjectPlayMotion(PLAYER, 1, "e018", 10, true)
    Field.ObjectSetRotationY(PLAYER, 1, 90, 15)
    Field.ObjectPlayMotionWithStartMoveMotion(NPC, bear_o_index, "e007", 10, 10)
    tlk:Message(base .. "150")
    Flg.Set("FLAG_SUB_S050_043_006")
    FieldObjectSync(NPC, false)
    SetControlScriptExternalVariable("platinum_state", "standby")
    Field.ObjectSuspendAutoTransparentForCamera(NPC, GetIndex(NPC, "s050_043_platinum"))
    Field.ObjectPlayMotionWithStartMoveMotion(NPC, bear_y_index, "fq02", 10, 10)
    tlk:Message(base .. "160")
    SetControlScriptExternalVariable("platinum_state", "move2")
    Field.ObjectPlayMotionWithStartMoveMotion(NPC, bear_o_index, "fe04", 10, 10)
    tlk:Message(base .. "170")
    Field.ObjectPlayMotionWithStartMoveMotion(NPC, solar_index, "fe04", 10, 10)
    tlk:Message(base .. "180")
    local result = tlk:Select(3, base .. "190")
    WaitFrame(15)
    if result == RESULT_TALK00 then
      Field.ObjectPlayMotionWithStartMoveMotion(NPC, bear_o_index, "e007", 10, 10)
      tlk:Message(base .. "200")
    end
    if result == RESULT_TALK01 then
      Field.ObjectPlayMotionWithStartMoveMotion(NPC, bear_o_index, "e007", 10, 10)
      tlk:Message(base .. "210")
    end
    if result == RESULT_TALK02 then
      Field.ObjectPlayMotionWithStartMoveMotion(NPC, bear_o_index, "e007", 10, 10)
      tlk:Message(base .. "220")
    end
    Field.ObjectPlayMotionWithStartMoveMotion(NPC, bear_o_index, "e008", 10, 10)
    tlk:Message(base .. "230")
    Field.ObjectPlayMotionWithStartMoveMotion(NPC, bear_o_index, "e007", 10, 10)
    tlk:Message(base .. "240")
    Field.ObjectPlayMotionWithStartMoveMotion(NPC, bear_y_index, "fq02", 10, 10)
    tlk:Message(base .. "250")
    tlk:EndTalk(true)
    Qst.Sub:Set(self.ID, self.STEP_010)
    EncountFromField_PlaySound(20500431, 10278, false)
  end
end

function S050_043:Event_030()
  if Qst.Sub:Check(self.ID, self.STEP_010, self.STEP_015) and not Flg.Check("FLAG_SUB_S050_043_002") then
    EncountFromField_PlaySound(20500431, 10278, false)
  end
end

function S050_043:Event_040()
  if Qst.Sub:Check(self.ID, self.STEP_010, self.STEP_015) and Flg.Check("FLAG_SUB_S050_043_002") then
    local bear_o_index = GetIndex(NPC, "npc_0200")
    local bear_y_index = GetIndex(NPC, "npc_0201")
    local solar_index = GetIndex(NPC, "npc_0202")
    local platinum_index = GetIndex(NPC, "s050_043_platinum")
    Field.ObjectLoadMotion(NPC, solar_index, "bn01")
    Field.ObjectLoadMotion(NPC, solar_index, "bn02")
    Field.ObjectLoadMotion(NPC, solar_index, "fq01")
    Field.ObjectLoadMotion(NPC, solar_index, "fq02")
    Field.ObjectLoadMotion(NPC, solar_index, "fe02")
    Field.ObjectLoadMotion(NPC, solar_index, "fe04")
    Field.ObjectLoadMotion(NPC, bear_o_index, "e002")
    Field.ObjectLoadMotion(NPC, bear_o_index, "e004")
    Field.ObjectLoadMotion(NPC, bear_o_index, "e005")
    Field.ObjectLoadMotion(NPC, bear_o_index, "e006")
    Field.ObjectLoadMotion(NPC, bear_o_index, "e007")
    Field.ObjectLoadMotion(NPC, bear_o_index, "e008")
    Field.ObjectLoadMotion(NPC, bear_o_index, "bn01")
    Field.ObjectLoadMotion(NPC, bear_o_index, "bn02")
    Field.ObjectLoadMotion(NPC, bear_o_index, "fq01")
    Field.ObjectLoadMotion(NPC, bear_o_index, "fq02")
    Field.ObjectLoadMotion(NPC, bear_o_index, "fe02")
    Field.ObjectLoadMotion(NPC, bear_o_index, "fe04")
    Field.ObjectLoadMotion(NPC, bear_y_index, "e002")
    Field.ObjectLoadMotion(NPC, bear_y_index, "e004")
    Field.ObjectLoadMotion(NPC, bear_y_index, "e005")
    Field.ObjectLoadMotion(NPC, bear_y_index, "e006")
    Field.ObjectLoadMotion(NPC, bear_y_index, "e007")
    Field.ObjectLoadMotion(NPC, bear_y_index, "e008")
    Field.ObjectLoadMotion(NPC, bear_y_index, "bn01")
    Field.ObjectLoadMotion(NPC, bear_y_index, "bn02")
    Field.ObjectLoadMotion(NPC, bear_y_index, "fq01")
    Field.ObjectLoadMotion(NPC, bear_y_index, "fq02")
    Field.ObjectLoadMotion(NPC, bear_y_index, "fe02")
    Field.ObjectLoadMotion(NPC, bear_y_index, "fe04")
    Field.ObjectLoadMotion(NPC, platinum_index, "bn01")
    Field.ObjectLoadMotion(NPC, platinum_index, "bn02")
    Field.ObjectLoadMotion(NPC, platinum_index, "fq01")
    Field.ObjectLoadMotion(NPC, platinum_index, "fq02")
    Field.ObjectLoadMotion(NPC, platinum_index, "fe02")
    Field.ObjectLoadMotion(NPC, platinum_index, "br01")
    Field.ObjectLoadMotion(PLAYER, 1, "e002")
    Field.ObjectLoadMotion(PLAYER, 1, "e004_01")
    Field.ObjectLoadMotion(PLAYER, 1, "e008")
    Field.ObjectLoadMotion(PLAYER, 1, "e012")
    Field.ObjectLoadMotion(PLAYER, 1, "e013")
    Field.ObjectLoadMotion(PLAYER, 1, "e015")
    Field.ObjectLoadMotion(PLAYER, 1, "e018")
    Field.ObjectLoadMotion(PLAYER, 1, "e019")
    local tlk = Tlk:new(text_file, 1, true)
    Obj:new(NPC, "s050_043_platinum"):SetPos(31.07, 8.08, -4.18)
    Obj:new(NPC, "s050_043_platinum"):SetRotationX(0, 0)
    Obj:new(NPC, "s050_043_platinum"):SetRotationZ(0, 0)
    SetControlScriptExternalVariable("platinum_state", "finish")
    Cam.Inst:Set(37.38, 8.235, -0.022, 27.39, 8.142, 0.131, default, 0)
    tlk:StartTalkAndCancelDigimonRide()
    FieldObjectSync(NPC, false)
    Field_InvisibleAllSymbolEnemy(INVISIBLE_KEY_EVENT, 0, false)
    WaitFrame(15)
    HideMinimap(true)
    HideGuide(true)
    Field.ObjectPlayMotion(PLAYER, 1, "fn01_01", 0, true)
    FadeAllInWithWait(FADE_BLACK, FADE_TIME)
    Field.ObjectPlayMotionWithStartMoveMotion(NPC, bear_o_index, "fe02", 10, 10)
    tlk:Message(base .. "260")
    Field.ObjectPlayMotionWithStartMoveMotion(NPC, bear_o_index, "e007", 10, 10)
    tlk:Message(base .. "270")
    Field.ObjectPlayMotionWithStartMoveMotion(NPC, bear_y_index, "fe02", 10, 10)
    tlk:Message(base .. "280")
    Field.ObjectPlayMotionWithStartMoveMotion(NPC, bear_o_index, "fe02", 10, 10)
    tlk:Message(base .. "290")
    Field.ObjectFrameMove2D(NPC, GetIndex(NPC, "s050_043_platinum"), 180, 2, 120)
    Field.ObjectPlayMotionWithStartMoveMotion(NPC, bear_o_index, "fq02", 10, 10)
    tlk:Message(base .. "300")
    Field.ObjectPlayMotionWithStartMoveMotion(NPC, solar_index, "fq02", 10, 10)
    tlk:Message(base .. "310")
    Field.ObjectPlayMotionWithStartMoveMotion(NPC, bear_o_index, "e005", 10, 10)
    tlk:Message(base .. "320")
    Field.ObjectPlayMotionWithStartMoveMotion(NPC, bear_o_index, "e007", 10, 10)
    tlk:Message(base .. "330")
    local result = tlk:Select(3, base .. "340")
    WaitFrame(15)
    if result == RESULT_TALK00 then
      Field.ObjectPlayMotionWithStartMoveMotion(NPC, bear_o_index, "e007", 10, 10)
      tlk:Message(base .. "350")
    end
    if result == RESULT_TALK01 then
      Field.ObjectPlayMotionWithStartMoveMotion(NPC, bear_o_index, "e002", 10, 10)
      tlk:Message(base .. "360")
    end
    if result == RESULT_TALK02 then
      Field.ObjectPlayMotionWithStartMoveMotion(NPC, bear_o_index, "e002", 10, 10)
      tlk:Message(base .. "370")
    end
    Field.ObjectFrameMove2D(NPC, GetIndex(NPC, "s050_043_platinum"), 0, 2, 30)
    WaitFrame(30)
    Obj:new(NPC, "s050_043_platinum"):SetRotationY(90, 30)
    Field.ObjectPlayMotionWithStartMoveMotion(NPC, platinum_index, "br01", 10, 10)
    Field.ObjectPlayMotionWithStartMoveMotion(NPC, bear_o_index, "e005", 10, 10)
    tlk:Message(base .. "380")
    Field.ObjectPlayMotionWithStartMoveMotion(NPC, bear_y_index, "fq02", 10, 10)
    tlk:Message(base .. "390")
    Field.ObjectPlayMotionWithStartMoveMotion(NPC, bear_o_index, "e007", 10, 10)
    tlk:Message(base .. "400")
    Field.ObjectPlayMotionWithStartMoveMotion(NPC, bear_o_index, "e002", 10, 10)
    tlk:Message(base .. "410")
    Field.ObjectPlayMotionWithStartMoveMotion(NPC, bear_o_index, "e007", 10, 10)
    tlk:Message(base .. "420")
    Field.ObjectFrameMove2D(NPC, GetIndex(NPC, "s050_043_platinum"), 180, 2, 150)
    Field.ObjectPlayMotionWithStartMoveMotion(NPC, solar_index, "fe04", 10, 10)
    tlk:Message(base .. "430")
    Field.ObjectFrameMove2D(NPC, GetIndex(NPC, "s050_043_platinum"), 180, 2, 200)
    Field.ObjectPlayMotionWithStartMoveMotion(NPC, bear_o_index, "e005", 10, 10)
    tlk:Message(base .. "440")
    tlk:EndTalk(true)
    Flg.Set("FLAG_SUB_S050_043_003")
    Qst.Sub:Set(self.ID, self.STEP_015)
    Flg.Clear("FLAG_SUB_S050_043_007")
    MapChange("d", 202, "start_06", true, FADE_BLACK, FADE_TIME)
  end
end

function S050_043:Event_050()
  if Qst.Sub:Check(self.ID, self.STEP_015, self.STEP_020) then
    local tlk = Tlk:new(text_file, 1, true)
    HideMinimap(true)
    HideGuide(true)
    tlk:StartTalkAndCancelDigimonRide()
    tlk:Message(base .. "450")
    local result = tlk:Select(3, base .. "460")
    WaitFrame(15)
    if result == RESULT_TALK00 then
      tlk:Message(base .. "470")
    end
    if result == RESULT_TALK01 then
      tlk:Message(base .. "480")
    end
    if result == RESULT_TALK02 then
      tlk:Message(base .. "490")
      tlk:EndTalk()
      HideMinimap(false)
      HideGuide(false)
    else
      tlk:Message(base .. "500")
      tlk:Message(base .. "510")
      tlk:Message(base .. "520")
      tlk:EndTalk(true)
      HideMinimap(false)
      HideGuide(false)
      Flg.Set("FLAG_SUB_S050_043_004")
      Qst.Sub:Set(self.ID, self.STEP_020)
      WaitFrame(20)
      MapChange("d", 217, "start_00", true, FADE_BLACK, FADE_TIME)
    end
  elseif Qst.Sub:Check(self.ID, self.STEP_020, self.STEP_255) then
    local tlk = Tlk:new(text_file, 1, true)
    tlk:StartTalkAndCancelDigimonRide()
    tlk:Message(base .. "520")
    tlk:EndTalk()
  end
end

function S050_043:Event_055()
  local tlk = Tlk:new(text_file, 1, true)
  tlk:StartTalkAndCancelDigimonRide()
  tlk:Message(base .. "530")
  tlk:EndTalk()
end

function S050_043:Event_056()
  local tlk = Tlk:new(text_file, 1, true)
  tlk:StartTalkAndCancelDigimonRide()
  tlk:Message(base .. "540")
  tlk:EndTalk()
end

function S050_043:Event_057()
  if Qst.Sub:Check(self.ID, self.STEP_020, self.STEP_255) and not Flg.Check("FLAG_SUB_050_043_007") then
    Flg.Set("FLAG_SUB_050_043_007")
    FieldObjectSync(ENEMY, true)
  end
end

function S050_043:Event_059()
  if Qst.Sub:Check(self.ID, self.STEP_015, self.STEP_025) then
    local tlk = Tlk:new(text_file, 1, true)
    local bear_o_index = GetIndex(NPC, "npc_0034")
    Field.ObjectLoadMotion(NPC, bear_o_index, "e002")
    Field.ObjectLoadMotion(NPC, bear_o_index, "e004")
    Field.ObjectLoadMotion(NPC, bear_o_index, "e005")
    Field.ObjectLoadMotion(NPC, bear_o_index, "e006")
    Field.ObjectLoadMotion(NPC, bear_o_index, "e007")
    Field.ObjectLoadMotion(NPC, bear_o_index, "e008")
    Field.ObjectLoadMotion(NPC, bear_o_index, "bn01")
    Field.ObjectLoadMotion(NPC, bear_o_index, "bn02")
    Field.ObjectLoadMotion(NPC, bear_o_index, "fq01")
    Field.ObjectLoadMotion(NPC, bear_o_index, "fq02")
    Field.ObjectLoadMotion(NPC, bear_o_index, "fe02")
    Field.ObjectLoadMotion(NPC, bear_o_index, "fe04")
    tlk:StartTalkAndCancelDigimonRide()
    Field.ObjectPlayMotionWithStartMoveMotion(NPC, bear_o_index, "e007", 10, 10)
    tlk:Message(base .. "550")
    Field.ObjectPlayMotionWithStartMoveMotion(NPC, bear_o_index, "e002", 10, 10)
    tlk:Message(base .. "560")
    tlk:EndTalk()
  end
end

function S050_043:Event_060()
  if Qst.Sub:Check(self.ID, self.STEP_015, self.STEP_255) then
    local tlk = Tlk:new(text_file, 1, true)
    local bear_o_index = GetIndex(NPC, "npc_0034")
    local bear_y_index = GetIndex(NPC, "npc_0035")
    local solar_index = GetIndex(NPC, "npc_0036")
    Field.ObjectLoadMotion(NPC, solar_index, "bn01")
    Field.ObjectLoadMotion(NPC, solar_index, "bn02")
    Field.ObjectLoadMotion(NPC, solar_index, "fq01")
    Field.ObjectLoadMotion(NPC, solar_index, "fq02")
    Field.ObjectLoadMotion(NPC, solar_index, "fe02")
    Field.ObjectLoadMotion(NPC, solar_index, "fe04")
    Field.ObjectLoadMotion(NPC, bear_o_index, "e002")
    Field.ObjectLoadMotion(NPC, bear_o_index, "e004")
    Field.ObjectLoadMotion(NPC, bear_o_index, "e005")
    Field.ObjectLoadMotion(NPC, bear_o_index, "e006")
    Field.ObjectLoadMotion(NPC, bear_o_index, "e007")
    Field.ObjectLoadMotion(NPC, bear_o_index, "e008")
    Field.ObjectLoadMotion(NPC, bear_o_index, "bn01")
    Field.ObjectLoadMotion(NPC, bear_o_index, "bn02")
    Field.ObjectLoadMotion(NPC, bear_o_index, "fq01")
    Field.ObjectLoadMotion(NPC, bear_o_index, "fq02")
    Field.ObjectLoadMotion(NPC, bear_o_index, "fe02")
    Field.ObjectLoadMotion(NPC, bear_o_index, "fe04")
    Field.ObjectLoadMotion(NPC, bear_y_index, "e002")
    Field.ObjectLoadMotion(NPC, bear_y_index, "e004")
    Field.ObjectLoadMotion(NPC, bear_y_index, "e005")
    Field.ObjectLoadMotion(NPC, bear_y_index, "e006")
    Field.ObjectLoadMotion(NPC, bear_y_index, "e007")
    Field.ObjectLoadMotion(NPC, bear_y_index, "e008")
    Field.ObjectLoadMotion(NPC, bear_y_index, "bn01")
    Field.ObjectLoadMotion(NPC, bear_y_index, "bn02")
    Field.ObjectLoadMotion(NPC, bear_y_index, "fq01")
    Field.ObjectLoadMotion(NPC, bear_y_index, "fq02")
    Field.ObjectLoadMotion(NPC, bear_y_index, "fe02")
    Field.ObjectLoadMotion(NPC, bear_y_index, "fe04")
    Field.ObjectLoadMotion(PLAYER, 1, "e002")
    Field.ObjectLoadMotion(PLAYER, 1, "e004_01")
    Field.ObjectLoadMotion(PLAYER, 1, "e008")
    Field.ObjectLoadMotion(PLAYER, 1, "e012")
    Field.ObjectLoadMotion(PLAYER, 1, "e013")
    Field.ObjectLoadMotion(PLAYER, 1, "e015")
    Field.ObjectLoadMotion(PLAYER, 1, "e018")
    Field.ObjectLoadMotion(PLAYER, 1, "e019")
    Cam.Inst:Set(-60.25, 1.547, 9.31, -54.88, 3.675, 1.145, default, 0)
    local bear_o_pos = Field.ObjectGetPosition(NPC, bear_o_index)
    local bear_y_pos = Field.ObjectGetPosition(NPC, bear_y_index)
    local solar_pos = Field.ObjectGetPosition(NPC, solar_index)
    local player_pos = Field.ObjectGetPosition(PLAYER, 1)
    local y_degree_o = GetAngleToTarget2D(bear_o_pos.x, bear_o_pos.z, player_pos.x, player_pos.z)
    local y_degree_y = GetAngleToTarget2D(bear_y_pos.x, bear_y_pos.z, player_pos.x, player_pos.z)
    local y_degree_s = GetAngleToTarget2D(solar_pos.x, solar_pos.z, player_pos.x, player_pos.z)
    Field.ObjectSetRotationY(NPC, bear_o_index, y_degree_o, 0)
    Field.ObjectSetRotationY(NPC, solar_index, y_degree_s, 0)
    Field.ObjectSetRotationY(NPC, bear_y_index, y_degree_y, 0)
    Field.ObjectPlayMotionWithStartMoveMotion(NPC, bear_y_index, "bn01", 10, 10)
    Field.ObjectPlayMotionWithStartMoveMotion(NPC, solar_index, "bn01", 10, 10)
    HideMinimap(true)
    HideGuide(true)
    tlk:StartTalkAndCancelDigimonRide()
    WaitFrame(10)
    FadeAllInWithWait(FADE_BLACK, FADE_TIME)
    Field.ObjectPlayMotionWithStartMoveMotion(NPC, bear_o_index, "e007", 10, 10)
    tlk:Message(base .. "550")
    Field.ObjectPlayMotionWithStartMoveMotion(NPC, bear_o_index, "e002", 10, 10)
    tlk:Message(base .. "560")
    if Qst.Sub:Check(self.ID, self.STEP_025, self.STEP_255) and 1 <= Item.GetNum(767) then
      do
        local result = tlk:Select(3, base .. "570")
        WaitFrame(15)
        Field.ObjectPlayMotionWithStartMoveMotion(NPC, bear_o_index, "e007", 10, 10)
        if result == RESULT_TALK00 then
          tlk:Message(base .. "580")
        end
        if result == RESULT_TALK01 then
          tlk:Message(base .. "590")
        end
        if result == RESULT_TALK02 then
          tlk:Message(base .. "600")
        end
        Field.ObjectPlayMotionWithStartMoveMotion(NPC, bear_o_index, "bn01", 10, 10)
        tlk:Message(base .. "610")
        Field.ObjectPlayMotionWithStartMoveMotion(NPC, solar_index, "fe04", 10, 10)
        tlk:Message(base .. "620")
        Field.ObjectPlayMotionWithStartMoveMotion(NPC, bear_y_index, "e004", 10, 10)
        tlk:Message(base .. "630")
        Field.ObjectPlayMotionWithStartMoveMotion(NPC, bear_o_index, "fe02", 10, 10)
        tlk:Message(base .. "640")
        result = tlk:Select(3, base .. "650")
        WaitFrame(15)
        Field.ObjectPlayMotionWithStartMoveMotion(NPC, bear_o_index, "e007", 10, 10)
        if result == RESULT_TALK00 then
          tlk:Message(base .. "660")
        elseif result == RESULT_TALK01 then
          tlk:Message(base .. "670")
        elseif result == RESULT_TALK02 then
          tlk:Message(base .. "680")
        end
        Field.ObjectPlayMotionWithStartMoveMotion(NPC, bear_o_index, "e002", 10, 10)
        tlk:Message(base .. "690")
        Field.ObjectPlayMotionWithStartMoveMotion(NPC, bear_o_index, "e007", 10, 10)
        tlk:Message(base .. "700")
        Field.ObjectPlayMotionWithStartMoveMotion(NPC, bear_o_index, "e004", 10, 10)
        tlk:Message(base .. "710")
        Field.ObjectPlayMotionWithStartMoveMotion(NPC, bear_y_index, "e007", 10, 10)
        tlk:Message(base .. "720")
        Field.ObjectPlayMotionWithStartMoveMotion(NPC, bear_o_index, "e002", 10, 10)
        tlk:Message(base .. "730")
        result = tlk:Select(2, base .. "740")
        WaitFrame(15)
        if result == RESULT_TALK00 then
          Field.ObjectPlayMotionWithStartMoveMotion(NPC, bear_o_index, "fq01", 10, 10)
          tlk:Message(base .. "750")
          INFO_GET_ITEM(31021, 1)
        end
        if result == RESULT_TALK01 then
          Field.ObjectPlayMotionWithStartMoveMotion(NPC, bear_o_index, "e004", 10, 10)
          tlk:Message(base .. "760")
          Field.ObjectPlayMotionWithStartMoveMotion(NPC, bear_o_index, "e007", 10, 10)
          tlk:Message(base .. "770")
          Field.ObjectPlayMotionWithStartMoveMotion(NPC, bear_o_index, "fe02", 10, 10)
          tlk:Message(base .. "780")
        end
        Item.Delete(767, 1)
        Field.ObjectPlayMotionWithStartMoveMotion(NPC, bear_o_index, "fe04", 10, 10)
        tlk:Message(base .. "790")
        Field.ObjectPlayMotionWithStartMoveMotion(NPC, bear_y_index, "fq01", 10, 10)
        tlk:Message(base .. "800")
        Field.ObjectPlayMotionWithStartMoveMotion(NPC, bear_o_index, "e007", 10, 10)
        tlk:Message(base .. "810")
        Field.ObjectPlayMotionWithStartMoveMotion(NPC, bear_y_index, "fe02", 10, 10)
        tlk:Message(base .. "820")
        Field.ObjectPlayMotionWithStartMoveMotion(NPC, bear_y_index, "e002", 10, 10)
        tlk:Message(base .. "830")
        tlk:EndTalk(true)
        Flg.Set("FLAG_IS_CLEAR_S050_043")
        Fade_OutNoLoadingWithWait(FADE_BLACK, FADE_TIME)
        FieldObjectSync(NPC, true)
        WaitFrame(25)
        FadeAllInWithWait(FADE_BLACK, FADE_TIME)
        WaitFrame(30)
        HideMinimap(false)
        HideGuide(false)
        Cam.Inst:Clear(30)
        Qst.Sub:End(self.ID, self.STEP_255)
        Field_CancelInvisibleFollowerAllGuest(0, 15, false, false)
        Field_CancelInvisibleFollowerAllPartyMember(0, 15, false, false)
      end
    else
      Cam.Inst:Clear(30)
      tlk:EndTalk()
    end
  end
end

function S050_043:Event_070()
  if Qst.Sub:Check(self.ID, self.STEP_020, self.STEP_025) and Flg.Check("FLAG_SUB_S050_043_005") then
    FadeAllInWithWait(FADE_BLACK, FADE_TIME)
    INFO_GET_ITEM(767, 1)
    Qst.Sub:Set(self.ID, self.STEP_025)
    WaitFrame(75)
    Flg.Set("FLAG_SKIP_AREACHANGE_MOVE")
    MapChange("d", 202, "start_30", true, FADE_BLACK, FADE_TIME)
  end
end

function S050_043:Event_073()
  if Qst.Sub:Check(self.ID, self.STEP_020, self.STEP_025) then
    INFO_GET_ITEM(767, 1)
    Qst.Sub:Set(self.ID, self.STEP_025)
    WaitFrame(75)
    Flg.Set("FLAG_SKIP_AREACHANGE_MOVE")
    MapChange("d", 202, "start_30", true, FADE_BLACK, FADE_TIME)
  end
end

function S050_043:Event_075()
  if Qst.Sub:IsCompleted(self.ID) then
    local clock_index = GetIndex(NPC, "s050_043_clock")
    local tlk = Tlk:new(text_file, 1, true)
    Field.ObjectLoadMotion(NPC, clock_index, "bn01")
    Field.ObjectLoadMotion(NPC, clock_index, "bn02")
    Field.ObjectLoadMotion(NPC, clock_index, "fq01")
    Field.ObjectLoadMotion(NPC, clock_index, "fq02")
    Field.ObjectLoadMotion(NPC, clock_index, "fe02")
    Field.ObjectLoadMotion(NPC, clock_index, "fe04")
    tlk:StartTalkAndCancelDigimonRide()
    Field.ObjectPlayMotionWithStartMoveMotion(NPC, clock_index, "fe04", 10, 10)
    tlk:Message(base .. "840")
    Field.ObjectPlayMotionWithStartMoveMotion(NPC, clock_index, "fq01", 10, 10)
    tlk:Message(base .. "850")
    tlk:Message(base .. "860")
    tlk:EndTalk()
  end
end
