require("include")

function m340_041()
  Fade_Out(0, 0)
  EVENT_BEGIN()
  EventRankSet("S")
  Talk.Load("m340")
  SetEventCutNo("1.0")
  if Debug.IsEventView() then
  end
  local Movie_m = MOVIE.new("movie_m", "m340_041_m")
  local Movie_f = MOVIE.new("movie_f", "m340_041_f")
  WaitVistaLoad()
  Event_PlayBGM(206, 0, 0)
  Event_PlaySE(420004, 100, false, 0, 0)
  FIELD_SET()
  EVENT_START()
  CUT("1.0")
  Fade_In(0, FADE_TIME)
  CtrVibration(0, 0.7, 20, 26)
  CtrVibration(0, 0, 0, 46)
  CtrVibration(0, 0.7, 10, 81)
  CtrVibration(0, 0, 0, 91)
  CtrVibration(0, 0.7, 63, 134)
  CtrVibration(0, 0, 0, 197)
  CtrVibration(0.7, 0, 5, 163)
  CtrVibration(0, 0, 0, 139)
  CtrVibration(0, 0.5, 214, 202)
  CtrVibration(0, 0, 0, 416)
  CtrVibration(0, 0.5, 121, 420)
  CtrVibration(0, 0, 0, 541)
  CtrVibration(0.3, 0, 70, 609)
  CtrVibration(0, 0, 0, 679)
  CtrVibration(0.3, 0, 33, 1060)
  CtrVibration(0, 0, 0, 1093)
  CtrVibration(0, 0.5, 88, 1264)
  CtrVibration(0, 0, 0, 1352)
  CtrVibration(0.5, 0, 42, 1353)
  CtrVibration(0, 0, 0, 1395)
  CtrVibration(0, 0.3, 54, 1594)
  CtrVibration(0, 0, 0, 1648)
  CtrVibration(0.3, 0.3, 35, 1649)
  CtrVibration(0, 0, 0, 1684)
  CtrVibration(0.3, 0.7, 32, 1685)
  CtrVibration(0, 0, 0, 1717)
  CtrVibration(0.3, 0.3, 32, 1718)
  CtrVibration(0, 0, 0, 1750)
  CtrVibration(0.7, 0, 19, 1751)
  CtrVibration(0, 0, 0, 1770)
  CtrVibration(0.7, 0, 11, 1782)
  CtrVibration(0, 0, 0, 1793)
  CtrVibration(0.7, 0, 5, 1848)
  CtrVibration(0, 0, 0, 1853)
  CtrVibration(0.7, 0, 20, 1873)
  CtrVibration(0, 0, 0, 1893)
  CtrVibration(0.7, 0, 39, 1901)
  CtrVibration(0, 0, 0, 1940)
  CtrVibration(0.3, 0, 40, 1988)
  CtrVibration(0, 0, 0, 2028)
  local gender = GetGender()
  if gender == HERO then
    Event_PlayVoice("m340_041_002", 541)
    Vista.SetMessageTalkAuto("m340_041_001", -1, true, 553)
    Event_StopBGM(2, 22)
    Event_PlayBGM(308, 2, 24)
    Event_PlayVoice("m340_041_003", 631)
    Event_PlayVoice("m340_041_004", 805)
    Vista.SetMessageTalkAuto("m340_041_005", -1, true, 863)
    Vista.SetMessageTalkAuto("m340_041_006", -1, true, 931)
    Vista.SetMessageTalkAuto("m340_041_007", -1, true, 976)
    Vista.SetMessageTalkAuto("m340_041_010", -1, true, 1051)
    Event_PlayVoice("m340_041_011", 1188)
    Event_PlayVoice("m340_041_015", 1259)
    Vista.SetMessageTalkAuto("m340_041_020", -1, true, 1259)
    Event_PlayVoice("m340_041_025", 1461)
    Event_PlayVoice("m340_041_021", 1591)
    Event_StopBGM(1, 35)
    Vista.SetMessageTalkAuto("m340_041_030", -1, true, 1661)
    Event_PlayVoice("m340_041_035", 1833)
    Movie_m:PLAY(1984)
  elseif gender == HEROINE then
    Vista.SetMessageTalkAuto("m340_041_001", -1, true, 553)
    Event_StopBGM(2, 22)
    Event_PlayBGM(308, 2, 24)
    Event_PlayVoice("m340_041_003", 631)
    Event_PlayVoice("m340_041_004", 805)
    Vista.SetMessageTalkAuto("m340_041_005", -1, true, 863)
    Vista.SetMessageTalkAuto("m340_041_006", -1, true, 931)
    Vista.SetMessageTalkAuto("m340_041_007", -1, true, 976)
    Vista.SetMessageTalkAuto("m340_041_010", -1, true, 1051)
    Event_PlayVoice("m340_041_011", 1188)
    Event_PlayVoice("m340_041_015", 1259)
    Vista.SetMessageTalkAuto("m340_041_020", -1, true, 1259)
    Event_PlayVoice("m340_041_025", 1461)
    Event_PlayVoice("m340_041_021", 1591)
    Event_StopBGM(1, 35)
    Vista.SetMessageTalkAuto("m340_041_030", -1, true, 1661)
    Event_PlayVoice("m340_041_035", 1833)
    Movie_f:PLAY(1984)
  end
  Fade_OutNoLoadingWithWait(1, 46)
  WaitFrame(30)
  if Debug.IsEventView() then
    Event_StopBGM(0, 0)
    Event_StopAllSE(0, 0)
  end
  Vista.SetKeepBGM()
  EVENT_END(1)
end

function CUT(cut_no)
  CUT_START(cut_no)
end

function main()
  m340_041()
end
