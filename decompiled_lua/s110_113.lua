S110_113 = {
  ID = 113,
  STEP_001 = 1,
  STEP_005 = 5,
  STEP_255 = 255,
  Flg01 = "FLAG_SUB_110_113_001",
  Flg02 = "FLAG_SUB_110_113_002",
  Flg03 = "FLAG_SUB_110_113_003",
  Flg04 = "FLAG_SUB_110_113_004"
}
local text_file = "s110_113"
local base = text_file .. "_"

function S110_113:Event_010()
  if Qst.Sub:IsCompleted(111) and not Qst.Sub:IsCompleted(self.ID) then
    if Guest.IsExistNum(2) then
      INFO_WINDOW(10050)
      goto lbl_415
    elseif Qst.Sub:Check(self.ID, self.STEP_001, self.STEP_005) then
      local g_fq01 = Motion.Object:new(NPC, "s110_113_001", "fq01")
      local g_fq02 = Motion.Object:new(NPC, "s110_113_001", "fq02")
      local g_fe02 = Motion.Object:new(NPC, "s110_113_001", "fe02")
      local g_fe03 = Motion.Object:new(NPC, "s110_113_001", "fe03")
      local g_fe04 = Motion.Object:new(NPC, "s110_113_001", "fe04")
      local g_bn01 = Motion.Object:new(NPC, "s110_113_001", "bn01")
      local j_fq02 = Motion.Object:new(NPC, "s110_113_002", "fq02")
      local j_bn01 = Motion.Object:new(NPC, "s110_113_002", "bn01")
      local p_e002 = Motion.Object:new(PLAYER, "", "e002")
      local p_e004 = Motion.Object:new(PLAYER, "", "e004")
      local p_e012 = Motion.Object:new(PLAYER, "", "e012")
      local p_fn01_01 = Motion.Object:new(PLAYER, "", "fn01_01")
      local npc01_index = GetIndex(NPC, "s110_113_001")
      local npc02_index = GetIndex(NPC, "s110_113_002")
      HideMinimap(true)
      HideGuide(true)
      local tlk = Tlk:new(text_file, 1, true)
      Fade_OutNoLoadingWithWait(FADE_BLACK, FADE_TIME)
      Obj:new(PLAYER, ""):SetPos(24.165, 0, 39.793, true)
      Obj:new(PLAYER, ""):SetRotationY(180, 0)
      tlk:StartTalkAndCancelDigimonRide()
      Cam.Inst:Set(25.373, 2.449, 45.717, 22.514, 1.044, 36.238, default, 0)
      WaitFrame(5)
      FadeAllInWithWait(FADE_BLACK, FADE_TIME)
      Field.ObjectLookAtTheObject(PLAYER, 1, NPC, npc01_index, 15, 10)
      WaitFrame(15)
      g_fe02:PlayWithStartMoveMotion(10, 10)
      tlk:Message(base .. "010")
      j_fq02:PlayWithStartMoveMotion(10, 10)
      tlk:Message(base .. "020")
      g_fq01:PlayWithStartMoveMotion(10, 10)
      tlk:Message(base .. "030")
      local result = tlk:Select(3, base .. "040")
      WaitFrame(30)
      if result == RESULT_TALK00 then
        g_fq01:PlayWithStartMoveMotion(10, 10)
        tlk:Message(base .. "050")
      elseif result == RESULT_TALK01 then
        g_fq02:PlayWithStartMoveMotion(10, 10)
        tlk:Message(base .. "060")
      elseif result == RESULT_TALK02 then
        g_fq02:PlayWithStartMoveMotion(10, 10)
        tlk:Message(base .. "070")
      end
      g_fe02:PlayWithStartMoveMotion(10, 10)
      tlk:Message(base .. "080")
      g_fe04:PlayWithStartMoveMotion(10, 10)
      tlk:Message(base .. "090")
      g_fq01:PlayWithStartMoveMotion(10, 10)
      tlk:Message(base .. "100")
      result = tlk:Select(3, base .. "110")
      WaitFrame(30)
      if result == RESULT_TALK00 then
        g_fe04:PlayWithStartMoveMotion(10, 10)
        tlk:Message(base .. "140")
      elseif result == RESULT_TALK01 then
        g_fq02:PlayWithStartMoveMotion(10, 10)
        tlk:Message(base .. "150")
      elseif result == RESULT_TALK02 then
        g_fe02:PlayWithStartMoveMotion(10, 10)
        tlk:Message(base .. "160")
      end
      g_fq01:PlayWithStartMoveMotion(10, 10)
      tlk:Message(base .. "170")
      tlk:EndTalk()
      Field_InvisibleFollowerAllPartyMember(0, 0, false)
      Field_InvisibleFollowerAllGuest(0, 0, false)
      Qst.Sub:Start(self.ID, 1, false)
      Fade_OutNoLoadingWithWait(FADE_BLACK, FADE_TIME)
      PlaySE(200006, 100)
      Qst.Sub:Set(self.ID, self.STEP_005)
      Flg.Set(self.Flg02)
      Guest.Add(GST_S010_156_GANKOO)
      Guest.Add(GST_S010_156_JES)
      Flg.Set("FLAG_SKIP_AREACHANGE_MOVE")
      Flg.Set("FLAG_IS_NOT_MAP_NAME_DISP")
      MapChange("d", 506, "start_00", false, FADE_BLACK, FADE_TIME)
    end
  end
  ::lbl_415::
end

function S110_113:Event_020()
  if Qst.Sub:Check(self.ID, self.STEP_005, self.STEP_255) then
    local angel_index = GetIndex(NPC, "s110_113_001")
    local devil_index = GetIndex(NPC, "s110_113_002")
    local maste_index = GetIndex(NPC, "s110_113_003")
    local gankoo_index = GetIndex(NPC, "s110_113_006")
    local zies_index = GetIndex(NPC, "s110_113_005")
    local o_index = GetIndex(NPC, "s110_113_004")
    local rd01_bn01 = Motion.Object:new(NPC, "s110_113_001", "bn01")
    local rd01_fe02 = Motion.Object:new(NPC, "s110_113_001", "fe02")
    local rd01_fq01 = Motion.Object:new(NPC, "s110_113_001", "fq01")
    local rd01_fq02 = Motion.Object:new(NPC, "s110_113_001", "fq02")
    local rd02_bn01 = Motion.Object:new(NPC, "s110_113_002", "bn01")
    local rd02_fe02 = Motion.Object:new(NPC, "s110_113_002", "fe02")
    local rd02_fq01 = Motion.Object:new(NPC, "s110_113_002", "fq01")
    local rd02_fq02 = Motion.Object:new(NPC, "s110_113_002", "fq02")
    local g_bn01 = Motion.Object:new(NPC, "s110_113_006", "bn01")
    local g_fq01 = Motion.Object:new(NPC, "s110_113_006", "fq01")
    local g_fq02 = Motion.Object:new(NPC, "s110_113_006", "fq02")
    local g_bn01 = Motion.Object:new(NPC, "s110_113_006", "bn01")
    local g_fe02 = Motion.Object:new(NPC, "s110_113_006", "fe02")
    local g_fe04 = Motion.Object:new(NPC, "s110_113_006", "fe04")
    local j_bn01 = Motion.Object:new(NPC, "s110_113_005", "bn01")
    local j_fq01 = Motion.Object:new(NPC, "s110_113_005", "fq01")
    local j_fq02 = Motion.Object:new(NPC, "s110_113_005", "fq02")
    local j_fe04 = Motion.Object:new(NPC, "s110_113_005", "fe04")
    local o_bn01 = Motion.Object:new(NPC, "s110_113_004", "fn01_01")
    local o_e002 = Motion.Object:new(NPC, "s110_113_004", "e002")
    local o_e004 = Motion.Object:new(NPC, "s110_113_004", "e004")
    local o_e052 = Motion.Object:new(NPC, "s110_113_004", "e052")
    local o_e058 = Motion.Object:new(NPC, "s110_113_004", "e058")
    local o_e503 = Motion.Object:new(NPC, "s110_113_004", "e503")
    local o_e014 = Motion.Object:new(NPC, "s110_113_004", "e014")
    local o_e015 = Motion.Object:new(NPC, "s110_113_004", "e015")
    local o_bn01 = Motion.Object:new(NPC, "s110_113_004", "bn01")
    local l_bn01 = Motion.Object:new(NPC, "s110_113_003", "bn01")
    local l_fq02 = Motion.Object:new(NPC, "s110_113_003", "fq02")
    local l_fq01 = Motion.Object:new(NPC, "s110_113_003", "fq01")
    local l_fe04 = Motion.Object:new(NPC, "s110_113_003", "fe04")
    local l_bn01 = Motion.Object:new(NPC, "s110_113_003", "bn01")
    local p_e004 = Motion.Object:new(PLAYER, "", "e008")
    local p_e008 = Motion.Object:new(PLAYER, "", "e008")
    local p_e012 = Motion.Object:new(PLAYER, "", "e012")
    local p_e018 = Motion.Object:new(PLAYER, "", "e018")
    local p_bc01 = Motion.Object:new(PLAYER, "", "bc01")
    local p_bn01 = Motion.Object:new(PLAYER, "", "bn01")
    local p_fn01_01 = Motion.Object:new(PLAYER, "", "fn01_01")
    Sound.PlayBGM(302, 0, 0)
    Cam.Inst:Set(16.95, 0.072, 110.25, 12.67, 2.01, 101.42, default, 0)
    Obj:new(PLAYER, ""):SetPos(14.291, 0, 102.866)
    Obj:new(PLAYER, ""):SetRotationYToObject(NPC, "s110_113_001", 0)
    Field_InvisibleMob(FOR_ALL, 10, 0, true, false)
    Obj:new(NPC, "npc_0002"):Invisible()
    Obj:new(MOB, "mob01"):Invisible()
    Obj:new(MOB, "mob02"):Invisible()
    Obj:new(MOB, "mob03"):Invisible()
    Obj:new(MOB, "mob04"):Invisible()
    Obj:new(NPC, "npc_0010"):Invisible()
    HideMinimap(true)
    WaitFrame(10)
    HideGuide(true)
    WaitFrame(10)
    FadeAllInWithWait(FADE_BLACK, FADE_TIME)
    local tlk = Tlk:new(text_file, 1, true)
    tlk:StartTalkAndCancelDigimonRide()
    rd01_fe02:PlayWithStartMoveMotion(10, 10)
    tlk:Message(base .. "210")
    local result = tlk:Select(3, base .. "220")
    WaitFrame(30)
    if result == RESULT_TALK00 then
      rd01_fq01:PlayWithStartMoveMotion(10, 10)
      tlk:Message(base .. "230")
    elseif result == RESULT_TALK01 then
      rd01_fq02:PlayWithStartMoveMotion(10, 10)
      tlk:Message(base .. "240")
    elseif result == RESULT_TALK02 then
      rd01_fq02:PlayWithStartMoveMotion(10, 10)
      tlk:Message(base .. "250")
    end
    Field.ObjectLookAtTheObject(NPC, angel_index, PLAYER, 1, 30)
    g_fq01:PlayWithStartMoveMotion(10, 10)
    Field.ObjectResetAim(NPC, angel_index, 20)
    tlk:Message(base .. "260")
    Field.ObjectLookAtTheObject(NPC, angel_index, NPC, gankoo_index, 30)
    tlk:Message(base .. "270")
    g_fq02:PlayWithStartMoveMotion(10, 10)
    tlk:Message(base .. "280")
    Field.ObjectLookAtTheObject(PLAYER, 1, NPC, o_index, 30)
    Field.ObjectLookAtTheObject(NPC, gankoo_index, NPC, o_index, 30)
    Field.ObjectLookAtTheObject(NPC, zies_index, NPC, o_index, 30)
    Cam.Inst:Set(17.22, 0.93, 104.972, 10.345, 4.726, 98.783, default, 30)
    Field.ObjectLookAtTheObject(NPC, o_index, NPC, devil_index, 30)
    Field.ObjectLookAtTheObject(NPC, devil_index, NPC, o_index, 30)
    o_e052:Play(10, true)
    tlk:Message(base .. "290")
    j_fq02:PlayWithStartMoveMotion(10, 10)
    tlk:Message(base .. "300")
    rd02_fe02:PlayWithStartMoveMotion(10, 10)
    tlk:Message(base .. "310")
    o_e052:Play(10, true)
    tlk:Message(base .. "320")
    rd02_fq01:PlayWithStartMoveMotion(10, 10)
    tlk:Message(base .. "330")
    o_e052:Play(10, true)
    tlk:Message(base .. "340")
    WaitFrame(30)
    tlk:Message(base .. "350")
    result = tlk:Select(3, base .. "360")
    WaitFrame(30)
    if result == RESULT_TALK00 then
      g_fe02:PlayWithStartMoveMotion(10, 10)
      tlk:Message(base .. "370")
    elseif result == RESULT_TALK01 then
      g_fq02:PlayWithStartMoveMotion(10, 10)
      tlk:Message(base .. "380")
    elseif result == RESULT_TALK02 then
      g_fq01:PlayWithStartMoveMotion(10, 10)
      tlk:Message(base .. "390")
    end
    tlk:MessageClose()
    Fade_OutNoLoadingWithWait(FADE_BLACK, FADE_TIME)
    Cam.Inst:Set(20.69, -0.5225, 106.35, 13.29, 2.807, 100.5, default, 0)
    Obj:new(PLAYER, ""):SetPos(16.077, 0, 102.376)
    Obj:new(NPC, "s110_113_006"):SetPos(14.92, 0, 103.08)
    Obj:new(NPC, "s110_113_005"):SetPos(14.28, 0, 104.76)
    Obj:new(NPC, "s110_113_001"):SetRotationY(0, 0)
    Obj:new(NPC, "s110_113_001"):SetPos(18.65, -0.021, 105.427)
    Obj:new(NPC, "s110_113_001"):SetRotationYToObject(PLAYER, "", 0)
    Obj:new(PLAYER, ""):SetRotationYToObject(NPC, "s110_113_004", 0)
    Obj:new(NPC, "s110_113_002"):SetRotationY(330, 0)
    Field.ObjectLookAtTheObject(NPC, o_index, NPC, gankoo_index, 30)
    FadeAllInWithWait(FADE_BLACK, FADE_TIME)
    g_fq01:PlayWithStartMoveMotion(10, 10)
    tlk:Message(base .. "400")
    o_e052:Play(10, true)
    tlk:Message(base .. "410")
    g_fe04:PlayWithStartMoveMotion(10, 10)
    tlk:Message(base .. "420")
    tlk:Message(base .. "430")
    g_fq01:PlayWithStartMoveMotion(10, 10)
    tlk:Message(base .. "440")
    o_e004:Play(10, true)
    tlk:Message(base .. "450")
    g_fq02:PlayWithStartMoveMotion(10, 10)
    tlk:Message(base .. "460")
    g_fq01:PlayWithStartMoveMotion(10, 10)
    tlk:Message(base .. "470")
    o_e002:PlayWithStartMoveMotion(10, 10)
    tlk:Message(base .. "480")
    o_e015:PlayWithStartMoveMotion(10, 10)
    tlk:Message(base .. "490")
    o_e503:PlayWithStartMoveMotion(10, 10)
    tlk:Message(base .. "500")
    g_fe04:PlayWithStartMoveMotion(10, 10)
    tlk:Message(base .. "510")
    result = tlk:Select(3, base .. "520")
    Cam.Inst:Set(18.782, 1.83, 106.36, 13.48, 2.57, 97.92, default, 30)
    Field.ObjectResetAim(NPC, zies_index, 15)
    WaitFrame(30)
    if result == RESULT_TALK00 then
      j_fq02:PlayWithStartMoveMotion(10, 10)
      tlk:Message(base .. "530")
    elseif result == RESULT_TALK01 then
      j_fq02:PlayWithStartMoveMotion(10, 10)
      tlk:Message(base .. "540")
    elseif result == RESULT_TALK02 then
      j_fq02:PlayWithStartMoveMotion(10, 10)
      tlk:Message(base .. "550")
    end
    g_fq01:PlayWithStartMoveMotion(10, 10)
    tlk:Message(base .. "560")
    Field.ObjectLookAtTheObject(NPC, zies_index, NPC, gankoo_index, 30)
    j_fq02:PlayWithStartMoveMotion(10, 10)
    tlk:Message(base .. "570")
    j_fq01:PlayWithStartMoveMotion(10, 10)
    tlk:Message(base .. "580")
    g_fq01:PlayWithStartMoveMotion(10, 10)
    tlk:Message(base .. "590")
    j_fq02:PlayWithStartMoveMotion(10, 10)
    tlk:Message(base .. "600")
    g_fe02:PlayWithStartMoveMotion(10, 10)
    tlk:Message(base .. "610")
    j_fe04:PlayWithStartMoveMotion(10, 10)
    tlk:Message(base .. "620")
    Field.ObjectResetAim(NPC, zies_index, 15)
    result = tlk:Select(3, base .. "630")
    Field.ObjectLookAtTheObject(PLAYER, 1, NPC, zies_index, 30)
    WaitFrame(30)
    Field.ObjectLookAtTheObject(NPC, zies_index, PLAYER, 1, 30)
    if result == RESULT_TALK00 then
      j_fq02:PlayWithStartMoveMotion(10, 10)
      tlk:Message(base .. "640")
    elseif result == RESULT_TALK01 then
      j_fq02:PlayWithStartMoveMotion(10, 10)
      tlk:Message(base .. "650")
    elseif result == RESULT_TALK02 then
      j_fq02:PlayWithStartMoveMotion(10, 10)
      tlk:Message(base .. "660")
    end
    Field.ObjectResetAim(PLAYER, 1, 15)
    g_fq01:PlayWithStartMoveMotion(10, 10)
    tlk:Message(base .. "670")
    g_fe02:PlayWithStartMoveMotion(10, 10)
    tlk:Message(base .. "680")
    o_e004:PlayWithStartMoveMotion(10, 10)
    tlk:Message(base .. "690")
    Field.ObjectResetAim(NPC, devil_index, 15)
    rd02_fq02:PlayWithStartMoveMotion(10, 10)
    tlk:Message(base .. "700")
    tlk:MessageClose()
    Fade_OutNoLoadingWithWait(FADE_BLACK, FADE_TIME)
    Cam.Inst:Set(15.348, 1.334, 104.0699, 5.952, 3.818, 106.422, default, 0)
    Obj:new(PLAYER, ""):SetRotationYToObject(NPC, "s110_113_003", 0)
    Flg.Set(self.Flg03)
    FieldObjectSync(NPC, false)
    Field.ObjectResetAim(NPC, zies_index, 15)
    PlaySE(101017, 100)
    WaitFrame(5)
    p_bn01:Play(10, true)
    Obj:new(PLAYER, ""):SetPos(11.219, -0.021, 103.431)
    Obj:new(NPC, "s110_113_005"):SetPos(11.045, -0.021, 107.369)
    Obj:new(NPC, "s110_113_006"):SetPos(11.047, -0.021, 101.377)
    Obj:new(PLAYER, ""):SetRotationYToObject(NPC, "s110_113_003", 0)
    Obj:new(NPC, "s110_113_006"):SetRotationYToObject(NPC, "s110_113_003", 0)
    Obj:new(NPC, "s110_113_005"):SetRotationYToObject(NPC, "s110_113_003", 0)
    WaitFrame(5)
    FadeAllInWithWait(FADE_BLACK, FADE_TIME)
    WaitFrame(15)
    l_fq01:PlayWithStartMoveMotion(10, 10)
    tlk:Message(base .. "710")
    l_fq02:PlayWithStartMoveMotion(10, 10)
    tlk:Message(base .. "720")
    tlk:MessageClose()
    g_fe04:PlayWithStartMoveMotion(10, 10)
    j_fe04:PlayWithStartMoveMotion(10, 10)
    l_fe04:PlayWithStartMoveMotion(10, 10)
    p_bc01:PlayWithStartMoveMotion(10, 10)
    WaitFrame(60)
    tlk:EndTalk()
    EncountFromField_PlaySound(21101130, 10577, false)
  end
end

function S110_113:Event_030()
  if Qst.Sub:Check(self.ID, self.STEP_005, self.STEP_255) and Flg.Check(self.Flg01) then
    Field_CancelInvisibleMob(FOR_ALL, 10, 0, true, false)
    Sound.StopBGM(0)
    Flg.Set("FLAG_SKIP_AREACHANGE_MOVE")
    PlaySE(200006, 100)
    MapChange("t", 203, "start_11", false, FADE_WHITE, FADE_TIME)
  end
end

function S110_113:Event_040()
  if Qst.Sub:Check(self.ID, self.STEP_005, self.STEP_255) and Flg.Check(self.Flg01) then
    local g_index = GetIndex(NPC, "s110_113_001")
    local g_bn01 = Motion.Object:new(NPC, "s110_113_001", "bn01")
    local g_fq01 = Motion.Object:new(NPC, "s110_113_001", "fq01")
    local g_fq02 = Motion.Object:new(NPC, "s110_113_001", "fq02")
    local g_fe02 = Motion.Object:new(NPC, "s110_113_001", "fe02")
    local j_fq01 = Motion.Object:new(NPC, "s110_113_002", "fq01")
    local j_bn01 = Motion.Object:new(NPC, "s110_113_002", "bn01")
    HideMinimap(true)
    HideGuide(true)
    local tlk = Tlk:new(text_file, 1, true)
    tlk:StartTalkAndCancelDigimonRide()
    FieldObjectSync(NPC, false)
    Obj:new(PLAYER, ""):SetPos(22.001, 0, 39.841)
    Obj:new(PLAYER, ""):SetRotationY(90, 0)
    Cam.Inst:Set(26.345, 3.29, 48.214, 22.476, 1.486, 36.466, default, 0)
    WaitFrame(5)
    FadeAllInWithWait(FADE_WHITE, FADE_TIME)
    WaitFrame(15)
    tlk:Message(base .. "730")
    g_fq02:PlayWithStartMoveMotion(10, 10)
    tlk:Message(base .. "740")
    tlk:Message(base .. "750")
    g_fq01:PlayWithStartMoveMotion(10, 10)
    tlk:Message(base .. "760")
    tlk:MessageClose()
    Flg.Set(self.Flg04)
    Fade_OutNoLoadingWithWait(FADE_BLACK, FADE_TIME)
    FieldObjectSync(NPC, true)
    Obj:new(PLAYER, ""):SetRotationY(150, 0)
    WaitFrame(30)
    FadeAllInWithWait(FADE_BLACK, FADE_TIME)
    Field.ObjectLookAtTheObject(NPC, g_index, PLAYER, 1, 30)
    g_fq02:PlayWithStartMoveMotion(10, 10)
    tlk:Message(base .. "770")
    tlk:Message(base .. "780")
    Field.ObjectResetAim(NPC, g_index, 15)
    g_fq01:PlayWithStartMoveMotion(10, 10)
    tlk:Message(base .. "790")
    j_fq01:PlayWithStartMoveMotion(10, 10)
    tlk:Message(base .. "800")
    g_fe02:PlayWithStartMoveMotion(10, 10)
    tlk:Message(base .. "810")
    tlk:MessageClose()
    Flg.Set("FLAG_IS_CLEAR_S110_113")
    Fade_OutNoLoadingWithWait(FADE_BLACK, FADE_TIME)
    FieldObjectSync(NPC, true)
    FieldObjectSync(FLD_OBJ_GIMMICK, true)
    Guest.Delete(GST_S010_156_GANKOO)
    Guest.Delete(GST_S010_156_JES)
    tlk:EndTalk()
    local rotY = Field.ObjectGetRotationY(PLAYER, 1)
    SetFollowerCameraOperateRotation(0, rotY, 0)
    Cam.Inst:Clear(0)
    WaitFrame(25)
    FadeAllInWithWait(FADE_BLACK, FADE_TIME)
    HideMinimap(false)
    HideGuide(false)
    require("S100_087")
    Flg.Set(S100_087.Flgs.Flg11)
    Flg.Set(S100_087.Flgs.Flg12)
    Flg.Clear("FLAG_IS_NOT_MAP_NAME_DISP")
    S100_087.AddReturnRoyalKnightsNum()
    S100_087.AddReturnRoyalKnightsNum()
    S100_087:Event_020()
    Qst.Sub:End(self.ID, self.STEP_255)
  end
end
