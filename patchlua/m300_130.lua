require("include")

function m300_130()
  Fade_Out(0, 0)
  EVENT_BEGIN()
  Talk.Load("m300")
  SetEventCutNo(4)
  if Debug.IsEventView() then
    SetTimeZone("Evening")
    SetTimeAxis("A2028_daft_300")
    LoadMap("d0404")
  end
  LoadSceneViewerResource("c1.0", "d0404f_te")
  LoadSceneViewerResource("c2.0", "d0404f_te")
  LoadSceneViewerResource("c3.0", "d0404f_te")
  LoadSceneViewerResource("c4.0", "d0404f_te")
  LoadEnvironmentFile("c1.0", "es_m300_130_c1.0")
  LoadEnvironmentFile("c2.0", "es_m300_130_c2.0")
  LoadEnvironmentFile("c3.0", "es_m300_130_c3.0")
  LoadEnvironmentFile("c4.0", "es_m300_130_c4.0")
  LoadModel("AEGIOMON_01", "char_AEGIOMON")
  LoadModel("HERO_01", "Player")
  LoadModel("HEROINE_01", "char_HEROINE")
  LoadModel("chr179_01", "char_BACCHUSMON")
  WaitVistaLoad()
  Event_PlayBGM(105, 0.3, 0)
  if Debug.IsEventView() then
  else
    local BGM, SE = Field.GetCurrentMapDefaultBGM()
    if BGM == 130 then
      Sound.PlayBGM(105, 0)
    else
      Sound.PlayBGM(BGM, 0)
    end
  end
  SetPosition("AEGIOMON_01", 4.199, -0.03, 34.923, "LINEAR", 0, 0)
  SetRotation("AEGIOMON_01", 0, 233, 0, "LINEAR", 0, 0)
  SetPosition("HERO_01", 4.788, -0.03, 34.72, "LINEAR", 0, 0)
  SetRotation("HERO_01", 0, -135.5, 0, "LINEAR", 0, 0)
  SetPosition("HEROINE_01", 5.551, -0.03, 33.766, "LINEAR", 0, 0)
  SetRotation("HEROINE_01", 0, -120, 0, "LINEAR", 0, 0)
  SetPosition("chr179_01", -5.049, -0.03, 23.203, "LINEAR", 0, 0)
  SetRotation("chr179_01", 0, 35.5, 0, "LINEAR", 0, 0)
  PlayMotion("AEGIOMON_01", "fn01_01", 0, true, 0)
  SetFace("AEGIOMON_01", "F16", 0, 1, FACE_BLENDTIME, 0)
  PlayMotion("HERO_01", "fn01_01", 0, true, 0)
  SetFace("HERO_01", "F01", 0, 1, FACE_BLENDTIME, 0)
  PlayMotion("HEROINE_01", "fn01_01", 0, true, 0)
  SetFace("HEROINE_01", "F01", 0, 1, FACE_BLENDTIME, 0)
  PlayMotion("chr179_01", "fw01_01", 0, true, 0)
  PlayMotion("chr179_01", "ba02", 10, false, 83)
  PlayMotion("chr179_01", "bn01", 5, true, 165)
  SetFace("chr179_01", "F01_M01", 0, 1, FACE_BLENDTIME, 0)
  BlendEye("AEGIOMON_01", 0, 0, "SCURVE", 0, 0)
  BlendFace("AEGIOMON_01", -45, 0, 0, true, "SCURVE", 30, 0)
  BlendEye("HERO_01", 0, 0, "SCURVE", 0, 0)
  BlendFace("HERO_01", -59, 0, 0, true, "SCURVE", 30, 0)
  BlendEye("HEROINE_01", 0, 0, "SCURVE", 0, 0)
  BlendFace("HEROINE_01", -43, 0, 0, false, "SCURVE", 30, 0)
  BlendFaceDigi("chr179_01", 0, 0, 0, "SCURVE", 0, 0)
  SetPosition("chr179_01", -2.03, -0.03, 27.437, "LINEAR", 100, 0)
  SetRotation("chr179_01", 0, 35.5, 0, "LINEAR", 100, 0)
  SetCamera(1.539, 1.502, 36.495, 3, 50, "LINEAR", 0, false, 0, false)
  SetCameraTarget(0.505, 3.246, 32.639, "LINEAR", 0, false, 0, false)
  SetCamera(4.185, 0.035, 38.262, 3, 50, "SCURVE", 100, true, 0, false)
  SetCameraTarget(2.174, 2.974, 31.857, "SCURVE", 100, true, 0, false)
  SetEnv_All("c1.0", 0)
  FIELD_SET()
  EVENT_START()
  NpcInvisible(FOR_ALL)
  CUT("1.0")
  FadeInWithWait(0, FADE_TIME)
  if Common.IsVoiceJapanese() then
    SetMouth("chr179_01", 0, 6, 0)
    SetMouth("chr179_01", 2, 6, 9)
    SetMouth("chr179_01", 0, 6, 18)
    SetMouth("chr179_01", 2, 6, 58)
    SetMouth("chr179_01", 0, 6, 75)
    SetMouth("chr179_01", 2, 6, 165)
  else
    SetMouth("chr179_01", 0, 5, 0)
    SetMouth("chr179_01", 2, 5, 7)
    SetMouth("chr179_01", 0, 6, 15)
    SetMouth("chr179_01", 2, 6, 45)
    SetMouth("chr179_01", 0, 6, 60)
    SetMouth("chr179_01", 2, 6, 138)
  end
  local slot_01 = Vista.PlaySE(211004, 100, false, 0, 0.4)
  local slot_01 = Vista.PlaySE(211004, 100, false, 0, 1.3)
  local slot_01 = Vista.PlaySE(211004, 100, false, 0, 2.2)
  local slot_01 = Vista.PlaySE(211004, 100, false, 0, 2.9)
  MessageTalk("m300_130_010")
  MessageClose()
  WaitFrame(0)
  SetMouth("chr179_01", 2, 8, 0)
  WaitFrame(10)
  CUT("2.0")
  SetEnv_All("c2.0", 0)
  SetPosition("chr179_01", -2.03, -0.03, 27.437, "LINEAR", 0, 0)
  SetRotation("chr179_01", 0, 35.5, 0, "LINEAR", 0, 0)
  PlayMotion("chr179_01", "fq01", 0, false, 0)
  PlayMotion("chr179_01", "bn01", 0, true, 60)
  SetCamera(1.162, 6.135, 36.646, 0, 30, "LINEAR", 0, false, 0)
  SetCameraTarget(0.358, 6.71, 32.662, "LINEAR", 0, false, 0)
  WaitFrame(10)
  if Common.IsVoiceJapanese() then
    SetMouth("chr179_01", 0, 6, 0)
    SetMouth("chr179_01", 1, 6, 60)
  else
    SetMouth("chr179_01", 0, 6, 5)
    SetMouth("chr179_01", 1, 6, 39)
  end
  MessageTalk("m300_130_020")
  MessageClose()
  WaitFrame(0)
  SetMouth("chr179_01", 1, 8, 0)
  WaitFrame(10)
  CUT("3.0")
  SetEnv_All("c3.0", 0)
  PlayMotion("AEGIOMON_01", "fn01_01", 0, true, 0)
  SetCamera(3.58, 1.054, 34.642, 0, 30, "LINEAR", 0, false, 0)
  SetCameraTarget(4.161, 1.032, 34.905, "LINEAR", 0, false, 0)
  WaitFrame(10)
  MessageTalk("m300_130_030")
  MessageClose()
  WaitFrame(10)
  CUT("4.0")
  SetEnv_All("c4.0", 0)
  PlayMotion("chr179_01", "e004", 3, true, 0)
  SetFace("chr179_01", "F01_M01", 0, 1, 0, 0)
  SetCamera(4.185, 0.035, 38.262, 3, 50, "SCURVE", 0, true, 0, false)
  SetCameraTarget(2.174, 2.974, 31.857, "SCURVE", 0, true, 0, false)
  local slot_06 = Event_PlaySE(404070, 100, false, 0, 0)
  WaitFrame(10)
  if Common.IsVoiceJapanese() then
    SetMouth("chr179_01", 0, 6, 0)
    SetMouth("chr179_01", 2, 6, 84)
    SetMouth("chr179_01", 0, 6, 114)
    SetMouth("chr179_01", 2, 6, 150)
    SetMouth("chr179_01", 0, 6, 174)
    SetMouth("chr179_01", 1, 6, 245)
  else
    SetMouth("chr179_01", 0, 6, 0)
    SetMouth("chr179_01", 2, 6, 73)
    SetMouth("chr179_01", 0, 6, 92)
    SetMouth("chr179_01", 2, 6, 120)
    SetMouth("chr179_01", 0, 6, 135)
    SetMouth("chr179_01", 1, 6, 160)
  end
  MessageTalk("m300_130_040")
  MessageClose()
  WaitFrame(0)
  SetMouth("chr179_01", 1, 8, 0)
  WaitFrame(30)
  Fade_OutNoLoadingWithWait(FADE_BLACK, FADE_TIME)
  EVENT_END()
end

function CUT(cut_no)
  CUT_START(cut_no)
end

function main()
  m300_130()
end
