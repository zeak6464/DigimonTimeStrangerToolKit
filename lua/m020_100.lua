require("include")

function m020_100()
  Fade_Out(0, 0)
  EVENT_BEGIN()
  Talk.Load("m020")
  LOAD_VOICE()
  SetEventCutNo(4)
  if Debug.IsEventView() then
    SetTimeZone("Evening")
    SetTimeAxis("X2028_daft_20")
    LoadMap("d1403")
    LoadObject("change_0001", "d14elvdoor00")
  end
  LoadModel("HERO_01", "Player")
  LoadModel("HEROINE_01", "char_HEROINE")
  LoadObject("d14elvdoor00_01", "d14elvdoor00")
  FieldInitCancel()
  LoadSceneViewerResource("c00", "d1403f_ce")
  LoadSceneViewerResource("c01", "m020_100_c01")
  LoadSceneViewerResource("c02", "m020_100_c02")
  LoadSceneViewerResource("c03", "m020_100_c03")
  LoadEnvironmentFile("c00", "es_m020_100_c00")
  LoadEnvironmentFile("c01", "es_m020_100_c01")
  LoadEnvironmentFile("c02", "es_m020_100_c02")
  LoadEnvironmentFile("c03", "es_m020_100_c03")
  WaitVistaLoad()
  SetPosition("HERO_01", 5.096, -0, -0.4, "LINEAR", 0, 0)
  SetRotation("HERO_01", 0, -90, 0, "LINEAR", 0, 0)
  SetPosition("HEROINE_01", 5.601, -0, 0.29, "LINEAR", 0, 0)
  SetRotation("HEROINE_01", 0, -90, 0, "LINEAR", 0, 0)
  SetPosition("d14elvdoor00_01", 3.995, -0, 0, "LINEAR", 0, 0)
  SetRotation("d14elvdoor00_01", 0, -90, 0, "LINEAR", 0, 0)
  if Debug.IsEventView() then
    SetPosition("change_0001", 3.995, -0, 0.001, "LINEAR", 0, 0)
    SetRotation("change_0001", 0, -90, 0, "LINEAR", 0, 0)
  end
  PlayMotion("HERO_01", "fn01_01", 0, true, 0)
  SetFace("HERO_01", "E01_M15", 0, 1, 0, 0)
  PlayMotion("HEROINE_01", "fn01_01", 0, true, 0)
  SetFace("HEROINE_01", "E01_M15", 0, 1, 0, 0)
  PlayMotion("d14elvdoor00_01", "e001", 0, false, 0)
  SetStartFrame("d14elvdoor00_01", "e001", 0, 0)
  SetLoopFrame("d14elvdoor00_01", "e001", 0, 0)
  BlendEye("HERO_01", 0, 0, "SCURVE", 0, 0)
  BlendFace("HERO_01", 20, 0, 0, true, "SCURVE", 0, 0)
  BlendEye("HEROINE_01", 0, 0, "SCURVE", 0, 0)
  BlendFace("HEROINE_01", 0, 0, 0, true, "SCURVE", 0, 0)
  SetEnv_All("c00", 0)
  SetCamera(2.266, 2.334, -0, 0, 45, "LINEAR", 0, false, 0, false)
  SetCameraTarget(3.8, 2.74, 0, "LINEAR", 0, false, 0, false)
  EVENT_START()
  CUT("0.0")
  SetCamera(2.266, 2.394, -0, 0, 45, "LINEAR", 60, true, 0, false)
  SetCameraTarget(3.8, 2.8, 0, "LINEAR", 60, true, 0, false)
  local se01 = Event_PlaySE(200012, 100, true, 0, 0)
  Fade_In(0, 15)
  WaitFrame(20)
  Event_PlaySE(402011, 100, false, 0, 0)
  Event_StopSE(se01, 0.5, 1.5)
  WaitFrame(45)
  ModelVisible("d14elvdoor00_01", false, 0, 0)
  CUT("1.0")
  SetEnv_All("c01", 0)
  SetCamera(0.889, 1.254, -0.558, 0, 45, "LINEAR", 0, false, 0, false)
  SetCameraTarget(2.035, 1.351, -0.249, "LINEAR", 0, false, 0, false)
  SetCamera(0.778, 1.246, -0.594, 0, 45, "DECEL", 80, false, 0, false)
  SetCameraTarget(2.12, 1.357, -0.221, "DECEL", 80, false, 0, false)
  MovePosition("HERO_01", 2.096, -0, -0.4, true, 1.4, 34)
  MoveRotation("HERO_01", 0, -90, 0, "LINEAR", 1.4, true, 34)
  MovePosition("HEROINE_01", 2.601, -0, 0.29, true, 1.2, 20)
  MoveRotation("HEROINE_01", 0, -90, 0, "LINEAR", 1.2, true, 20)
  Motion.Gimmick:Play("change_0001", "e001", false)
  Event_PlaySE(200013, 100, false, 0, 0)
  WaitFrame(100)
  local slot_id1 = Event_PlaySE(405001, 100, true, 0.5, 0)
  Event_Quake_Start(1, 1, 80, 0)
  PlayMotion("HERO_01", "e514", 4, false, 0)
  PlayMotion("HERO_01", "fn01_01", 4, true, 82)
  SetFace("HERO_01", "E05_M03", 0, 1, FACE_BLENDTIME, 10)
  PlayMotion("HEROINE_01", "e514", 4, false, 12)
  PlayMotion("HEROINE_01", "fn01_01", 4, true, 94)
  SetFace("HEROINE_01", "F05", 0, 1, FACE_BLENDTIME, 12)
  SetFace("HERO_01", "E16_M10", 0, 1, 10, 64)
  SetFace("HEROINE_01", "E16_M10", 0, 1, 10, 74)
  Event_StopSE(slot_id1, 3, 1.5)
  Event_Quake_Stop(86)
  WaitFrame(90)
  BlendEye("HERO_01", 0, 45, "SCURVE", 4, 10)
  BlendFace("HERO_01", 38, 69, 0, true, "SCURVE", 22, 0)
  BlendEye("HEROINE_01", 0, 0, "SCURVE", 0, 0)
  BlendFace("HEROINE_01", 0, -65, 0, true, "SCURVE", 30, 0)
  SetFace("HEROINE_01", "F15", 0, 1, 5, 0)
  WaitFrame(20)
  Motion.Gimmick:Play("change_0001", "e002", false)
  Event_PlaySE(200013, 100, false, 0, 0)
  CUT("2.0")
  SetEnv_All("c02", 0)
  SetCamera(1.783, 1.359, -0.436, 0, 30, "LINEAR", 0, false, 0)
  SetCameraTarget(2.356, 1.427, -0.101, "LINEAR", 0, false, 0)
  SetPosition("HERO_01", 2.07, -0, -0.65, "LINEAR", 0, 0)
  SetRotation("HERO_01", 0, -90, 0, "LINEAR", 0, 0)
  SetPosition("HEROINE_01", 2.58, -0, 0.04, "LINEAR", 0, 0)
  SetRotation("HEROINE_01", 0, -90, 0, "LINEAR", 0, 0)
  PlayMotion("HERO_01", "fn01_01", 0, true, 0)
  PlayMotion("HEROINE_01", "fn01_01", 0, true, 0)
  SetFace("HEROINE_01", "E09_M15", 0, 1, 0, 0)
  PlayMotionBlend("HEROINE_01", "blend03", 0, false, 0)
  WaitFrame(10)
  MessageTalk("m020_100_010")
  MessageClose()
  WaitFrame(10)
  CUT("3.0")
  SetEnv_All("c03", 0)
  SetCamera(0.986, 1.531, -1.028, 0, 20, "LINEAR", 0, false, 0)
  SetCameraTarget(2.043, 1.541, -0.847, "LINEAR", 0, false, 0)
  SetPosition("HERO_01", 2.07, -0, -0.812, "LINEAR", 0, 0)
  SetRotation("HERO_01", 0, -90, 0, "LINEAR", 0, 0)
  PlayMotionBlend("HERO_01", "blend01", 0, false, 0)
  SetFace("HERO_01", "F15", 0, 1, 0, 0)
  BLEND_WAIT("HERO_01", 0)
  BlendEye("HERO_01", 0, 0, "SCURVE", 15, 0)
  BlendFace("HERO_01", 0, 0, 0, true, "SCURVE", 40, 0)
  BlendEye("HEROINE_01", 0, 0, "SCURVE", 0, 0)
  BlendFace("HEROINE_01", 0, 0, 0, true, "SCURVE", 30, 0)
  SetFace("HERO_01", "F01", 0, 1, 10, 20)
  SetFace("HEROINE_01", "F01", 0, 1, 10, 30)
  WaitFrame(40)
  if Debug.IsEventView() then
    EVENT_END()
  else
    EVENT_END_SEAMLESS(60)
  end
end

function CUT(cut_no)
  CUT_START(cut_no)
end

function main()
  m020_100()
end
